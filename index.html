<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fourier Flow | Deep Learning</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- MathJax for LaTeX Rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                packages: {'[+]': ['ams']} 
            },
            svg: { fontCache: 'global' },
            startup: {
                typeset: false
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        bg: '#050505',
                        surface: '#111',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@200;300;500;600&family=JetBrains+Mono:wght@300&display=swap');
        /* 3D Vibe Style */
        .mode-3d {
            transform: perspective(1000px) rotateX(60deg) rotateZ(20deg) scale(0.65);
            transform-style: preserve-3d;
            pointer-events: none; /* 3D æ¨¡å¼ä¸‹ç¦æ­¢æ»‘é¼ ç¹ªåœ–ä»¥å…éŒ¯ä½ */
        }
        /* è®“ç•«å¸ƒæœ‰æµ®èµ·ä¾†çš„æ„Ÿè¦º */
        .mode-3d canvas {
            box-shadow: -20px 20px 50px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
        }
        body {
            background-color: #050505;
            color: #e5e5e5;
            overflow-x: hidden;
            touch-action: manipulation;
        }

        /* Page Transition */
        .page {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.6s ease-in-out;
            z-index: 0;
            overflow: hidden;
        }
        .page.active {
            opacity: 1;
            pointer-events: auto;
            z-index: 1;
        }
        
        /* Knowledge Page Scroll */
        #page-knowledge {
            overflow-y: auto;
            padding-top: 100px;
            padding-bottom: 100px;
        }

        .glass-panel {
            background: rgba(15, 15, 15, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        .nav-item {
            position: relative;
            opacity: 0.5;
            transition: opacity 0.3s;
            cursor: pointer;
        }
        .nav-item.active {
            opacity: 1;
        }
        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 100%;
            height: 1px;
            background: #fff;
        }

        /* Canvas */
        .canvas-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: block;
        }
        #canvas-wave { z-index: 0; }
        #canvas-trail { z-index: 5; pointer-events: none; }
        #canvas-draw { z-index: 10; }

        /* Inputs */
        input[type=number], input[type=range] { accent-color: white; }
        input[type=number] {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            color: #fff;
            font-family: 'JetBrains Mono', monospace;
            outline: none;
        }
        
        /* Flip Card */
        .flip-card {
            background-color: transparent;
            perspective: 1000px;
            height: 340px; /* Adjusted height */
            cursor: pointer;
        }

        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: left;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
        }

        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }

        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 12px;
            padding: 24px;
            border: 1px solid rgba(255,255,255,0.1);
            display: flex;
            flex-direction: column;
        }

        .flip-card-front {
            background: rgba(20, 20, 20, 0.8);
            backdrop-filter: blur(10px);
            justify-content: space-between;
        }
        .flip-card-front:hover {
            border-color: rgba(255,255,255,0.3);
            background: rgba(30, 30, 30, 0.9);
        }

        .flip-card-back {
            background: #111;
            transform: rotateY(180deg);
            overflow-y: auto;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
            justify-content: space-between;
        }

        /* Modal Lesson */
        #lesson-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(15px);
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
        }
        #lesson-modal.open {
            opacity: 1;
            pointer-events: auto;
        }
        
        .lesson-content {
            background: #0a0a0a;
            width: 90%;
            max-width: 900px;
            height: 90%;
            border-radius: 20px;
            border: 1px solid rgba(255,255,255,0.15);
            padding: 40px;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 50px rgba(0,0,0,0.9);
            transform: translateY(20px);
            transition: transform 0.4s ease;
        }
        #lesson-modal.open .lesson-content {
            transform: translateY(0);
        }

        .btn-learn {
            margin-top: 10px;
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 6px;
            text-align: center;
            font-size: 12px;
            letter-spacing: 1px;
            color: white;
            background: linear-gradient(45deg, rgba(255,255,255,0.05), rgba(255,255,255,0.1));
            transition: all 0.3s;
        }
        .btn-learn:hover {
            background: white;
            color: black;
            box-shadow: 0 0 15px rgba(255,255,255,0.3);
        }

        /* Lesson Typography */
        .lesson-body h3 { color: #fff; font-size: 1.4rem; font-weight: 600; margin-top: 2.5rem; margin-bottom: 1rem; border-left: 4px solid #fff; padding-left: 1rem; letter-spacing: 0.05em; }
        .lesson-body h4 { color: #d4d4d4; font-size: 1.1rem; font-weight: 500; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .lesson-body p { color: #a3a3a3; margin-bottom: 1rem; line-height: 1.8; font-weight: 300; font-size: 1.05rem; }
        .lesson-body ul, .lesson-body ol { padding-left: 1.5rem; margin-bottom: 1.5rem; color: #a3a3a3; }
        .lesson-body ul { list-style-type: disc; }
        .lesson-body ol { list-style-type: decimal; }
        .lesson-body li { margin-bottom: 0.5rem; }
        .lesson-body .math-block { 
            background: #111; 
            padding: 1.5rem; 
            border-radius: 8px; 
            margin: 2rem 0; 
            overflow-x: auto; 
            text-align: center; 
            border: 1px solid #333;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }
        .lesson-body .highlight { 
            background: rgba(59, 130, 246, 0.05); 
            border-left: 3px solid #3b82f6; 
            padding: 1.5rem; 
            margin: 2rem 0; 
            color: #dbeafe; 
        }

        /* Spoiler / Hidden Answer Style */
        .spoiler-blur {
            filter: blur(8px);
            cursor: pointer;
            transition: all 0.5s ease;
            user-select: none;
            background: rgba(255,255,255,0.02);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            position: relative;
        }
        .spoiler-blur:hover {
            filter: blur(4px);
            background: rgba(255,255,255,0.05);
        }
        .spoiler-blur::before {
            content: 'é»æ“ŠæŸ¥çœ‹è§£ç­” (CLICK TO REVEAL)';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.8rem;
            color: rgba(255,255,255,0.5);
            letter-spacing: 2px;
            pointer-events: none;
            opacity: 1;
            transition: opacity 0.3s;
        }
        .spoiler-blur.revealed {
            filter: none;
            cursor: auto;
            user-select: text;
            background: transparent;
        }
        .spoiler-blur.revealed::before {
            opacity: 0;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
    </style>
    <style>
        #home-controls {
            opacity: 0;
            transition: opacity 0.4s ease-in-out;
        }
        #home-controls:hover {
            opacity: 1;
        }
    </style>
    
</head>
<body class="font-sans selection:bg-white selection:text-black">

    <!-- Navigation -->
    <nav class="fixed top-0 left-0 w-full z-50 px-8 py-6 flex justify-between items-center mix-blend-difference pointer-events-none">
        <div class="text-xl font-light tracking-[0.2em] uppercase pointer-events-auto">
            Fourier<span class="font-bold">Flow</span>
        </div>
        <div class="flex gap-8 text-xs tracking-widest font-mono pointer-events-auto bg-black/50 backdrop-blur-md px-6 py-2 rounded-full border border-white/10">
            <div onclick="showPage('home')" id="nav-home" class="nav-item active">HOME</div>
            <div onclick="showPage('knowledge')" id="nav-knowledge" class="nav-item">KNOWLEDGE</div>
            <div onclick="showPage('studio')" id="nav-studio" class="nav-item">STUDIO</div>
        </div>
    </nav>

    <!-- Modal for Lessons -->
    <div id="lesson-modal">
        <div class="lesson-content">
            <button onclick="closeLesson()" class="fixed top-6 right-6 text-gray-500 hover:text-white text-2xl z-50 w-10 h-10 bg-black/50 rounded-full backdrop-blur flex items-center justify-center border border-white/10 transition-all hover:bg-white/20">âœ•</button>
            <div id="lesson-body" class="lesson-body pb-20">
                <!-- Content injected by JS -->
            </div>
        </div>
    </div>

    <!-- PAGE 1: HOME -->
    <section id="page-home" class="page active">
        <canvas id="canvas-wave" class="canvas-layer"></canvas>
        <div class="absolute top-1/2 left-10 md:left-20 transform -translate-y-1/2 pointer-events-none mix-blend-difference">
            <h1 class="text-6xl md:text-8xl font-thin tracking-tighter mb-4 leading-none">åŒ–ç¹ç‚ºç°¡</h1>
            <p class="text-xs md:text-sm text-gray-400 font-mono tracking-widest max-w-xs leading-relaxed">å°‡ç¾å¯¦è§£æ§‹ç‚ºåœ“çš„è—è¡“ã€‚</p>
        </div>
        <div id="home-controls" class="absolute bottom-10 right-10 glass-panel p-6 rounded-lg w-64">
            <div class="flex justify-between text-xs text-gray-400 mb-4 tracking-widest"><span>HARMONICS</span><span id="wave-n-display">5</span></div>
            <input type="range" id="wave-slider" class="w-full mb-4" min="1" max="50" value="5">
            <div class="flex gap-2">
                <button onclick="setWaveType('square')" class="flex-1 py-2 text-[10px] border border-white/10 hover:bg-white/10 transition rounded text-white">SQ</button>
                <button onclick="setWaveType('sawtooth')" class="flex-1 py-2 text-[10px] border border-white/10 hover:bg-white/10 transition rounded text-white">SAW</button>
                <button onclick="setWaveType('triangle')" class="flex-1 py-2 text-[10px] border border-white/10 hover:bg-white/10 transition rounded text-white">TRI</button>
            </div>
        </div>
    </section>

    <!-- PAGE 2: KNOWLEDGE CARDS -->
    <section id="page-knowledge" class="page">
        <div class="container mx-auto px-6 pb-20">
            <div class="text-center mb-20">
                <h2 class="text-4xl font-light mb-4">å‚…ç«‹è‘‰è®Šæ› <span class="font-bold">ç³»çµ±èª²ç¨‹</span></h2>
                <p class="text-gray-400 text-sm font-mono tracking-widest uppercase">A 8-Lesson Journey</p>
            </div>

            <!-- Phase 1 -->
            <div class="max-w-6xl mx-auto mb-16">
                <div class="flex items-center gap-4 mb-8 border-b border-white/10 pb-4">
                    <span class="text-4xl font-thin text-white/20">01</span>
                    <div>
                        <h3 class="text-lg font-bold text-white tracking-widest">å¹¾ä½•èˆ‡åŸºç¤</h3>
                        <p class="text-xs text-gray-500 font-mono">å»ºç«‹ç›´è§€ (Building Intuition)</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Lesson 1 -->
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="text-sm font-mono text-blue-400 mb-4">LESSON 01</div>
                                <h3 class="text-2xl font-bold mb-2">å‡½æ•¸ç©ºé–“èˆ‡æ­£äº¤æ€§</h3>
                                <p class="text-sm text-gray-400 mt-2">Geometry of Functions</p>
                                <div class="mt-auto pt-4 border-t border-white/10 text-xs text-gray-500">ç„¡é™ç¶­ç©ºé–“ä¸­çš„å‘é‡</div>
                            </div>
                            <div class="flip-card-back">
                                <div>
                                    <h4 class="text-sm font-bold text-white mb-2">ç°¡ä»‹</h4>
                                    <p class="text-xs text-gray-300 leading-relaxed mb-4">å°‡å‡½æ•¸è¦–ç‚ºç„¡é™ç¶­ç©ºé–“ä¸­çš„å‘é‡ï¼Œä¸¦åˆ©ç”¨ç©åˆ†å®šç¾©å‡ºã€Œå…§ç©ã€ä¾†åˆ¤æ–·å®ƒå€‘æ˜¯å¦å‚ç›´ï¼ˆæ­£äº¤ï¼‰ã€‚é€™æ˜¯æ•´å€‹ç†è«–çš„å¹¾ä½•åŸºçŸ³ï¼Œè®“æˆ‘å€‘èƒ½å°‡è¤‡é›œè¨Šè™ŸæŠ•å½±åˆ°å–®ç´”çš„åŸºåº•ä¸Šã€‚</p>
                                    <div class="text-xs text-white bg-white/5 p-2 rounded text-center">
                                        $$\langle f, g \rangle = \int_{a}^{b} f(t) \overline{g(t)} \, dt = 0$$
                                    </div>
                                </div>
                                <button onclick="openLesson(1, event)" class="btn-learn">æ·±å…¥å­¸ç¿’ âœ</button>
                            </div>
                        </div>
                    </div>
                    <!-- Lesson 2 -->
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="text-sm font-mono text-blue-400 mb-4">LESSON 02</div>
                                <h3 class="text-2xl font-bold mb-2">å¾æ³°å‹’åˆ°å‚…ç«‹è‘‰</h3>
                                <p class="text-sm text-gray-400 mt-2">Fourier Series</p>
                                <div class="mt-auto pt-4 border-t border-white/10 text-xs text-gray-500">æ³¢å‹•é€¼è¿‘çš„è½‰æŠ˜</div>
                            </div>
                            <div class="flip-card-back">
                                <div>
                                    <h4 class="text-sm font-bold text-white mb-2">ç°¡ä»‹</h4>
                                    <p class="text-xs text-gray-300 leading-relaxed mb-4">å°‡é€±æœŸæ€§æ³¢å½¢åˆ†è§£ç‚ºç„¡çª®å¤šå€‹æ­£å¼¦æ³¢çš„ç–ŠåŠ ï¼Œä¸¦åˆ©ç”¨æ­æ‹‰å…¬å¼å°‡å…¶çµ±æ•´ç‚ºå„ªç¾çš„è¤‡æ•¸æŒ‡æ•¸å½¢å¼ã€‚é€™æ˜¯å¾ã€Œå¤šé …å¼é€¼è¿‘ã€è·¨è¶Šåˆ°ã€Œæ³¢å‹•é€¼è¿‘ã€çš„é—œéµè½‰æŠ˜ã€‚</p>
                                    <div class="text-xs text-white bg-white/5 p-2 rounded text-center">
                                        $$f(t) = \sum_{n=-\infty}^{\infty} c_n e^{i n \omega_0 t}$$
                                    </div>
                                </div>
                                <button onclick="openLesson(2, event)" class="btn-learn">æ·±å…¥å­¸ç¿’ âœ</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Phase 2 -->
            <div class="max-w-6xl mx-auto mb-16">
                <div class="flex items-center gap-4 mb-8 border-b border-white/10 pb-4">
                    <span class="text-4xl font-thin text-white/20">02</span>
                    <div>
                        <h3 class="text-lg font-bold text-white tracking-widest">é€£çºŒè®Šæ›èˆ‡åˆ†æ</h3>
                        <p class="text-xs text-gray-500 font-mono">æ ¸å¿ƒç†è«– (Core Theory)</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Lesson 3 -->
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="text-sm font-mono text-purple-400 mb-4">LESSON 03</div>
                                <h3 class="text-xl font-bold mb-2">é€£çºŒå‚…ç«‹è‘‰è®Šæ›</h3>
                                <p class="text-xs text-gray-400">CFT</p>
                                <div class="mt-auto pt-4 border-t border-white/10 text-xs text-gray-500">ç©¿æ¢­æ™‚åŸŸèˆ‡é »åŸŸ</div>
                            </div>
                            <div class="flip-card-back">
                                <div>
                                    <h4 class="text-sm font-bold text-white mb-2">ç°¡ä»‹</h4>
                                    <p class="text-xs text-gray-300 leading-relaxed mb-2">å°‡é€±æœŸæ¨å‘ç„¡çª®å¤§ï¼Œä½¿é›¢æ•£é »è­œè½‰åŒ–ç‚ºé€£çºŒé »è­œï¼Œå¾è€Œè™•ç†éé€±æœŸè¨Šè™Ÿã€‚é€éç©åˆ†è®Šæ›ï¼Œæˆ‘å€‘å¾—ä»¥åœ¨ã€Œæ™‚åŸŸã€èˆ‡ã€Œé »åŸŸã€å…©å€‹å¹³è¡Œå®‡å®™é–“è‡ªç”±ç©¿æ¢­ã€‚</p>
                                    <div class="text-xs text-white bg-white/5 p-2 rounded text-center">
                                        $$F(\omega) = \int_{-\infty}^{\infty} f(t) e^{-i\omega t} dt$$
                                    </div>
                                </div>
                                <button onclick="openLesson(3, event)" class="btn-learn">æ·±å…¥å­¸ç¿’ âœ</button>
                            </div>
                        </div>
                    </div>
                    <!-- Lesson 4 -->
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="text-sm font-mono text-purple-400 mb-4">LESSON 04</div>
                                <h3 class="text-xl font-bold mb-2">å·ç©å®šç†èˆ‡ç³»çµ±</h3>
                                <p class="text-xs text-gray-400">Convolution & LTI</p>
                                <div class="mt-auto pt-4 border-t border-white/10 text-xs text-gray-500">æœ€å¼·å¤§çš„æ•¸å­¸å·¥å…·</div>
                            </div>
                            <div class="flip-card-back">
                                <div>
                                    <h4 class="text-sm font-bold text-white mb-2">ç°¡ä»‹</h4>
                                    <p class="text-xs text-gray-300 leading-relaxed mb-2">æ­ç¤ºã€Œæ™‚åŸŸå·ç©ç­‰æ–¼é »åŸŸç›¸ä¹˜ã€çš„æ·±åˆ»å°æ‡‰ï¼Œå°‡è¤‡é›œçš„å¾®ç©åˆ†é‹ç®—ç°¡åŒ–ç‚ºå–®ç´”çš„ä»£æ•¸ä¹˜æ³•ã€‚é€™æ˜¯è§£æç·šæ€§ç³»çµ±ï¼ˆLTIï¼‰èˆ‡æ¿¾æ³¢å™¨è¨­è¨ˆæœ€å¼·å¤§çš„æ•¸å­¸å·¥å…·ã€‚</p>
                                    <div class="text-xs text-white bg-white/5 p-2 rounded text-center">
                                        $$\mathcal{F}\{(f * g)(t)\} = F(\omega) \cdot G(\omega)$$
                                    </div>
                                </div>
                                <button onclick="openLesson(4, event)" class="btn-learn">æ·±å…¥å­¸ç¿’ âœ</button>
                            </div>
                        </div>
                    </div>
                    <!-- Lesson 5 -->
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="text-sm font-mono text-purple-400 mb-4">LESSON 05</div>
                                <h3 class="text-xl font-bold mb-2">èƒ½é‡å®ˆæ†èˆ‡å»£ç¾©å‡½æ•¸</h3>
                                <p class="text-xs text-gray-400">Energy & Distributions</p>
                                <div class="mt-auto pt-4 border-t border-white/10 text-xs text-gray-500">å¸•å¡ç“¦çˆ¾å®šç†</div>
                            </div>
                            <div class="flip-card-back">
                                <div>
                                    <h4 class="text-sm font-bold text-white mb-2">ç°¡ä»‹</h4>
                                    <p class="text-xs text-gray-300 leading-relaxed mb-2">åˆ©ç”¨å¸•å¡ç“¦çˆ¾å®šç†è­‰æ˜èƒ½é‡åœ¨è®Šæ›å‰å¾Œçš„å®ˆæ†ï¼Œä¸¦å¼•å…¥ç‹„æ‹‰å…‹ $\delta$ å‡½æ•¸ä¾†è™•ç†å¥‡ç•°é»ã€‚é€™è®“æˆ‘å€‘èƒ½å°å¸¸æ•¸æˆ–ç´”å¼¦æ³¢ç­‰ã€Œç™¼æ•£ã€è¨Šè™Ÿé€²è¡Œåš´æ ¼çš„æ•¸å­¸åˆ†æã€‚</p>
                                    <div class="text-xs text-white bg-white/5 p-2 rounded text-center">
                                        $$\int_{-\infty}^{\infty} |f(t)|^2 dt = \frac{1}{2\pi} \int_{-\infty}^{\infty} |F(\omega)|^2 d\omega$$
                                    </div>
                                </div>
                                <button onclick="openLesson(5, event)" class="btn-learn">æ·±å…¥å­¸ç¿’ âœ</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Phase 3 -->
            <div class="max-w-6xl mx-auto mb-16">
                <div class="flex items-center gap-4 mb-8 border-b border-white/10 pb-4">
                    <span class="text-4xl font-thin text-white/20">03</span>
                    <div>
                        <h3 class="text-lg font-bold text-white tracking-widest">é›¢æ•£ä¸–ç•Œèˆ‡æ¼”ç®—æ³•</h3>
                        <p class="text-xs text-gray-500 font-mono">ç¾ä»£æ‡‰ç”¨ (Modern Applications)</p>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Lesson 6 -->
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="text-sm font-mono text-green-400 mb-4">LESSON 06</div>
                                <h3 class="text-xl font-bold mb-2">å–æ¨£å®šç†</h3>
                                <p class="text-xs text-gray-400">Sampling Theorem</p>
                                <div class="mt-auto pt-4 border-t border-white/10 text-xs text-gray-500">å¾é¡æ¯”åˆ°æ•¸ä½</div>
                            </div>
                            <div class="flip-card-back">
                                <div>
                                    <h4 class="text-sm font-bold text-white mb-2">ç°¡ä»‹</h4>
                                    <p class="text-xs text-gray-300 leading-relaxed mb-2">æ­å»ºç¾å¯¦ï¼ˆé¡æ¯”ï¼‰èˆ‡é›»è…¦ï¼ˆæ•¸ä½ï¼‰ä¹‹é–“çš„æ©‹æ¨‘ï¼Œæ¢è¨å¦‚ä½•é€éã€Œæ¢³ç‹€å‡½æ•¸ã€é€²è¡Œé›¢æ•£åŒ–ã€‚å¥ˆå¥æ–¯ç‰¹å®šç†å‘Šè¨´æˆ‘å€‘ï¼šåªæœ‰æ¡æ¨£é »ç‡å¤ å¿«ï¼Œæ‰èƒ½å®Œç¾é‡å»ºåŸå§‹è³‡è¨Šè€Œä¸ç™¼ç”Ÿæ··ç–Šã€‚</p>
                                    <div class="text-xs text-white bg-white/5 p-2 rounded text-center">
                                        $$f_s > 2 f_{\max}$$
                                    </div>
                                </div>
                                <button onclick="openLesson(6, event)" class="btn-learn">æ·±å…¥å­¸ç¿’ âœ</button>
                            </div>
                        </div>
                    </div>
                    <!-- Lesson 7 -->
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="text-sm font-mono text-green-400 mb-4">LESSON 07</div>
                                <h3 class="text-xl font-bold mb-2">DFT èˆ‡ FFT</h3>
                                <p class="text-xs text-gray-400">DFT & FFT</p>
                                <div class="mt-auto pt-4 border-t border-white/10 text-xs text-gray-500">æ•¸ä½è¨Šè™Ÿè™•ç†å¼•æ“</div>
                            </div>
                            <div class="flip-card-back">
                                <div>
                                    <h4 class="text-sm font-bold text-white mb-2">ç°¡ä»‹</h4>
                                    <p class="text-xs text-gray-300 leading-relaxed mb-2">é€™æ˜¯ç¾ä»£æ•¸ä½è¨Šè™Ÿè™•ç†çš„å¼•æ“ï¼Œåˆ©ç”¨å–®ä½æ ¹çš„å°ç¨±æ€§å°‡è¨ˆç®—è¤‡é›œåº¦å¾ $O(N^2)$ é™è‡³ $O(N \log N)$ã€‚æ²’æœ‰é€™å€‹æ¼”ç®—æ³•ï¼Œå°±æ²’æœ‰ä»Šå¤©çš„æ•¸ä½é€šè¨Šèˆ‡å¤šåª’é«”æŠ€è¡“ã€‚</p>
                                    <div class="text-xs text-white bg-white/5 p-2 rounded text-center">
                                        $$X_k = \sum x_n e^{-i \frac{2\pi}{N} k n}$$
                                    </div>
                                </div>
                                <button onclick="openLesson(7, event)" class="btn-learn">æ·±å…¥å­¸ç¿’ âœ</button>
                            </div>
                        </div>
                    </div>
                    <!-- Lesson 8 -->
                    <div class="flip-card" onclick="flipCard(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="text-sm font-mono text-green-400 mb-4">LESSON 08</div>
                                <h3 class="text-xl font-bold mb-2">ä¸ç¢ºå®šæ€§åŸç†</h3>
                                <p class="text-xs text-gray-400">Beyond Fourier</p>
                                <div class="mt-auto pt-4 border-t border-white/10 text-xs text-gray-500">ç¾ä»£æ“´å±•</div>
                            </div>
                            <div class="flip-card-back">
                                <div>
                                    <h4 class="text-sm font-bold text-white mb-2">ç°¡ä»‹</h4>
                                    <p class="text-xs text-gray-300 leading-relaxed mb-2">æ¢è¨å‚…ç«‹è‘‰è®Šæ›çš„ç‰©ç†æ¥µé™ï¼šæˆ‘å€‘ç„¡æ³•åŒæ™‚ç²¾ç¢ºæ•æ‰è¨Šè™Ÿçš„æ™‚é–“ä½ç½®èˆ‡é »ç‡åˆ†ä½ˆã€‚é€™ä¸åƒ…æ˜¯æµ·æ£®å ¡ä¸ç¢ºå®šæ€§åŸç†çš„æ•¸å­¸æœ¬è³ªï¼Œä¹Ÿå‚¬ç”Ÿäº†å°æ³¢è®Šæ›ç­‰ç¾ä»£æ™‚é »åˆ†æå·¥å…·ã€‚</p>
                                    <div class="text-xs text-white bg-white/5 p-2 rounded text-center">
                                        $$\sigma_t \cdot \sigma_\omega \ge \frac{1}{2}$$
                                    </div>
                                </div>
                                <button onclick="openLesson(8, event)" class="btn-learn">æ·±å…¥å­¸ç¿’ âœ</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <!-- PAGE 3: STUDIO -->
<section id="page-studio" class="page">
        <div class="absolute top-20 right-8 glass-panel rounded-xl p-5 w-72 flex flex-col gap-5 transition-opacity duration-300 hover:opacity-100 opacity-90 z-50">
            
            <div>
                <label class="text-[10px] font-bold text-gray-500 tracking-widest block mb-3">CANVAS TOOLS</label>
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="resetCanvas()" class="py-3 text-[10px] border border-red-500/30 text-red-400 hover:bg-red-500/10 transition rounded font-mono">RESET ALL</button>
                    <button onclick="clearTrail()" class="py-3 text-[10px] border border-yellow-500/30 text-yellow-400 hover:bg-yellow-500/10 transition rounded font-mono">CLEAR TRAIL</button>
                    
                    <label class="col-span-2 py-3 border border-white/20 text-white text-[10px] hover:bg-white/10 transition rounded text-center cursor-pointer bg-white/5 font-mono tracking-wider">
                        ğŸ“‚ UPLOAD IMAGE
                        <input type="file" accept="image/*" onchange="processImage(this)" class="hidden">
                    </label>

                    <button onclick="saveImage()" class="col-span-2 py-3 border border-blue-500/30 text-blue-400 text-[10px] hover:bg-blue-500/10 transition rounded font-mono tracking-wider">ğŸ’¾ SAVE IMAGE</button>
                </div>
            </div>
            
            <div class="border-t border-white/10"></div>

            <div>
                <label class="text-[10px] font-bold text-gray-500 tracking-widest block mb-3">EXPERIENCE</label>
                <button id="btn-vibe" onclick="toggleVibeMode()" class="w-full py-4 border border-purple-500/50 text-purple-300 bg-purple-500/10 hover:bg-purple-500/20 transition rounded text-xs font-bold tracking-[0.2em] flex items-center justify-center gap-2 shadow-[0_0_15px_rgba(168,85,247,0.1)]">
                    âš¡ ENTER VIBE
                </button>
            </div>

            <div class="bg-black/40 rounded p-3 border border-white/5">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-[10px] text-gray-500 font-bold">SPEED</span>
                    <span id="status-msg" class="text-[10px] text-gray-400 font-mono truncate max-w-[100px] text-right">Ready</span>
                </div>
                <input type="number" id="speed-input" class="w-full p-1 text-xs bg-transparent border-b border-white/20 text-white font-mono text-center focus:border-purple-500 transition outline-none" min="0.001" max="1000" step="0.1" value="1">
            </div>
        </div>
    </section>

    <script>
        // --- Core State ---
        const state = {
            page: 'home',
            waveType: 'square', waveN: 5, time: 0, wavePath: [],
            drawing: false, path: [], fourierX: [], drawTime: 0, drawSpeed: 1,
            origin: {x: 0, y: 0}, isImageMode: false, lastPoint: null, historyPaths: [] 
        };

        // --- Detailed Course Content (Modal) ---
        const lessons = {
1: {
                title: "å‡½æ•¸ç©ºé–“èˆ‡æ­£äº¤æ€§ (The Geometry of Functions)",
                content: `
                    <div class="lesson-body">
                        <p>é€™ç¬¬ä¸€èª²æ˜¯æ•´å€‹å‚…ç«‹è‘‰è®Šæ›çš„åœ°åŸºã€‚å¦‚æœé€™å ‚èª²çš„æ¦‚å¿µç©©å›ºäº†ï¼Œå¾Œé¢çš„å‚…ç«‹è‘‰ç´šæ•¸å…¬å¼ï¼ˆé‚£äº›çœ‹ä¼¼å¯æ€•çš„ç©åˆ†ï¼‰å°ä½ ä¾†èªªå°‡ä¸å†æ˜¯ã€Œå…¬å¼ã€ï¼Œè€Œæ˜¯ä¸€ç¨®è‡ªç„¶çš„ã€Œå¹¾ä½•æŠ•å½±ã€ã€‚</p>

                        <h3>1. è§€å¿µç¿»è½‰ï¼šå‡½æ•¸å°±æ˜¯å‘é‡</h3>
                        <p>æˆ‘å€‘ç¿’æ…£å°‡å‡½æ•¸ $f(x)$ çœ‹ä½œå¹³é¢åæ¨™ä¸Šçš„ä¸€æ¢æ›²ç·šã€‚</p>
                        <p>ä½†åœ¨å‚…ç«‹è‘‰åˆ†æï¼ˆä»¥åŠé‡å­åŠ›å­¸ï¼‰ä¸­ï¼Œè«‹ä½ æˆ´ä¸Šä¸€å‰¯æ–°çš„çœ¼é¡ï¼š<strong>è©¦è‘—å°‡å‡½æ•¸ $f(x)$ æƒ³åƒæˆä¸€å€‹ã€Œç„¡é™ç¶­åº¦ã€çš„å‘é‡ã€‚</strong></p>
                        <p>ç‚ºä»€éº¼å¯ä»¥é€™æ¨£æƒ³ï¼Ÿ</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li><strong>å‘é‡ ($\\mathbf{v}$)ï¼š</strong>æ˜¯ä¸€å€‹æœ‰åºçš„æ•¸åˆ—ï¼Œä¾‹å¦‚ $\\mathbf{v} = (v_1, v_2, \\dots, v_n)$ã€‚ç´¢å¼•æ˜¯é›¢æ•£çš„ $1, 2, \\dots, n$ã€‚</li>
                            <li><strong>å‡½æ•¸ ($f$)ï¼š</strong>ä¹Ÿæ˜¯ä¸€å€‹å°æ‡‰é—œä¿‚ï¼Œå°æ–¼æ¯ä¸€å€‹ $t$ éƒ½æœ‰ä¸€å€‹å€¼ $f(t)$ã€‚å¦‚æœæˆ‘å€‘æŠŠé€£çºŒçš„ $t$ æƒ³åƒæˆç„¡é™å¯†é›†çš„ç´¢å¼•ï¼Œé‚£éº¼ $f(t)$ å°±æ˜¯ä¸€å€‹æœ‰ç„¡çª®å¤šå€‹åˆ†é‡çš„å‘é‡ã€‚</li>
                        </ul>
                        <p>é€™ç¨®æ€ç¶­è½‰æ›è®“æˆ‘å€‘å¯ä»¥æŠŠç·šæ€§ä»£æ•¸å¼·å¤§çš„å·¥å…·ï¼ˆå…§ç©ã€é•·åº¦ã€è§’åº¦ã€æ­£äº¤ï¼‰å€Ÿç”¨åˆ°å¾®ç©åˆ†è£¡ã€‚</p>

                        <h3>2. é‡æ–°å®šç¾©ã€Œå…§ç©ã€ (Inner Product)</h3>
                        <p>åœ¨ $\\mathbb{R}^n$ ç©ºé–“ä¸­ï¼Œå…©å€‹å‘é‡ $\\mathbf{u}, \\mathbf{v}$ çš„å…§ç©ï¼ˆDot Productï¼‰å®šç¾©ç‚ºåˆ†é‡ç›¸ä¹˜å†ç›¸åŠ ï¼š</p>
                        <div class="math-block">$$\\mathbf{u} \\cdot \\mathbf{v} = \\sum_{i=1}^n u_i v_i$$</div>
                        <p>ç•¶æˆ‘å€‘å¾ã€Œé›¢æ•£ã€è·¨è¶Šåˆ°ã€Œé€£çºŒã€æ™‚ï¼Œã€Œæ±‚å’Œ ($\\sum$)ã€å°±è®Šæˆäº†ã€Œç©åˆ† ($\\int$)ã€ã€‚</p>
                        
                        <h4 class="text-white font-bold mt-4">å‡½æ•¸ç©ºé–“çš„å…§ç©å®šç¾©</h4>
                        <p>å°æ–¼å®šç¾©åœ¨å€é–“ $[a, b]$ ä¸Šçš„å…©å€‹å¯¦æ•¸å‡½æ•¸ $f(t)$ èˆ‡ $g(t)$ï¼Œæˆ‘å€‘å®šç¾©å®ƒå€‘çš„å…§ç©ç‚ºï¼š</p>
                        <div class="math-block">$$\\langle f, g \\rangle = \\int_{a}^{b} f(t) g(t) \\, dt$$</div>
                        
                        <p><strong>æ³¨æ„ï¼ˆè¤‡æ•¸ä¿®æ­£ï¼‰ï¼š</strong><br>å‚…ç«‹è‘‰è®Šæ›å¤§é‡æ¶‰åŠè¤‡æ•¸ã€‚åœ¨è¤‡æ•¸å‘é‡ç©ºé–“ä¸­ï¼Œç‚ºäº†ä¿è­‰é•·åº¦ï¼ˆNormï¼‰æ˜¯å¯¦æ•¸ï¼Œå…§ç©çš„å®šç¾©éœ€è¦åŒ…å«ã€Œå…±è»›è¤‡æ•¸ ($\\overline{g(t)}$)ã€ï¼š</p>
                        <div class="math-block">$$\\langle f, g \\rangle = \\int_{a}^{b} f(t) \\overline{g(t)} \\, dt$$</div>

                        <h3>3. æ ¸å¿ƒé­”æ³•ï¼šæ­£äº¤æ€§ (Orthogonality)</h3>
                        <p>é€™æ˜¯å‚…ç«‹è‘‰è®Šæ›æœ€é—œéµçš„æ¦‚å¿µã€‚</p>
                        <p>åœ¨å¹¾ä½•ä¸Šï¼Œå¦‚æœå…©å€‹å‘é‡å‚ç›´ï¼Œå®ƒå€‘çš„å…§ç©ç‚º 0ã€‚</p>
                        <div class="math-block">$$\\mathbf{u} \\perp \\mathbf{v} \\iff \\mathbf{u} \\cdot \\mathbf{v} = 0$$</div>
                        <p>åŒæ¨£åœ°ï¼Œå¦‚æœå…©å€‹å‡½æ•¸çš„å…§ç©ç‚º 0ï¼Œæˆ‘å€‘å°±èªªé€™å…©å€‹å‡½æ•¸æ˜¯<strong>æ­£äº¤ï¼ˆOrthogonalï¼‰</strong>çš„ã€‚é€™æ„å‘³è‘—å®ƒå€‘åœ¨æŸç¨®æŠ½è±¡æ„ç¾©ä¸Šæ˜¯ã€Œäº’ä¸ç›¸é—œã€æˆ–ã€Œå‚ç›´ã€çš„ã€‚</p>

                        <h4 class="text-white font-bold mt-4">ç¶“å…¸ç¯„ä¾‹ï¼šä¸‰è§’å‡½æ•¸ç³»çš„æ­£äº¤æ€§</h4>
                        <p>è®“æˆ‘å€‘é©—è­‰ç‚ºä»€éº¼æ­£å¼¦æ³¢å’Œé¤˜å¼¦æ³¢æ˜¯å¾ˆå¥½çš„ã€Œç©æœ¨ã€ã€‚è€ƒæ…®å€é–“ $[-\\pi, \\pi]$ï¼Œæˆ‘å€‘ä¾†è¨ˆç®— $\\sin(t)$ èˆ‡ $\\cos(t)$ çš„å…§ç©ï¼š</p>
                        <div class="math-block">$$\\langle \\sin(t), \\cos(t) \\rangle = \\int_{-\\pi}^{\\pi} \\sin(t) \\cos(t) \\, dt$$</div>
                        <p>åˆ©ç”¨å€è§’å…¬å¼ $\\sin(t)\\cos(t) = \\frac{1}{2}\\sin(2t)$ï¼š</p>
                        <div class="math-block">$$= \\frac{1}{2} \\int_{-\\pi}^{\\pi} \\sin(2t) \\, dt$$</div>
                        <p>å› ç‚º $\\sin(2t)$ æ˜¯ä¸€å€‹å¥‡å‡½æ•¸ï¼ˆOdd functionï¼‰ï¼Œæˆ–è€…å¾åœ–å½¢ä¸Šçœ‹ï¼Œå®ƒåœ¨ä¸€å€‹å®Œæ•´é€±æœŸå…§çš„æ­£é¢ç©èˆ‡è² é¢ç©å‰›å¥½æŠµéŠ·ï¼š</p>
                        <div class="math-block">$$= 0$$</div>
                        <p><strong>çµè«–ï¼š</strong> $\\sin(t)$ èˆ‡ $\\cos(t)$ åœ¨é€™å€‹å€é–“ä¸Šæ˜¯æ­£äº¤çš„ã€‚é€™å°±åƒ $x$ è»¸èˆ‡ $y$ è»¸ä¸€æ¨£å‚ç›´ã€‚</p>

                        <h3>4. æŠ•å½± (Projection) = å‚…ç«‹è‘‰ä¿‚æ•¸</h3>
                        <p>åœ¨å‘é‡ç©ºé–“ä¸­ï¼Œå¦‚æœä½ æƒ³çŸ¥é“å‘é‡ $\\mathbf{v}$ åœ¨ $x$ è»¸æ–¹å‘çš„åˆ†é‡æ˜¯å¤šå°‘ï¼Œä½ æœƒæ€éº¼åšï¼Ÿä½ æœƒåšæŠ•å½±ï¼ˆå…§ç©ï¼‰ï¼š</p>
                        <div class="math-block">$$\\text{Component} = \\frac{\\mathbf{v} \\cdot \\mathbf{e}_x}{\\mathbf{e}_x \\cdot \\mathbf{e}_x}$$</div>
                        <p>å‚…ç«‹è‘‰ç´šæ•¸çš„æœ¬è³ªå®Œå…¨ä¸€æ¨£ã€‚</p>
                        <p>æˆ‘å€‘æƒ³çŸ¥é“ä¸€å€‹è¤‡é›œè¨Šè™Ÿ $f(t)$ è£¡é¢å«æœ‰å¤šå°‘ã€Œé »ç‡ç‚º $n$ çš„æ­£å¼¦æ³¢æˆåˆ†ã€ï¼Ÿæˆ‘å€‘å°±å°‡ $f(t)$ æŠ•å½±åˆ° $\\sin(nt)$ ä¸Šï¼š</p>
                        <div class="math-block">$$c_n = \\frac{\\langle f, \\sin(nt) \\rangle}{\\langle \\sin(nt), \\sin(nt) \\rangle} = \\frac{\\int f(t)\\sin(nt)dt}{\\int \\sin^2(nt)dt}$$</div>
                        <p>é€™å°±æ˜¯ç‚ºä»€éº¼å‚…ç«‹è‘‰ä¿‚æ•¸çš„å…¬å¼é•·æˆé‚£æ¨£ã€‚å®ƒä¸æ˜¯é­”æ³•ï¼Œå®ƒåªæ˜¯æ±‚æŠ•å½±åˆ†é‡ã€‚</p>

                        <h3>èª²å¾Œæ€è€ƒèˆ‡ç·´ç¿’</h3>
                        <div class="bg-white/5 p-4 rounded-lg border border-white/10 my-4">
                            <p class="text-gray-300 mb-2">é€™å ‚èª²çš„ç›®çš„æ˜¯å»ºç«‹å¹¾ä½•ç›´è§€ã€‚ç‚ºäº†éå›ºé€™ä¸€é»ï¼Œè«‹å˜—è©¦æ€è€ƒä»¥ä¸‹å•é¡Œã€‚</p>
                            <h4 class="text-white font-bold mb-2">ç·´ç¿’é¡Œï¼š</h4>
                            <ol class="list-decimal pl-6 text-gray-300 space-y-2">
                                <li>è­‰æ˜ $\\cos(mt)$ èˆ‡ $\\cos(nt)$ åœ¨å€é–“ $[-\\pi, \\pi]$ ä¸Šæ˜¯æ­£äº¤çš„ï¼ˆå…¶ä¸­ $m, n$ æ˜¯ä¸ç›¸ç­‰çš„æ­£æ•´æ•¸ï¼‰ã€‚</li>
                                <li>è¨ˆç®—å‡½æ•¸ $f(t) = 1$ åœ¨å€é–“ $[0, 1]$ ä¸Šçš„é•·åº¦ï¼ˆNormï¼‰ã€‚æç¤ºï¼šé•·åº¦å¹³æ–¹ = $\\langle f, f \\rangle$ã€‚</li>
                            </ol>
                        </div>

                        <h3>ç·´ç¿’é¡Œè§£ç­”</h3>
                        <p class="text-xs text-gray-500 mb-2">(é»æ“Šä¸‹æ–¹å€åŸŸæŸ¥çœ‹è©³ç´°è¨ˆç®—éç¨‹)</p>
                        <div class="spoiler-blur" onclick="this.classList.add('revealed')">
                            <h4 class="text-white font-bold mt-0">1. è­‰æ˜ $\\cos(mt)$ èˆ‡ $\\cos(nt)$ æ­£äº¤ ($m \\neq n$)</h4>
                            <p>æˆ‘å€‘éœ€è¦è¨ˆç®—å…§ç©ï¼š</p>
                            <div class="math-block">$$I = \\int_{-\\pi}^{\\pi} \\cos(mt) \\cos(nt) \\, dt$$</div>
                            <p>åˆ©ç”¨ç©åŒ–å’Œå·®å…¬å¼ $\\cos A \\cos B = \\frac{1}{2}[\\cos(A-B) + \\cos(A+B)]$ï¼š</p>
                            <div class="math-block">$$I = \\frac{1}{2} \\int_{-\\pi}^{\\pi} [\\cos((m-n)t) + \\cos((m+n)t)] \\, dt$$</div>
                            <p>åˆ†åˆ¥ç©åˆ†ï¼š</p>
                            <div class="math-block">$$I = \\frac{1}{2} \\left[ \\frac{\\sin((m-n)t)}{m-n} + \\frac{\\sin((m+n)t)}{m+n} \\right]_{-\\pi}^{\\pi}$$</div>
                            <p>ç”±æ–¼ $m, n$ ç‚ºæ•´æ•¸ä¸” $m \\neq n$ï¼Œå‰‡ $(m-n)$ èˆ‡ $(m+n)$ å‡ç‚ºæ•´æ•¸ã€‚</p>
                            <p>æˆ‘å€‘çŸ¥é“å°æ–¼ä»»ä½•æ•´æ•¸ $k$ï¼Œ$\\sin(k\\pi) = 0$ã€‚</p>
                            <p>å› æ­¤ï¼Œä»£å…¥ä¸Šä¸‹é™ $\\pi$ å’Œ $-\\pi$ å¾Œï¼Œæ‰€æœ‰é …çš†ç‚º 0ã€‚</p>
                            <div class="math-block">$$I = 0$$</div>
                            <p>å¾—è­‰ï¼Œå…©å‡½æ•¸æ­£äº¤ã€‚</p>
                            
                            <h4 class="text-white font-bold mt-6">2. è¨ˆç®— $f(t) = 1$ åœ¨ $[0, 1]$ ä¸Šçš„é•·åº¦</h4>
                            <p>å‡½æ•¸ $f$ çš„é•·åº¦ï¼ˆNormï¼‰è¨˜ç‚º $\\|f\\|$ï¼Œå®šç¾©ç‚ºï¼š</p>
                            <div class="math-block">$$\\|f\\| = \\sqrt{\\langle f, f \\rangle}$$</div>
                            <p>è¨ˆç®—å…§ç©ï¼š</p>
                            <div class="math-block">$$\\langle f, f \\rangle = \\int_{0}^{1} 1 \\cdot 1 \\, dt = \\int_{0}^{1} 1 \\, dt = [t]_0^1 = 1$$</div>
                            <p>å–å¹³æ–¹æ ¹ï¼š</p>
                            <div class="math-block">$$\\|f\\| = \\sqrt{1} = 1$$</div>
                            <p>ç­”æ¡ˆï¼š$1$</p>
                        </div>
                        
                        <div class="mt-8 p-4 border-t border-white/20">
                            <p class="text-gray-400">å¦‚æœé€™éƒ¨åˆ†çš„æ­£äº¤æ¦‚å¿µæ¸…æ¥šäº†ï¼Œæˆ‘å€‘å°±å¯ä»¥åœ¨ä¸‹ä¸€èª²ç›´æ¥å¼•å…¥æ­æ‹‰å…¬å¼ï¼Œå°‡é€™äº› $\\sin$ å’Œ $\\cos$ æ‰“åŒ…æˆæ›´å„ªé›…çš„ $e^{int}$ã€‚</p>
                        </div>
                    </div>`
            },
2: {
                title: "å¾æ³°å‹’ç´šæ•¸åˆ°å‚…ç«‹è‘‰ç´šæ•¸ (Fourier Series)",
                content: `
                    <div class="lesson-body">
                        <p>é€™æ˜¯æœ‰å²ä»¥ä¾†æœ€å„ªé›…çš„æ•¸å­¸è½‰æ›ä¹‹ä¸€ã€‚</p>
                        <p>åœ¨ç¬¬ä¸€èª²ï¼Œæˆ‘å€‘å­¸æœƒäº†ã€Œå‡½æ•¸æ˜¯å‘é‡ã€ä»¥åŠã€Œä¸‰è§’å‡½æ•¸æ˜¯æ­£äº¤åŸºåº•ã€ã€‚</p>
                        <p>ç¾åœ¨ï¼Œæˆ‘å€‘è¦åˆ©ç”¨é€™äº›åŸºåº•ä¾†æ§‹å»ºä»»æ„é€±æœŸå‡½æ•¸ã€‚é€™å ‚èª²çš„ç›®æ¨™æ˜¯å¾ã€Œç¹ç‘£çš„å¯¦æ•¸ä¸‰è§’å‡½æ•¸ã€é€²åŒ–åˆ°ã€Œå„ªé›…çš„è¤‡æ•¸æŒ‡æ•¸å‡½æ•¸ã€ã€‚</p>

                        <h3>1. å…©ç¨®é€¼è¿‘çš„å“²å­¸ï¼šæ³°å‹’ vs. å‚…ç«‹è‘‰</h3>
                        <p>ç‚ºä»€éº¼æˆ‘å€‘æœ‰äº†æ³°å‹’ç´šæ•¸ï¼ˆTaylor Seriesï¼‰ï¼Œé‚„éœ€è¦å‚…ç«‹è‘‰ç´šæ•¸ï¼Ÿ</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li><strong>æ³°å‹’ç´šæ•¸ï¼š</strong>ä½¿ç”¨å¤šé …å¼åŸºåº• $\\{1, x, x^2, x^3, \\dots\\}$ã€‚<br>
                            <strong>å“²å­¸ï¼š</strong>å®ƒé—œæ³¨ã€Œä¸€é»åŠå…¶é„°åŸŸã€ã€‚åªè¦çŸ¥é“æŸä¸€é»çš„å„éšå°æ•¸ï¼Œå°±èƒ½é€¼è¿‘é™„è¿‘çš„å€¼ã€‚<br>
                            <strong>ç¼ºé»ï¼š</strong>å°æ–¼é é›¢å±•é–‹é»çš„åœ°æ–¹èª¤å·®å·¨å¤§ï¼Œä¸”ç„¡æ³•è™•ç†ã€Œæ–·è£‚ã€ï¼ˆä¸é€£çºŒï¼‰çš„å‡½æ•¸ã€‚</li>
                            <li><strong>å‚…ç«‹è‘‰ç´šæ•¸ï¼š</strong>ä½¿ç”¨æ³¢å‹•åŸºåº• $\\{1, \\cos t, \\sin t, \\cos 2t, \\sin 2t, \\dots\\}$ã€‚<br>
                            <strong>å“²å­¸ï¼š</strong>å®ƒé—œæ³¨ã€Œæ•´é«”èˆ‡é€±æœŸã€ã€‚å®ƒå˜—è©¦ç”¨ç„¡çª®å¤šå€‹éœ‡ç›ªä¾†æ‹¼æ¹Šå‡ºæ•´å€‹å‡½æ•¸çš„å…¨è²Œã€‚<br>
                            <strong>å„ªé»ï¼š</strong>å¯ä»¥å®Œç¾è™•ç†é€±æœŸå‡½æ•¸ï¼Œç”šè‡³æ˜¯ä¸é€£çºŒçš„å‡½æ•¸ï¼ˆå¦‚æ–¹æ³¢ï¼‰ã€‚</li>
                        </ul>

                        <h3>2. å‚³çµ±å½¢å¼ï¼šä¸‰è§’ç´šæ•¸ (The Trigonometric Form)</h3>
                        <p>å°æ–¼ä¸€å€‹é€±æœŸç‚º $2\\pi$ çš„å‡½æ•¸ $f(t)$ï¼Œæˆ‘å€‘å¯ä»¥å¯«æˆï¼š</p>
                        <div class="math-block">$$f(t) = \\frac{a_0}{2} + \\sum_{n=1}^{\\infty} [a_n \\cos(nt) + b_n \\sin(nt)]$$</div>
                        <p>é€™è£¡çš„ä¿‚æ•¸ $a_n, b_n$ æ€éº¼ç®—ï¼Ÿå›æƒ³ç¬¬ä¸€èª²çš„ã€ŒæŠ•å½±ã€æ¦‚å¿µã€‚æˆ‘å€‘è¦æŠŠ $f(t)$ æŠ•å½±åˆ° $\\cos(nt)$ å’Œ $\\sin(nt)$ ä¸Šã€‚</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li><strong>ç›´æµåˆ†é‡ (å¹³å‡å€¼)ï¼š</strong><br>$$a_0 = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(t) \\, dt$$</li>
                            <li><strong>é¤˜å¼¦åˆ†é‡ï¼š</strong><br>$$a_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(t) \\cos(nt) \\, dt$$</li>
                            <li><strong>æ­£å¼¦åˆ†é‡ï¼š</strong><br>$$b_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(t) \\sin(nt) \\, dt$$</li>
                        </ul>
                        <p><strong>æ‰¹åˆ¤ï¼š</strong>é€™å¾ˆç¹ç‘£ã€‚æˆ‘å€‘è¦ç®—ä¸‰å€‹ç©åˆ†ï¼Œé‚„è¦è¨˜ä½ $\\sin$ å’Œ $\\cos$ çš„ä¸åŒå…¬å¼ã€‚æœ‰æ²’æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Ÿ</p>

                        <h3>3. æ ¸å¿ƒæ­¦å™¨ï¼šæ­æ‹‰å…¬å¼ (Euler's Formula)</h3>
                        <p>é€™æ˜¯æ•¸å­¸ç•Œæœ€è‘—åçš„å…¬å¼ä¹‹ä¸€ï¼Œå®ƒé€£æ¥äº†ä¸‰è§’å‡½æ•¸èˆ‡è¤‡æ•¸æŒ‡æ•¸ï¼š</p>
                        <div class="math-block">$$e^{ix} = \\cos x + i \\sin x$$</div>
                        <p>é€™æ„å‘³è‘—ï¼šæ—‹è½‰ï¼ˆè¤‡æ•¸æŒ‡æ•¸ï¼‰åŒ…å«äº†éœ‡ç›ªï¼ˆæ­£å¼¦èˆ‡é¤˜å¼¦ï¼‰ã€‚</p>
                        <p>åéä¾†ï¼Œæˆ‘å€‘å¯ä»¥ç”¨æŒ‡æ•¸ä¾†è¡¨ç¤ºä¸‰è§’å‡½æ•¸ï¼š</p>
                        <div class="math-block">$$\\cos x = \\frac{e^{ix} + e^{-ix}}{2}, \\quad \\sin x = \\frac{e^{ix} - e^{-ix}}{2i}$$</div>

                        <h3>4. ç¾ä»£å½¢å¼ï¼šè¤‡æ•¸æŒ‡æ•¸ç´šæ•¸ (Complex Exponential Form)</h3>
                        <p>åˆ©ç”¨æ­æ‹‰å…¬å¼ï¼Œæˆ‘å€‘å¯ä»¥å°‡ä¸Šè¿°ç¹é›œçš„ä¸‰è§’ç´šæ•¸ã€Œçµ±ä¸€ã€ç‚ºä¸€å€‹æ¥µå…¶ç°¡æ½”çš„å¼å­ã€‚</p>
                        <p>æˆ‘å€‘ä¸å†å°‡æ³¢çœ‹ä½œä¸Šä¸‹éœ‡ç›ªï¼Œè€Œæ˜¯çœ‹ä½œåœ¨è¤‡æ•¸å¹³é¢ä¸Šçš„åœ“å‘¨é‹å‹•ã€‚</p>
                        <p><strong>å‚…ç«‹è‘‰ç´šæ•¸çš„ç¾ä»£å½¢å¼ï¼š</strong></p>
                        <div class="math-block">$$f(t) = \\sum_{n=-\\infty}^{\\infty} c_n e^{int}$$</div>
                        <p>æ³¨æ„æ±‚å’Œç¯„åœè®Šæˆäº†å¾ $-\\infty$ åˆ° $\\infty$ï¼ˆåŒ…å«è² é »ç‡ï¼‰ã€‚é€™è£¡çš„ä¿‚æ•¸ $c_n$ åªæœ‰ä¸€å€‹çµ±ä¸€çš„å…¬å¼ï¼ˆå†æ¬¡åˆ©ç”¨å…§ç©æŠ•å½±ï¼‰ï¼š</p>
                        <div class="math-block">$$c_n = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} f(t) e^{-int} \\, dt$$</div>
                        <p>é€™å€‹å…¬å¼çš„ç¾å¦™ä¹‹è™•ï¼š</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li><strong>çµ±ä¸€æ€§ï¼š</strong>ä¸éœ€è¦åˆ†é–‹ç®— $a_0, a_n, b_n$ã€‚ä¸€å€‹ $c_n$ æå®šæ‰€æœ‰ã€‚</li>
                            <li><strong>å¹¾ä½•æ„ç¾©ï¼š</strong>$e^{-int}$ ä»£è¡¨é †æ™‚é‡æ—‹è½‰ï¼Œ$f(t) e^{-int}$ çš„ç©åˆ†æœ¬è³ªä¸Šæ˜¯åœ¨è¨ˆç®— $f(t)$ ä¸­å«æœ‰å¤šå°‘é »ç‡ç‚º $n$ çš„æ—‹è½‰åˆ†é‡ã€‚</li>
                        </ul>

                        <h3>5. æ”¶æ–‚æ€§èˆ‡ä»£åƒ¹ï¼šå‰å¸ƒæ–¯ç¾è±¡ (Gibbs Phenomenon)</h3>
                        <p>å‚…ç«‹è‘‰ç´šæ•¸å¾ˆå¼·å¤§ï¼Œä½†ä¸æ˜¯å®Œç¾çš„ã€‚</p>
                        <p>ç•¶æˆ‘å€‘ç”¨é€£çºŒçš„å¼¦æ³¢å»é€¼è¿‘ä¸€å€‹ä¸é€£çºŒçš„è¨Šè™Ÿï¼ˆä¾‹å¦‚æ–¹æ³¢çš„å‚ç›´é‚Šç·£ï¼‰æ™‚ï¼Œæœƒç™¼ç”Ÿä»€éº¼äº‹ï¼Ÿ</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li><strong>ç‹„åˆ©å…‹é›·æ¢ä»¶ (Dirichlet Conditions)ï¼š</strong>åªè¦å‡½æ•¸æ»¿è¶³å¹¾å€‹æº«å’Œçš„æ¢ä»¶ï¼ˆçµ•å°å¯ç©ã€æœ‰é™å€‹æ¥µå€¼é»å’Œä¸é€£çºŒé»ï¼‰ï¼Œç´šæ•¸å°±æœƒæ”¶æ–‚ã€‚</li>
                            <li><strong>å‰å¸ƒæ–¯ç¾è±¡ï¼š</strong>åœ¨ä¸é€£çºŒé»é™„è¿‘ï¼Œç´šæ•¸æœƒå‡ºç¾ã€Œéè¡ã€ï¼ˆOvershootï¼‰ï¼Œæœƒæœ‰ç´„ 9% çš„çªèµ·ã€‚ç„¡è«–ä½ ç–ŠåŠ å¤šå°‘é …ï¼Œé€™å€‹çªèµ·éƒ½ä¸æœƒæ¶ˆå¤±ï¼Œåªæœƒè®Šå¾—æ›´çª„ã€‚é€™æ˜¯ç”¨ã€Œå¹³æ»‘ã€å»é€¼è¿‘ã€Œå°–éŠ³ã€å¿…é ˆä»˜å‡ºçš„ä»£åƒ¹ã€‚</li>
                        </ul>

                        <h3>èª²å¾Œç·´ç¿’ (Calculus & Analysis)</h3>
                        <div class="bg-white/5 p-4 rounded-lg border border-white/10 my-4">
                            <h4 class="text-white font-bold mb-2">é¡Œç›®ï¼šæ–¹æ³¢çš„è¤‡æ•¸å‚…ç«‹è‘‰ç´šæ•¸</h4>
                            <p class="text-gray-300">ç‚ºäº†ç†Ÿæ‚‰è¤‡æ•¸å½¢å¼çš„æ“ä½œï¼Œè«‹å˜—è©¦è§£æ±ºä»¥ä¸‹ç¶“å…¸å•é¡Œã€‚</p>
                            <p class="text-gray-300 mt-2">è¨­æœ‰ä¸€é€±æœŸç‚º $2\\pi$ çš„æ–¹æ³¢å‡½æ•¸ $f(t)$ï¼Œå®šç¾©å¦‚ä¸‹ï¼š</p>
                            <div class="math-block">
                                $$f(t) = \\begin{cases} 
                                -1, & -\\pi < t < 0 \\\\
                                1, & 0 < t < \\pi 
                                \\end{cases}$$
                            </div>
                            <p class="text-gray-300">è«‹è¨ˆç®—å…¶è¤‡æ•¸å‚…ç«‹è‘‰ä¿‚æ•¸ $c_n$ã€‚</p>
                            <p class="text-xs text-gray-500 mt-2">(æç¤ºï¼šåˆ†åˆ¥å°å…©æ®µå€é–“ç©åˆ†ï¼Œæ³¨æ„ $n=0$ çš„æƒ…æ³éœ€å–®ç¨è¨è«–æˆ–è§€å¯Ÿåœ–å½¢ã€‚)</p>
                        </div>

                        <h3>ç·´ç¿’é¡Œè§£ç­”</h3>
                        <p class="text-xs text-gray-500 mb-2">(é»æ“Šä¸‹æ–¹å€åŸŸæŸ¥çœ‹è©³ç´°è¨ˆç®—éç¨‹)</p>
                        <div class="spoiler-blur" onclick="this.classList.add('revealed')">
                            <h4 class="text-white font-bold mt-0">é¡Œç›®ï¼šè¨ˆç®—æ–¹æ³¢ $f(t)$ çš„è¤‡æ•¸å‚…ç«‹è‘‰ä¿‚æ•¸ $c_n$</h4>
                            
                            <p>æ ¹æ“šå®šç¾©å…¬å¼ï¼š</p>
                            <div class="math-block">$$c_n = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} f(t) e^{-int} \\, dt$$</div>

                            <h4 class="text-white font-bold mt-4">æ­¥é©Ÿ 1ï¼šè™•ç† $n=0$ (ç›´æµåˆ†é‡)</h4>
                            <div class="math-block">$$c_0 = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} f(t) \\, dt$$</div>
                            <p>ç”±æ–¼ $f(t)$ æ˜¯å¥‡å‡½æ•¸ï¼ˆæ­£è² é¢ç©æŠµéŠ·ï¼‰ï¼Œç©åˆ†ç‚º 0ã€‚</p>
                            <p>$$c_0 = 0$$</p>

                            <h4 class="text-white font-bold mt-4">æ­¥é©Ÿ 2ï¼šè™•ç† $n \\neq 0$</h4>
                            <p>å°‡ç©åˆ†å€é–“æ‹†ç‚ºå…©æ®µï¼š</p>
                            <div class="math-block">$$c_n = \\frac{1}{2\\pi} \\left[ \\int_{-\\pi}^{0} (-1) e^{-int} \\, dt + \\int_{0}^{\\pi} (1) e^{-int} \\, dt \\right]$$</div>
                            <p>è¨ˆç®—ä¸å®šç©åˆ† $\\int e^{-int} dt = \\frac{e^{-int}}{-in}$ï¼š</p>
                            <div class="math-block">
                                $$c_n = \\frac{1}{2\\pi} \\left( - \\left[ \\frac{e^{-int}}{-in} \\right]_{-\\pi}^{0} + \\left[ \\frac{e^{-int}}{-in} \\right]_{0}^{\\pi} \\right)$$
                            </div>
                            <p>æå–ä¿‚æ•¸ $\\frac{1}{2\\pi (-in)} = \\frac{i}{2\\pi n}$ (æ³¨æ„ $1/(-i) = i$)ï¼š</p>
                            <div class="math-block">
                                $$c_n = \\frac{i}{2\\pi n} \\left( -[1 - e^{in\\pi}] + [e^{-in\\pi} - 1] \\right)$$
                                $$c_n = \\frac{i}{2\\pi n} \\left( -1 + e^{in\\pi} + e^{-in\\pi} - 1 \\right)$$
                                $$c_n = \\frac{i}{2\\pi n} \\left( e^{in\\pi} + e^{-in\\pi} - 2 \\right)$$
                            </div>
                            <p>æˆ‘å€‘çŸ¥é“ $e^{in\\pi} = \\cos(n\\pi) = (-1)^n$ï¼š</p>
                            <div class="math-block">
                                $$c_n = \\frac{i}{2\\pi n} \\left( (-1)^n + (-1)^n - 2 \\right)$$
                                $$c_n = \\frac{i}{2\\pi n} ( 2(-1)^n - 2 )$$
                                $$c_n = \\frac{i}{\\pi n} ( (-1)^n - 1 )$$
                            </div>

                            <h4 class="text-white font-bold mt-4">æ­¥é©Ÿ 3ï¼šåˆ†æçµæœ</h4>
                            <ul class="list-disc pl-6 text-gray-300 mb-4">
                                <li>ç•¶ $n$ ç‚ºå¶æ•¸æ™‚ï¼Œ $(-1)^n = 1$ï¼Œå‰‡ $c_n = 0$ã€‚</li>
                                <li>ç•¶ $n$ ç‚ºå¥‡æ•¸æ™‚ï¼Œ $(-1)^n = -1$ï¼Œå‰‡ $c_n = \\frac{i}{\\pi n} (-2) = \\frac{-2i}{n\\pi}$ã€‚</li>
                            </ul>
                            
                            <div class="highlight">
                                <p><strong>ç­”æ¡ˆï¼š</strong></p>
                                <div class="math-block">
                                    $$c_n = \\begin{cases} 
                                    0, & n \\text{ ç‚ºå¶æ•¸} \\\\
                                    \\frac{-2i}{n\\pi}, & n \\text{ ç‚ºå¥‡æ•¸}
                                    \\end{cases}$$
                                </div>
                            </div>
                        </div>
                    </div>`
            },
3: {
                title: "é€£çºŒå‚…ç«‹è‘‰è®Šæ› (CFT)",
                content: `
                    <div class="lesson-body">
                        <p>é€™æ˜¯ä¸€æ¬¡è§€å¿µä¸Šçš„å·¨å¤§é£›èºã€‚</p>
                        <p>åœ¨å‰å…©èª²ï¼Œæˆ‘å€‘è™•ç†çš„éƒ½æ˜¯ã€Œé€±æœŸå‡½æ•¸ã€â€”â€”é‚£äº›åœ¨æ™‚é–“è»¸ä¸Šä¸æ–·é‡è¤‡çš„æ³¢å½¢ã€‚</p>
                        <p>ä½†ç¾å¯¦ä¸–ç•Œä¸­ï¼Œå¤§å¤šæ•¸è¨Šè™Ÿæ˜¯éé€±æœŸçš„ï¼šä¸€è²æ§éŸ¿ã€ä¸€æ¬¡è‚¡ç¥¨å´©ç›¤ã€ä¸€å¥è©±ã€‚é€™äº›è¨Šè™Ÿç™¼ç”Ÿä¸€æ¬¡å°±æ¶ˆå¤±äº†ã€‚æˆ‘å€‘å¦‚ä½•ç”¨ã€Œæ°¸é éœ‡ç›ªã€çš„æ­£å¼¦æ³¢ï¼Œä¾†è¡¨ç¤ºã€Œç¬é–“æ¶ˆå¤±ã€çš„è¨Šè™Ÿï¼Ÿ</p>
                        <p><strong>ç­”æ¡ˆæ˜¯ï¼šå°‡é€±æœŸæ¨å‘ç„¡çª®å¤§ã€‚</strong></p>

                        <h3>1. å“²å­¸æ¨å°ï¼šå¾ç± ä¸­é³¥åˆ°è‡ªç”±é³¥</h3>
                        <p>æƒ³åƒä¸€å€‹é€±æœŸç‚º $T$ çš„æ–¹æ³¢ã€‚ç•¶ $T$ å¾ˆå°æ™‚ï¼Œæ³¢å½¢ç·Šå¯†é‡è¤‡ã€‚é »è­œæ˜¯ç¨€ç–çš„ï¼ˆåªæœ‰åŸºé » $\\omega_0$ çš„æ•´æ•¸å€ï¼‰ã€‚</p>
                        <p>ç•¶æˆ‘å€‘æŠŠé€±æœŸ $T$ æ‹‰å¤§ï¼Œæ³¢å½¢ä¹‹é–“çš„é–“éš”è®Šå¤§ã€‚é »è­œç·šæœƒç™¼ç”Ÿä»€éº¼äº‹ï¼Ÿå®ƒå€‘æœƒè®Šå¾—è¶Šä¾†è¶Šå¯†é›†ã€‚</p>
                        <p>ç•¶ $T \\to \\infty$ æ™‚ï¼Œå–®å€‹æ³¢å½¢è®Šæˆäº†å­¤ç«‹çš„è„ˆè¡ã€‚æ­¤æ™‚ï¼Œé »è­œç·šä¹‹é–“çš„è·é›¢ $\\Delta \\omega = \\frac{2\\pi}{T}$ è¶¨è¿‘æ–¼ 0ã€‚</p>
                        <div class="highlight">
                            <p><strong>é›¢æ•£çš„é »è­œç·šèåŒ–æˆäº†é€£çºŒçš„é »è­œæ›²ç·šã€‚</strong></p>
                        </div>

                        <h3>2. å®šç¾©ï¼šé€£çºŒå‚…ç«‹è‘‰è®Šæ›</h3>
                        <p>æˆ‘å€‘ä¸å†æ±‚å’Œï¼ˆSummationï¼‰ï¼Œè€Œæ˜¯ç©åˆ†ï¼ˆIntegrationï¼‰ã€‚ä¿‚æ•¸ $c_n$ è®Šæˆäº†å‡½æ•¸ $F(\\omega)$ã€‚</p>
                        <p>é€™å°±æ˜¯å¤§åé¼é¼çš„å‚…ç«‹è‘‰è®Šæ›å°ï¼š</p>
                        
                        <p><strong>(1) å‚…ç«‹è‘‰è®Šæ› (åˆ†æ Analysis)</strong></p>
                        <p>å°‡æ™‚é–“è¨Šè™Ÿåˆ†è§£ç‚ºé »ç‡æˆåˆ†ï¼š</p>
                        <div class="math-block">$$F(\\omega) = \\int_{-\\infty}^{\\infty} f(t) e^{-i\\omega t} \\, dt$$</div>
                        <p><strong>æ„ç¾©ï¼š</strong>$F(\\omega)$ ä¸å†ä»£è¡¨æŸå€‹é »ç‡çš„ã€ŒæŒ¯å¹…ã€ï¼Œè€Œæ˜¯ä»£è¡¨è©²é »ç‡è™•çš„<strong>é »è­œå¯†åº¦ (Spectral Density)</strong>ã€‚</p>

                        <p><strong>(2) å‚…ç«‹è‘‰åè®Šæ› (åˆæˆ Synthesis)</strong></p>
                        <p>å°‡é »ç‡æˆåˆ†é‡çµ„å›æ™‚é–“è¨Šè™Ÿï¼š</p>
                        <div class="math-block">$$f(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} F(\\omega) e^{i\\omega t} \\, d\\omega$$</div>
                        <p><strong>æ„ç¾©ï¼š</strong>æˆ‘å€‘éœ€è¦ç©åˆ†ï¼ˆåŠ ç¸½ï¼‰æ‰€æœ‰å¯èƒ½çš„é »ç‡ $\\omega$ï¼Œæ‰èƒ½é‚„åŸå‡ºåŸæœ¬çš„è¨Šè™Ÿã€‚å‰é¢çš„ $\\frac{1}{2\\pi}$ æ˜¯ç‚ºäº†å¹³è¡¡ $d\\omega$ å¸¶ä¾†çš„ä¿‚æ•¸å·®ç•°ã€‚</p>

                        <h3>3. é—œéµæ€§è³ªï¼šå°å¶æ€§ (Duality)</h3>
                        <p>ä»”ç´°çœ‹ä¸Šé¢å…©å€‹å…¬å¼ï¼Œå®ƒå€‘é©šäººåœ°ç›¸ä¼¼ã€‚é€™æš—ç¤ºäº†æ™‚åŸŸå’Œé »åŸŸçš„åœ°ä½æ˜¯å°ç­‰çš„ã€‚</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li>å¦‚æœåœ¨æ™‚åŸŸæ˜¯ä¸€å€‹çª„è„ˆè¡ï¼ˆçŸ­æš«çš„è¨Šè™Ÿï¼‰ï¼Œåœ¨é »åŸŸå°±æœƒæ˜¯ä¸€å€‹å¯¬é »è­œï¼ˆéœ€è¦å¾ˆå¤šé »ç‡æ‰èƒ½åˆæˆå®ƒï¼‰ã€‚</li>
                            <li>å¦‚æœåœ¨æ™‚åŸŸæ˜¯ä¸€å€‹ç„¡é™é•·çš„å¼¦æ³¢ï¼ˆå–®ä¸€é »ç‡ï¼‰ï¼Œåœ¨é »åŸŸå°±æœƒæ˜¯ä¸€å€‹çª„è„ˆè¡ã€‚</li>
                        </ul>
                        <p><strong>ç›´è§€æ³•å‰‡ï¼š</strong>æ™‚åŸŸè¶Šé›†ä¸­ï¼Œé »åŸŸè¶Šç™¼æ•£ï¼›æ™‚åŸŸè¶Šç™¼æ•£ï¼Œé »åŸŸè¶Šé›†ä¸­ã€‚é€™å°±æ˜¯å¾Œä¾†æµ·æ£®å ¡ä¸ç¢ºå®šæ€§åŸç†çš„æ•¸å­¸æ ¹æºã€‚</p>

                        <h3>4. é‡è¦ç¯„ä¾‹ï¼šçŸ©å½¢æ³¢ (Rect) èˆ‡ Sinc å‡½æ•¸</h3>
                        <p>è€ƒæ…®ä¸€å€‹æœ€ç°¡å–®çš„éé€±æœŸè¨Šè™Ÿï¼šçŸ©å½¢è„ˆè¡ï¼ˆé–€å‡½æ•¸ï¼‰ã€‚</p>
                        <div class="math-block">
                            $$\\text{rect}(t) = \\begin{cases} 
                            1, & |t| < 0.5 \\\\
                            0, & |t| > 0.5 
                            \\end{cases}$$
                        </div>
                        <p>å®ƒçš„å‚…ç«‹è‘‰è®Šæ›çµæœæ˜¯è‘—åçš„ <strong>Sinc å‡½æ•¸</strong> ($\\frac{\\sin x}{x}$)ã€‚</p>
                        <p>é€™å€‹çµæœå‘Šè¨´æˆ‘å€‘ï¼šä¸€å€‹é‚Šç·£éŠ³åˆ©çš„æ–¹å½¢æ³¢ï¼ŒåŒ…å«äº†æ‰€æœ‰é »ç‡ï¼Œè€Œä¸”é«˜é »åˆ†é‡è¡°æ¸›å¾—å¾ˆæ…¢ã€‚é€™å°±æ˜¯ç‚ºä»€éº¼æ•¸ä½è¨Šè™Ÿä¸­çš„æ–¹æ³¢å¾ˆå®¹æ˜“ç”¢ç”Ÿé›œè¨Šå¹²æ“¾çš„åŸå› ã€‚</p>

                        <h3>èª²å¾Œç·´ç¿’ (Calculus Problem)</h3>
                        <div class="bg-white/5 p-4 rounded-lg border border-white/10 my-4">
                            <h4 class="text-white font-bold mb-2">é¡Œç›®ï¼šå–®é‚ŠæŒ‡æ•¸å‡½æ•¸çš„å‚…ç«‹è‘‰è®Šæ›</h4>
                            <p class="text-gray-300">è¨­å‡½æ•¸ $f(t)$ å®šç¾©ç‚ºï¼š</p>
                            <div class="math-block">$$f(t) = e^{-at} u(t)$$</div>
                            <p class="text-gray-300">å…¶ä¸­ $a > 0$ ç‚ºå¸¸æ•¸ï¼Œ$u(t)$ ç‚ºå–®ä½éšèºå‡½æ•¸ï¼ˆ$t \\ge 0$ æ™‚ç‚º 1ï¼Œå¦å‰‡ç‚º 0ï¼‰ã€‚</p>
                            <p class="text-gray-300">è«‹è¨ˆç®—å…¶å‚…ç«‹è‘‰è®Šæ› $F(\\omega) = \\int_{-\\infty}^{\\infty} f(t) e^{-i\\omega t} \\, dt$ã€‚</p>
                        </div>

                        <h3>ç·´ç¿’é¡Œè§£ç­”</h3>
                        <p class="text-xs text-gray-500 mb-2">(é»æ“Šä¸‹æ–¹å€åŸŸæŸ¥çœ‹è©³ç´°è¨ˆç®—éç¨‹)</p>
                        <div class="spoiler-blur" onclick="this.classList.add('revealed')">
                            <h4 class="text-white font-bold mt-0">é¡Œç›®ï¼šè¨ˆç®— $f(t) = e^{-at} u(t)$ çš„å‚…ç«‹è‘‰è®Šæ› ($a>0$)</h4>
                            
                            <p><strong>1. è¨­å®šç©åˆ†</strong></p>
                            <p>æ ¹æ“šå®šç¾©ï¼Œå› ç‚º $u(t)$ åœ¨ $t<0$ æ™‚ç‚º 0ï¼Œç©åˆ†ä¸‹é™è®Šç‚º 0ï¼š</p>
                            <div class="math-block">$$F(\\omega) = \\int_{0}^{\\infty} e^{-at} e^{-i\\omega t} \\, dt$$</div>
                            <p>åˆä½µæŒ‡æ•¸é …ï¼š</p>
                            <div class="math-block">$$F(\\omega) = \\int_{0}^{\\infty} e^{-(a + i\\omega)t} \\, dt$$</div>

                            <p><strong>2. è¨ˆç®—ç‘•ç©åˆ†</strong></p>
                            <div class="math-block">$$F(\\omega) = \\left[ \\frac{e^{-(a + i\\omega)t}}{-(a + i\\omega)} \\right]_{0}^{\\infty}$$</div>
                            
                            <p><strong>3. åˆ†æä¸Šä¸‹é™</strong></p>
                            <ul class="list-disc pl-6 text-gray-300 mb-4">
                                <li><strong>ä¸Šé™ ($t \\to \\infty$)ï¼š</strong><br> $|e^{-(a + i\\omega)t}| = |e^{-at} \\cdot e^{-i\\omega t}| = e^{-at}$ã€‚<br>å› ç‚ºé¡Œç›®çµ¦å®š $a > 0$ï¼Œç•¶ $t \\to \\infty$ æ™‚ï¼Œ$e^{-at} \\to 0$ã€‚æ‰€ä»¥ä¸Šé™å€¼ç‚º 0ã€‚</li>
                                <li><strong>ä¸‹é™ ($t = 0$)ï¼š</strong><br> $e^{-(a + i\\omega)0} = e^0 = 1$ã€‚</li>
                            </ul>

                            <p><strong>4. ä»£å…¥è¨ˆç®—</strong></p>
                            <div class="math-block">$$F(\\omega) = 0 - \\frac{1}{-(a + i\\omega)} = \\frac{1}{a + i\\omega}$$</div>
                            
                            <div class="highlight">
                                <p><strong>ç­”æ¡ˆï¼š</strong></p>
                                <div class="math-block">$$F(\\omega) = \\frac{1}{a + i\\omega}$$</div>
                            </div>
                            <p class="text-xs text-gray-400">è¨»ï¼šé€™æ˜¯ä¸€å€‹è¤‡æ•¸å‡½æ•¸ã€‚å…¶å¤§å° $|F(\\omega)| = \\frac{1}{\\sqrt{a^2 + \\omega^2}}$ å‘ˆç¾æ´›å€«èŒ²åˆ†ä½ˆ/é˜å½¢æ›²ç·šï¼Œä»£è¡¨ä½é »æˆåˆ†å¼·ï¼Œé«˜é »æˆåˆ†éš¨ $\\omega$ å¢åŠ è€Œè¡°æ¸›ã€‚</p>
                        </div>
                    </div>`
            },
4: {
                title: "å·ç©å®šç†èˆ‡ç³»çµ±ç†è«– (Convolution & LTI Systems)",
                content: `
                    <div class="lesson-body">
                        <h3>1. ä»€éº¼æ˜¯ã€Œå·ç©ã€ (Convolution)ï¼Ÿ</h3>
                        <p>åœ¨æ•¸å­¸ä¸Šï¼Œå·ç©æ˜¯ä¸€ç¨®é‹ç®—ï¼Œå°‡å…©å€‹å‡½æ•¸ $f(t)$ å’Œ $g(t)$ çµåˆç”¢ç”Ÿç¬¬ä¸‰å€‹å‡½æ•¸ã€‚ç¬¦è™Ÿè¨˜ä½œ $f * g$ã€‚</p>
                        <p>å®šç¾©å¦‚ä¸‹ï¼š</p>
                        <div class="math-block">$$(f * g)(t) = \\int_{-\\infty}^{\\infty} f(\\tau) g(t - \\tau) \\, d\\tau$$</div>
                        <p>é€™å€‹å…¬å¼çœ‹èµ·ä¾†æœ‰é»å¯æ€•ï¼Œè®“æˆ‘å€‘æ‹†è§£å®ƒçš„ç‰©ç†å‹•ä½œï¼š</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li><strong>ç¿»è½‰ (Flip)ï¼š</strong>å°‡ $g(\\tau)$ è®Šæˆ $g(-\\tau)$ã€‚</li>
                            <li><strong>å¹³ç§» (Shift)ï¼š</strong>å°‡ç¿»è½‰å¾Œçš„å‡½æ•¸å‘å³ç§»å‹• $t$ï¼Œè®Šæˆ $g(t-\\tau)$ã€‚</li>
                            <li><strong>ä¹˜ç© (Multiply)ï¼š</strong>å°‡ $f(\\tau)$ èˆ‡å¹³ç§»å¾Œçš„ $g$ ç›¸ä¹˜ã€‚</li>
                            <li><strong>ç©åˆ† (Integrate)ï¼š</strong>è¨ˆç®—é‡ç–Šå€åŸŸçš„é¢ç©ã€‚</li>
                        </ul>
                        <p><strong>ç›´è§€ç†è§£ï¼š</strong></p>
                        <p>æƒ³åƒä½ åœ¨æ‰“è€³å…‰ã€‚$f(\\tau)$ æ˜¯ä½ æ‰“è€³å…‰çš„åŠ›é“åºåˆ—ï¼Œ$g(t)$ æ˜¯è‡‰è¢«æ‰“ä¹‹å¾Œçš„ç´…è…«æ¶ˆé€€éç¨‹ï¼ˆç³»çµ±åæ‡‰ï¼‰ã€‚</p>
                        <p>ç•¶ä½ é€£çºŒæ‰“è€³å…‰æ™‚ï¼Œæ­¤åˆ»è‡‰çš„ç´…è…«ç¨‹åº¦ï¼Œæ˜¯ä½ éå»æ‰€æœ‰è€³å…‰é€ æˆçš„æ®˜ç•™ç´…è…«çš„ç¸½å’Œã€‚é€™å°±æ˜¯å·ç©ï¼š<strong>éå»æ‰€æœ‰è¼¸å…¥å°ç¾åœ¨çš„ç´¯ç©å½±éŸ¿ã€‚</strong></p>

                        <h3>2. å·ç©å®šç† (The Convolution Theorem)</h3>
                        <p>ç›´æ¥è¨ˆç®—ä¸Šé¢çš„ç©åˆ†é€šå¸¸éå¸¸ç—›è‹¦ã€‚ä½†å‚…ç«‹è‘‰è®Šæ›çµ¦äº†æˆ‘å€‘ä¸€å€‹å¥‡è¹Ÿèˆ¬çš„æ·å¾‘ã€‚</p>
                        <div class="highlight">
                            <p><strong>å®šç†ï¼š</strong>æ™‚åŸŸä¸­çš„å·ç©ï¼Œç­‰æ–¼é »åŸŸä¸­çš„ä¹˜ç©ã€‚</p>
                            <div class="math-block">$$\\mathcal{F}\\{ (f * g)(t) \\} = F(\\omega) \\cdot G(\\omega)$$</div>
                        </div>
                        <p><strong>å“²å­¸æ„ç¾©ï¼š</strong>é€™è§£é‡‹äº†ç‚ºä»€éº¼æˆ‘å€‘è¦é€²å…¥é »åŸŸã€‚åœ¨æ™‚åŸŸä¸­è¤‡é›œç³¾çºçš„ã€Œå·ç©é‹ç®—ã€ï¼ˆå¾®ç©åˆ†ï¼‰ï¼Œåœ¨é »åŸŸä¸­è®Šæˆäº†å–®ç´”çš„ã€Œä¹˜æ³•é‹ç®—ã€ï¼ˆä»£æ•¸ï¼‰ã€‚é€™è®“å¾®åˆ†æ–¹ç¨‹çš„æ±‚è§£è®Šå¾—åƒåœ‹ä¸­ä»£æ•¸ä¸€æ¨£ç°¡å–®ã€‚</p>

                        <h3>3. LTI ç³»çµ±èˆ‡è„ˆè¡éŸ¿æ‡‰ (Impulse Response)</h3>
                        <p>é€™å¥—ç†è«–ä¸»è¦æ‡‰ç”¨æ–¼ç·šæ€§éæ™‚è®Šç³»çµ± (Linear Time-Invariant Systems, LTI)ã€‚</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li><strong>è„ˆè¡éŸ¿æ‡‰ $h(t)$ï¼š</strong>å¦‚æœæˆ‘å€‘çµ¦ç³»çµ±ä¸€å€‹ç¬é–“çš„è¡æ“Šï¼ˆç‹„æ‹‰å…‹ $\\delta$ å‡½æ•¸ï¼‰ï¼Œç³»çµ±çš„åæ‡‰ç¨±ç‚º $h(t)$ã€‚</li>
                            <li><strong>ä»»æ„è¼¸å…¥çš„åæ‡‰ï¼š</strong>å¦‚æœæˆ‘å€‘çŸ¥é“äº†ç³»çµ±å° $\\delta(t)$ çš„åæ‡‰æ˜¯ $h(t)$ï¼Œé‚£éº¼æ ¹æ“šç·šæ€§ç–ŠåŠ åŸç†ï¼Œç³»çµ±å°ä»»ä½•è¼¸å…¥ $x(t)$ çš„åæ‡‰ $y(t)$ å°±æ˜¯è¼¸å…¥èˆ‡ $h(t)$ çš„å·ç©ï¼š
                            <div class="math-block">$$y(t) = x(t) * h(t)$$</div>
                            </li>
                        </ul>

                        <h3>4. é »ç‡éŸ¿æ‡‰ (Frequency Response)</h3>
                        <p>åˆ©ç”¨å·ç©å®šç†ï¼Œæˆ‘å€‘å¯ä»¥å°‡ä¸Šé¢çš„å¼å­è½‰åˆ°é »åŸŸï¼š</p>
                        <div class="math-block">$$Y(\\omega) = X(\\omega) \\cdot H(\\omega)$$</div>
                        <p>é€™è£¡çš„ $H(\\omega)$ å°±æ˜¯ $h(t)$ çš„å‚…ç«‹è‘‰è®Šæ›ï¼Œç¨±ç‚ºé »ç‡éŸ¿æ‡‰ã€‚</p>
                        <p>é€™è®“æˆ‘å€‘å¯ä»¥è¨­è¨ˆã€Œæ¿¾æ³¢å™¨ã€ï¼š</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li>æƒ³æ¿¾æ‰é«˜é »é›œè¨Šï¼Ÿåªè¦è®“ $H(\\omega)$ åœ¨é«˜é »æ™‚ç‚º 0ã€‚</li>
                            <li>æƒ³å¢å¼·ä½éŸ³ï¼Ÿåªè¦è®“ $H(\\omega)$ åœ¨ä½é »æ™‚è®Šå¤§ã€‚</li>
                        </ul>
                        <p>æˆ‘å€‘åªéœ€è¦è¨­è¨ˆ $H(\\omega)$ï¼ˆä¹˜æ³•ï¼‰ï¼Œè€Œä¸éœ€è¦å»è§£è¤‡é›œçš„å¾®åˆ†æ–¹ç¨‹ï¼ˆå·ç©ï¼‰ã€‚</p>

                        <h3>èª²å¾Œç·´ç¿’ (Calculus Problem)</h3>
                        <p>æˆ‘å€‘ä¾†è¦ªè‡ªæ“ä½œä¸€æ¬¡ã€Œå·ç©ã€çš„ç©åˆ†ï¼Œé«”é©—å®ƒçš„å¹¾ä½•æ„ç¾©ï¼Œé€™æ¨£ä½ æœƒæ›´æ„Ÿè¬å‚…ç«‹è‘‰è®Šæ›å¸¶ä¾†çš„ç°¡åŒ–ã€‚</p>
                        <div class="bg-white/5 p-4 rounded-lg border border-white/10 my-4">
                            <h4 class="text-white font-bold mb-2">é¡Œç›®ï¼šçŸ©å½¢æ³¢çš„è‡ªå·ç©</h4>
                            <p class="text-gray-300">è¨­æœ‰ä¸€çŸ©å½¢è„ˆè¡å‡½æ•¸ (Gate function) $f(t)$ å®šç¾©å¦‚ä¸‹ï¼š</p>
                            <div class="math-block">
                                $$f(t) = \\begin{cases} 
                                1, & -0.5 \\le t \\le 0.5 \\\\
                                0, & \\text{å…¶ä»–}
                                \\end{cases}$$
                            </div>
                            <p class="text-gray-300">è«‹è¨ˆç®— $y(t) = (f * f)(t)$ çš„è§£æå¼ï¼Œä¸¦æè¿°å…¶åœ–å½¢å½¢ç‹€ã€‚</p>
                            <p class="text-xs text-gray-500 mt-2">(æç¤ºï¼šé€™æ¶‰åŠã€Œåˆ†æ®µç©åˆ†ã€ï¼Œä½ éœ€è¦æ ¹æ“šå…©å€‹æ–¹å¡Šé‡ç–Šçš„ç¨‹åº¦ä¾†åŠƒåˆ† $t$ çš„å€é–“ã€‚)</p>
                        </div>

                        <h3>ç·´ç¿’é¡Œè§£ç­”</h3>
                        <p class="text-xs text-gray-500 mb-2">(é»æ“Šä¸‹æ–¹å€åŸŸæŸ¥çœ‹è©³ç´°è¨ˆç®—éç¨‹)</p>
                        <div class="spoiler-blur" onclick="this.classList.add('revealed')">
                            <h4 class="text-white font-bold mt-0">é¡Œç›®ï¼šè¨ˆç®—çŸ©å½¢æ³¢ $f(t)$ çš„è‡ªå·ç© $y(t) = f(t) * f(t)$</h4>
                            
                            <p><strong>1. è¨­å®šç©åˆ†å¼</strong></p>
                            <p>æ ¹æ“šå®šç¾©ï¼š$$y(t) = \\int_{-\\infty}^{\\infty} f(\\tau) f(t - \\tau) \\, d\\tau$$</p>
                            <p>ç”±æ–¼ $f(\\tau)$ åƒ…åœ¨ $[-0.5, 0.5]$ ç‚º 1ï¼Œç©åˆ†ç¯„åœç¸®å°ç‚ºï¼š</p>
                            <div class="math-block">$$y(t) = \\int_{-0.5}^{0.5} 1 \\cdot f(t - \\tau) \\, d\\tau$$</div>
                            <p>é€™è£¡çš„è¢«ç©å‡½æ•¸ $f(t-\\tau)$ ä»£è¡¨ä¸€å€‹ä¸­å¿ƒåœ¨ $t$ã€å¯¬åº¦ç‚º 1 çš„çŸ©å½¢çª—ï¼ˆç¯„åœæ˜¯ $[t-0.5, t+0.5]$ï¼‰ã€‚æˆ‘å€‘éœ€è¦è¨ˆç®—é€™å…©å€‹å€é–“ $[-0.5, 0.5]$ å’Œ $[t-0.5, t+0.5]$ çš„é‡ç–Šé•·åº¦ã€‚</p>

                            <p class="mt-4"><strong>2. åˆ†æ®µè¨è«–</strong></p>
                            <p>æˆ‘å€‘ç§»å‹• $t$ ä¾†è§€å¯Ÿé‡ç–Šæƒ…æ³ï¼š</p>
                            
                            <ul class="list-disc pl-6 text-gray-300 space-y-2">
                                <li><strong>æƒ…æ³ Aï¼šå®Œå…¨ä¸é‡ç–Š ($t < -1$)</strong><br>
                                å€é–“ $[t-0.5, t+0.5]$ å®Œå…¨åœ¨ $[-0.5, 0.5]$ çš„å·¦é‚Šã€‚<br>
                                é‡ç–Šé•·åº¦ = 0ã€‚<br>
                                $$y(t) = 0$$</li>

                                <li><strong>æƒ…æ³ Bï¼šéƒ¨åˆ†é‡ç–Šï¼Œé€²å…¥éšæ®µ ($-1 \\le t < 0$)</strong><br>
                                å³é‚Šç•Œ $t+0.5$ é€²å…¥äº† $[-0.5, 0.5]$ï¼Œä½†å·¦é‚Šç•Œé‚„åœ¨å¤–é¢ã€‚<br>
                                é‡ç–Šå€é–“ç‚º $[-0.5, t+0.5]$ã€‚<br>
                                $$y(t) = \\int_{-0.5}^{t+0.5} 1 \\, d\\tau = (t+0.5) - (-0.5) = t + 1$$</li>

                                <li><strong>æƒ…æ³ Cï¼šéƒ¨åˆ†é‡ç–Šï¼Œé›¢é–‹éšæ®µ ($0 \\le t < 1$)</strong><br>
                                å³é‚Šç•Œ $t+0.5$ å·²ç¶“è¶…å‡ºäº† $0.5$ï¼Œå·¦é‚Šç•Œ $t-0.5$ é€²å…¥äº† $[-0.5, 0.5]$ã€‚<br>
                                é‡ç–Šå€é–“ç‚º $[t-0.5, 0.5]$ã€‚<br>
                                $$y(t) = \\int_{t-0.5}^{0.5} 1 \\, d\\tau = 0.5 - (t-0.5) = 1 - t$$</li>

                                <li><strong>æƒ…æ³ Dï¼šå®Œå…¨ä¸é‡ç–Š ($t \\ge 1$)</strong><br>
                                å€é–“ $[t-0.5, t+0.5]$ å®Œå…¨åœ¨ $[-0.5, 0.5]$ çš„å³é‚Šã€‚<br>
                                é‡ç–Šé•·åº¦ = 0ã€‚<br>
                                $$y(t) = 0$$</li>
                            </ul>

                            <p class="mt-4"><strong>3. çµè«–</strong></p>
                            <div class="math-block">
                                $$y(t) = \\begin{cases} 
                                t + 1, & -1 \\le t < 0 \\\\
                                1 - t, & 0 \\le t < 1 \\\\
                                0, & \\text{å…¶ä»–}
                                \\end{cases}$$
                            </div>
                            <p>æˆ–è€…å¯«æˆç²¾ç°¡å½¢å¼ï¼š</p>
                            <div class="math-block">$$y(t) = \\max(0, 1 - |t|)$$</div>
                            
                            <p class="mt-4 text-white font-bold">åœ–å½¢æè¿°ï¼š</p>
                            <p>é€™æ˜¯ä¸€å€‹ä¸‰è§’å½¢å‡½æ•¸ (Triangle Function)ã€‚å…©å€‹çŸ©å½¢æ³¢å·ç©ï¼Œæœƒç”¢ç”Ÿä¸€å€‹ä¸‰è§’å½¢æ³¢ã€‚é€™å±•ç¤ºäº†å·ç©å…·æœ‰ã€Œå¹³æ»‘åŒ–ã€è¨Šè™Ÿçš„æ•ˆæœï¼ˆå¾ä¸é€£çºŒçš„æ–¹æ³¢è®Šæˆäº†é€£çºŒçš„ä¸‰è§’æ³¢ï¼‰ã€‚</p>
                        </div>
                    </div>`
            },
5: {
                title: "èƒ½é‡å®ˆæ†èˆ‡å»£ç¾©å‡½æ•¸ (Energy & Distributions)",
                content: `
                    <div class="lesson-body">
                        <p>é€™å ‚èª²æ˜¯æ•¸å­¸åˆ†æä¸Šçš„ã€Œèµ°é‹¼ç´¢ã€ã€‚</p>
                        <p>åœ¨å‰å¹¾èª²ï¼Œæˆ‘å€‘å·å·è¿´é¿äº†ä¸€äº›å°·å°¬çš„å•é¡Œã€‚ä¾‹å¦‚ï¼š$\\cos(t)$ çš„å‚…ç«‹è‘‰è®Šæ›æ˜¯ä»€éº¼ï¼Ÿ</p>
                        <p>å¦‚æœä½ ç›´æ¥æŠŠ $\\cos(t)$ ä»£å…¥ç©åˆ†å…¬å¼ $\\int_{-\\infty}^{\\infty} \\cos(t) e^{-i\\omega t} dt$ï¼Œä½ æœƒç™¼ç¾ç©åˆ†ä¸æ”¶æ–‚ï¼ˆå®ƒæ°¸é éœ‡ç›ªï¼Œé¢ç©ç„¡æ³•è¨ˆç®—ï¼‰ã€‚</p>
                        <p>ç‚ºäº†è™•ç†é€™äº›ç‰©ç†ä¸ŠçœŸå¯¦å­˜åœ¨ã€ä½†æ•¸å­¸ä¸Šã€Œä¸ä¹–ã€çš„è¨Šè™Ÿï¼Œæˆ‘å€‘éœ€è¦å¼•å…¥ä¸€å€‹å¼·å¤§çš„å·¥å…·â€”â€”å»£ç¾©å‡½æ•¸ï¼ˆDistributionsï¼‰ï¼Œä»¥åŠä¸€å€‹ç‰©ç†éµå¾‹â€”â€”èƒ½é‡å®ˆæ†ã€‚</p>

                        <h3>1. å¸•å¡ç“¦çˆ¾å®šç† (Parseval's Theorem)</h3>
                        <p>é€™æ˜¯å‚…ç«‹è‘‰è®Šæ›ä¸­æœ€ä»¤äººå®‰å¿ƒçš„å®šç†ã€‚å®ƒå‘Šè¨´æˆ‘å€‘ï¼šç„¡è«–ä½ åœ¨å“ªå€‹å®‡å®™ï¼ˆæ™‚åŸŸæˆ–é »åŸŸï¼‰ï¼Œç¸½èƒ½é‡æ˜¯ä¸è®Šçš„ã€‚</p>
                        <p>å°æ–¼è¨Šè™Ÿ $f(t)$ï¼Œå…¶ç¸½èƒ½é‡ $E$ å®šç¾©ç‚ºæŒ¯å¹…å¹³æ–¹çš„ç©åˆ†ï¼š</p>
                        <div class="math-block">$$E = \\int_{-\\infty}^{\\infty} |f(t)|^2 \\, dt$$</div>
                        <p><strong>å®šç†æ•˜è¿°ï¼š</strong>æ™‚åŸŸçš„èƒ½é‡ç©åˆ†ç­‰æ–¼é »åŸŸçš„èƒ½é‡ç©åˆ†ï¼ˆå·®ä¸€å€‹ä¿‚æ•¸ $1/2\\pi$ï¼‰ï¼š</p>
                        <div class="math-block">$$\\int_{-\\infty}^{\\infty} |f(t)|^2 \\, dt = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} |F(\\omega)|^2 \\, d\\omega$$</div>
                        <p><strong>å“²å­¸æ„ç¾©ï¼š</strong>è¨Šè™Ÿçš„ã€Œæœ¬é«”ã€åœ¨è®Šæ›éç¨‹ä¸­æ²’æœ‰æå¤±ã€‚é€™çµ¦äº†æˆ‘å€‘è¨ˆç®—è¤‡é›œç©åˆ†çš„æ·å¾‘ã€‚æœ‰æ™‚å€™ $\\int f(t)^2$ å¾ˆé›£ç®—ï¼Œä½†å®ƒçš„é »è­œ $F(\\omega)$ æ˜¯ä¸€å€‹ç°¡å–®çš„çŸ©å½¢ï¼Œç®— $\\int F(\\omega)^2$ å°±ç§’æ®ºäº†ã€‚</p>

                        <h3>2. æ•¸å­¸æ€ªç¸ï¼šç‹„æ‹‰å…‹ $\\delta$ å‡½æ•¸ (Dirac Delta Function)</h3>
                        <p>ç‚ºäº†è§£æ±º $\\cos(t)$ æˆ–å¸¸æ•¸ $1$ çš„ç©åˆ†ç™¼æ•£å•é¡Œï¼Œç‰©ç†å­¸å®¶ç‹„æ‹‰å…‹ï¼ˆPaul Diracï¼‰ç™¼æ˜äº†ä¸€å€‹å¥‡ç‰¹çš„å°è±¡ $\\delta(t)$ã€‚</p>
                        <p><strong>ç›´è§€å®šç¾©ï¼š</strong>ä¸€å€‹å¯¬åº¦ç‚º 0ï¼Œé«˜åº¦ç‚º $\\infty$ï¼Œä½†ç¸½é¢ç©ç‚º 1 çš„è„ˆè¡ã€‚</p>
                        <div class="math-block">$$ \\delta(t) = \\begin{cases} \\infty, & t = 0 \\\\ 0, & t \\neq 0 \\end{cases}, \\quad \\int_{-\\infty}^{\\infty} \\delta(t) \\, dt = 1$$</div>
                        <p><strong>ç¯©é¸æ€§è³ª (Sifting Property)ï¼š</strong> $\\delta(t)$ åƒä¸€æ”¯æ¢é‡ã€‚ç•¶å®ƒèˆ‡å‡½æ•¸ $f(t)$ ç›¸ä¹˜ä¸¦ç©åˆ†æ™‚ï¼Œå®ƒæœƒã€ŒæŠ“å‡ºã€ $t=0$ è™•çš„å€¼ï¼š</p>
                        <div class="math-block">$$\\int_{-\\infty}^{\\infty} f(t) \\delta(t) \\, dt = f(0)$$</div>
                        <p>æ›´ä¸€èˆ¬åœ°ï¼š</p>
                        <div class="math-block">$$\\int_{-\\infty}^{\\infty} f(t) \\delta(t - t_0) \\, dt = f(t_0)$$</div>
                        <p>åš´æ ¼ä¾†èªªï¼šå®ƒä¸æ˜¯ä¸€å€‹å‡½æ•¸ï¼Œè€Œæ˜¯ä¸€å€‹ã€Œåˆ†ä½ˆã€æˆ–ã€Œå»£ç¾©å‡½æ•¸ã€ã€‚å®ƒåªæœ‰åœ¨ç©åˆ†è™Ÿè£¡é¢æ‰æœ‰æ„ç¾©ã€‚</p>

                        <h3>3. å»£ç¾©å‚…ç«‹è‘‰è®Šæ›</h3>
                        <p>æœ‰äº† $\\delta$ å‡½æ•¸ï¼Œæˆ‘å€‘çµ‚æ–¼å¯ä»¥è™•ç†é‚£äº›åŸæœ¬ç©åˆ†ç™¼æ•£çš„è¨Šè™Ÿäº†ã€‚</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li><strong>(1) è„ˆè¡çš„è®Šæ›ï¼š</strong>å¦‚æœ $f(t) = \\delta(t)$ï¼ˆæ™‚åŸŸæ¥µåº¦é›†ä¸­ï¼‰ï¼š
                                <div class="math-block">$$F(\\omega) = \\int_{-\\infty}^{\\infty} \\delta(t) e^{-i\\omega t} \\, dt = e^{-i\\omega \\cdot 0} = 1$$</div>
                                <strong>çµè«–ï¼š</strong>é »è­œæ˜¯å¸¸æ•¸ $1$ã€‚ä¸€å€‹ç¬é–“çš„è„ˆè¡åŒ…å«äº†æ‰€æœ‰é »ç‡ï¼Œä¸”å¼·åº¦ç›¸ç­‰ã€‚ï¼ˆé€™å°±æ˜¯ç‚ºä»€éº¼éŸ³éŸ¿æ¸¬è©¦è¦ç”¨è„ˆè¡éŸ³ï¼Œæˆ–è€…æ‹æ‰‹è²ï¼‰ã€‚
                            </li>
                            <li><strong>(2) å¸¸æ•¸çš„è®Šæ›ï¼š</strong>å¦‚æœ $f(t) = 1$ï¼ˆæ™‚åŸŸå®Œå…¨ä¸è®Šï¼‰ï¼šåˆ©ç”¨å°å¶æ€§ï¼Œå…¶é »è­œå¿…ç„¶æ˜¯ $\\delta$ å‡½æ•¸ã€‚
                                <div class="math-block">$$F(\\omega) = 2\\pi \\delta(\\omega)$$</div>
                                <strong>çµè«–ï¼š</strong>èƒ½é‡å®Œå…¨é›†ä¸­åœ¨ $\\omega = 0$ï¼ˆç›´æµé›»ï¼‰ã€‚
                            </li>
                            <li><strong>(3) é€±æœŸå‡½æ•¸çš„è®Šæ›ï¼š</strong>ç¾åœ¨æˆ‘å€‘å¯ä»¥å›ç­” $\\cos(\\omega_0 t)$ çš„è®Šæ›æ˜¯ä»€éº¼äº†ã€‚æ ¹æ“šæ­æ‹‰å…¬å¼ $\\cos(\\omega_0 t) = \\frac{e^{i\\omega_0 t} + e^{-i\\omega_0 t}}{2}$ã€‚åˆ©ç”¨ä½ç§»æ€§è³ªï¼Œè¤‡æ•¸æŒ‡æ•¸ $e^{i\\omega_0 t}$ çš„å‚…ç«‹è‘‰è®Šæ›æ˜¯ $2\\pi \\delta(\\omega - \\omega_0)$ã€‚æ‰€ä»¥ï¼š
                                <div class="math-block">$$\\mathcal{F}\\{\\cos(\\omega_0 t)\\} = \\pi [\\delta(\\omega - \\omega_0) + \\delta(\\omega + \\omega_0)]$$</div>
                                <strong>å¹¾ä½•æ„ç¾©ï¼š</strong>é¤˜å¼¦æ³¢åœ¨é »è­œä¸Šå°±æ˜¯å…©æ ¹æŸ±å­ï¼Œåˆ†åˆ¥ä½æ–¼ $\\pm \\omega_0$ã€‚é€™å°‡ã€Œå‚…ç«‹è‘‰ç´šæ•¸ã€ï¼ˆé›¢æ•£é »è­œï¼‰èˆ‡ã€Œå‚…ç«‹è‘‰è®Šæ›ã€ï¼ˆé€£çºŒé »è­œï¼‰çµ±ä¸€èµ·ä¾†äº†â€”â€”ç´šæ•¸å…¶å¯¦å°±æ˜¯è®Šæ›åœ¨é »åŸŸä¸Šçš„ $\\delta$ å‡½æ•¸é™£åˆ—ã€‚
                            </li>
                        </ul>

                        <h3>èª²å¾Œç·´ç¿’ (Calculus Problem)</h3>
                        <div class="bg-white/5 p-4 rounded-lg border border-white/10 my-4">
                            <h4 class="text-white font-bold mb-2">é¡Œç›®ï¼šåˆ©ç”¨èƒ½é‡å®ˆæ†è¨ˆç®— Sinc å‡½æ•¸çš„ç©åˆ†</h4>
                            <p class="text-gray-300">é€™é¡Œæ˜¯å¸•å¡ç“¦çˆ¾å®šç†çš„ç¶“å…¸æ‡‰ç”¨ã€‚å¦‚æœç›´æ¥ç”¨å¾®ç©åˆ†è¨ˆç®—å·¦å¼æ¥µç‚ºå›°é›£ï¼Œä½†åˆ©ç”¨èƒ½é‡å®ˆæ†ï¼Œè½‰åˆ°é »åŸŸå»ç®—çŸ©å½¢é¢ç©å‰‡æ˜“å¦‚åæŒã€‚</p>
                            <p class="text-gray-300 mt-2">è«‹åˆ©ç”¨å¸•å¡ç“¦çˆ¾å®šç†ï¼Œè¨ˆç®—ä¸‹åˆ—å®šç©åˆ†çš„å€¼ï¼š</p>
                            <div class="math-block">$$I = \\int_{-\\infty}^{\\infty} \\left( \\frac{\\sin t}{t} \\right)^2 \\, dt$$</div>
                            <p class="text-xs text-gray-500 mt-2">(æç¤ºï¼šå›æƒ³ç¬¬ 3 èª²ï¼ŒçŸ©å½¢æ³¢ $\\text{rect}(t)$ çš„å‚…ç«‹è‘‰è®Šæ›æ˜¯ Sinc å½¢å¼ã€‚ä½ å¯ä»¥åéä¾†è¨­ $f(t)$ æˆ– $F(\\omega)$ ç‚ºçŸ©å½¢æ³¢ä¾†æ§‹é€ é€™å€‹ç­‰å¼ã€‚)</p>
                        </div>

                        <h3>ç·´ç¿’é¡Œè§£ç­”</h3>
                        <p class="text-xs text-gray-500 mb-2">(é»æ“Šä¸‹æ–¹å€åŸŸæŸ¥çœ‹è©³ç´°è¨ˆç®—éç¨‹)</p>
                        <div class="spoiler-blur" onclick="this.classList.add('revealed')">
                            <h4 class="text-white font-bold mt-0">1. ç­–ç•¥åˆ†æ</h4>
                            <p>ç›´æ¥ç©åˆ† $\\frac{\\sin^2 t}{t^2}$ éœ€è¦è¤‡é›œçš„è¤‡è®Šæ®˜å€¼å®šç†æˆ–å¾®åˆ†æŠ€å·§ã€‚</p>
                            <p>åˆ©ç”¨å¸•å¡ç“¦çˆ¾å®šç†ï¼š$\\int |f(t)|^2 dt = \\frac{1}{2\\pi} \\int |F(\\omega)|^2 d\\omega$ã€‚</p>
                            <p>æˆ‘å€‘éœ€è¦æ‰¾åˆ°ä¸€å€‹å‡½æ•¸ï¼Œå…¶è®Šæ›å°çš„ä¸€ç«¯æ˜¯ $\\frac{\\sin t}{t}$ (Sinc å‡½æ•¸)ï¼Œå¦ä¸€ç«¯æ˜¯ç°¡å–®çš„å¹¾ä½•åœ–å½¢ï¼ˆå¦‚çŸ©å½¢ï¼‰ã€‚</p>

                            <h4 class="text-white font-bold mt-4">2. å»ºç«‹è®Šæ›å°</h4>
                            <p>å›æ†¶ç¬¬ 3 èª²çš„çŸ©å½¢æ³¢ã€‚è®“æˆ‘å€‘å®šç¾©ä¸€å€‹é »åŸŸçš„çŸ©å½¢çª—å‡½æ•¸ï¼ˆä½é€šæ¿¾æ³¢å™¨ï¼‰ï¼š</p>
                            <p>è¨­ $X(\\omega)$ ç‚ºä¸€å€‹çŸ©å½¢å‡½æ•¸ï¼š</p>
                            <div class="math-block">$$X(\\omega) = \\begin{cases} 1, & |\\omega| < 1 \\\\ 0, & |\\omega| > 1 \\end{cases}$$</div>
                            <p>æ±‚å…¶é€†å‚…ç«‹è‘‰è®Šæ› $x(t)$ï¼š</p>
                            <div class="math-block">
                                $$x(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} X(\\omega) e^{i\\omega t} \\, d\\omega = \\frac{1}{2\\pi} \\int_{-1}^{1} 1 \\cdot e^{i\\omega t} \\, d\\omega$$
                                $$x(t) = \\frac{1}{2\\pi} \\left[ \\frac{e^{i\\omega t}}{it} \\right]_{-1}^{1} = \\frac{1}{2\\pi it} (e^{it} - e^{-it})$$
                            </div>
                            <p>åˆ©ç”¨ $\\sin t = \\frac{e^{it} - e^{-it}}{2i}$ï¼š</p>
                            <div class="math-block">$$x(t) = \\frac{1}{\\pi t} \\sin t = \\frac{\\sin t}{\\pi t}$$</div>

                            <h4 class="text-white font-bold mt-4">3. æ‡‰ç”¨å¸•å¡ç“¦çˆ¾å®šç†</h4>
                            <p>ç¾åœ¨æˆ‘å€‘æœ‰äº†è®Šæ›å°ï¼š$x(t) = \\frac{\\sin t}{\\pi t} \\iff X(\\omega) = \\text{rect}(\\frac{\\omega}{2})$</p>
                            <p>å¸•å¡ç“¦çˆ¾å®šç†å…¬å¼ï¼š</p>
                            <div class="math-block">$$\\int_{-\\infty}^{\\infty} |x(t)|^2 \\, dt = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} |X(\\omega)|^2 \\, d\\omega$$</div>
                            <p>ä»£å…¥æˆ‘å€‘çš„å‡½æ•¸ï¼š</p>
                            <div class="math-block">$$\\int_{-\\infty}^{\\infty} \\left| \\frac{\\sin t}{\\pi t} \\right|^2 \\, dt = \\frac{1}{2\\pi} \\int_{-1}^{1} |1|^2 \\, d\\omega$$</div>

                            <h4 class="text-white font-bold mt-4">4. è¨ˆç®—</h4>
                            <p>å·¦å¼ï¼ˆæå‡ºå¸¸æ•¸ $\\frac{1}{\\pi^2}$ï¼‰ï¼š</p>
                            <div class="math-block">$$\\frac{1}{\\pi^2} \\int_{-\\infty}^{\\infty} \\frac{\\sin^2 t}{t^2} \\, dt$$</div>
                            <p>å³å¼ï¼ˆç°¡å–®çš„çŸ©å½¢é¢ç©ï¼‰ï¼š</p>
                            <div class="math-block">$$\\frac{1}{2\\pi} \\times (\\text{å€é–“é•·åº¦ } 2) = \\frac{1}{2\\pi} \\times 2 = \\frac{1}{\\pi}$$</div>
                            <p>è®“å…©é‚Šç›¸ç­‰ï¼š</p>
                            <div class="math-block">$$\\frac{1}{\\pi^2} I = \\frac{1}{\\pi}$$</div>
                            <p>è§£å‡º $I$ï¼š</p>
                            <div class="math-block">$$I = \\frac{1}{\\pi} \\times \\pi^2 = \\pi$$</div>
                            
                            <div class="highlight">
                                <p><strong>ç­”æ¡ˆï¼š</strong></p>
                                <div class="math-block">$$\\int_{-\\infty}^{\\infty} \\left( \\frac{\\sin t}{t} \\right)^2 \\, dt = \\pi$$</div>
                            </div>
                        </div>
                    </div>`
            },
6: {
                title: "å–æ¨£å®šç†èˆ‡é›¢æ•£åŒ– (The Sampling Theorem)",
                content: `
                    <div class="lesson-body">
                        <p>é€™å ‚èª²æ˜¯é€šå¾€ã€Œæ•¸ä½ä¸–ç•Œã€çš„å¤§é–€ã€‚</p>
                        <p>åœ¨å‰äº”èª²ï¼Œæˆ‘å€‘çš„æ•¸å­¸éƒ½ç™¼ç”Ÿåœ¨å®Œç¾çš„é€£çºŒä¸–ç•Œï¼ˆContinuous Worldï¼‰ã€‚æ‰€æœ‰çš„å‡½æ•¸ $f(t)$ å°æ–¼ä»»æ„å¾®å°çš„ $t$ éƒ½æœ‰å®šç¾©ã€‚</p>
                        <p>ä½†åœ¨é›»è…¦ç§‘å­¸èˆ‡ç¾ä»£å·¥ç¨‹ä¸­ï¼Œæˆ‘å€‘ç„¡æ³•å„²å­˜ç„¡é™çš„è³‡è¨Šã€‚æˆ‘å€‘å¿…é ˆå–æ¨£ï¼ˆSamplingï¼‰ã€‚é€™å ‚èª²å°‡æ­ç¤ºï¼šç•¶æˆ‘å€‘æŠŠé€£çºŒè¨Šè™Ÿåˆ‡æˆç¢ç‰‡æ™‚ï¼Œé »è­œç™¼ç”Ÿäº†ä»€éº¼åŠ‡è®Šï¼Ÿ</p>

                        <h3>1. æ•¸å­¸å·¥å…·ï¼šç‹„æ‹‰å…‹æ¢³ç‹€å‡½æ•¸ (Dirac Comb)</h3>
                        <p>æˆ‘å€‘å¦‚ä½•ç”¨æ•¸å­¸æè¿°ã€Œæ¯éš” $T$ ç§’æ‹ä¸€å¼µç…§ç‰‡ã€é€™å€‹å‹•ä½œï¼Ÿ</p>
                        <p>æˆ‘å€‘ä½¿ç”¨ä¸€é€£ä¸²çš„ $\\delta$ è„ˆè¡ï¼Œæ’æˆåƒæ¢³å­ä¸€æ¨£çš„å½¢ç‹€ï¼Œç¨±ç‚ºè„ˆè¡åˆ—æˆ–ç‹„æ‹‰å…‹æ¢³ç‹€å‡½æ•¸ $s(t)$ï¼š</p>
                        <div class="math-block">$$s(t) = \\sum_{n=-\\infty}^{\\infty} \\delta(t - nT)$$</div>
                        <p><strong>å–æ¨£æ“ä½œï¼š</strong>å°‡åŸæœ¬é€£çºŒçš„è¨Šè™Ÿ $x(t)$ èˆ‡é€™æŠŠæ¢³å­ç›¸ä¹˜ã€‚æ ¹æ“šç¯©é¸æ€§è³ªï¼Œçµæœ $x_s(t)$ åªä¿ç•™äº† $t = nT$ æ™‚åˆ»çš„æ•¸å€¼ï¼Œå…¶ä»–åœ°æ–¹éƒ½æ˜¯ 0ã€‚</p>
                        <div class="math-block">$$x_s(t) = x(t) \\cdot s(t) = \\sum_{n=-\\infty}^{\\infty} x(nT) \\delta(t - nT)$$</div>

                        <h3>2. é »è­œè¤‡è£½ (Spectral Replication)</h3>
                        <p>é€™æ˜¯å‚…ç«‹è‘‰è®Šæ›æœ€ç¥å¥‡çš„æ™‚åˆ»ä¹‹ä¸€ã€‚æˆ‘å€‘æƒ³çŸ¥é“å–æ¨£å¾Œçš„è¨Šè™Ÿ $x_s(t)$ åœ¨é »åŸŸé•·ä»€éº¼æ¨£ï¼Ÿ</p>
                        <p>åˆ©ç”¨ç¬¬ 4 èª²çš„å·ç©å®šç†ï¼šæ™‚åŸŸçš„ä¹˜ç©ç­‰æ–¼é »åŸŸçš„å·ç©ã€‚</p>
                        <div class="math-block">$$\\mathcal{F}\\{x(t) \\cdot s(t)\\} = \\frac{1}{2\\pi} X(\\omega) * S(\\omega)$$</div>
                        <p>é—œéµåœ¨æ–¼ï¼šæ¢³ç‹€å‡½æ•¸çš„å‚…ç«‹è‘‰è®Šæ›ï¼Œé‚„æ˜¯ä¸€æŠŠæ¢³ç‹€å‡½æ•¸ï¼ï¼ˆé€±æœŸäº’ç‚ºå€’æ•¸ï¼‰</p>
                        <div class="math-block">$$S(\\omega) = \\frac{2\\pi}{T} \\sum_{k=-\\infty}^{\\infty} \\delta\\left(\\omega - k \\frac{2\\pi}{T}\\right)$$</div>
                        <p>å°‡ $X(\\omega)$ èˆ‡é€™æŠŠé »åŸŸæ¢³å­åšå·ç©ï¼Œæ•ˆæœå°±æ˜¯æŠŠ $X(\\omega)$ çš„åœ–å½¢è¤‡è£½ä¸¦å¹³ç§»åˆ°æ¯ä¸€å€‹æ¢³é½’çš„ä½ç½®ä¸Šã€‚</p>
                        <div class="math-block">$$X_s(\\omega) = \\frac{1}{T} \\sum_{k=-\\infty}^{\\infty} X(\\omega - k \\omega_s)$$</div>
                        <p>(å…¶ä¸­ $\\omega_s = \\frac{2\\pi}{T}$ ç‚ºå–æ¨£è§’é »ç‡)</p>
                        <div class="highlight">
                            <p><strong>çµè«–ï¼šå–æ¨£å°è‡´é »è­œé€±æœŸæ€§è¤‡è£½ã€‚</strong></p>
                            <p>é€™æ˜¯æ•¸ä½è¨Šè™Ÿè™•ç†æœ€æ ¸å¿ƒçš„åœ–åƒã€‚åŸæœ¬åªæœ‰ä¸€å€‹æ³¢å³°çš„é »è­œï¼Œç¾åœ¨è®Šæˆäº†ç„¡çª®å¤šå€‹æ’åˆ—åœ¨ä¸€èµ·çš„æ³¢å³°ã€‚</p>
                        </div>

                        <h3>3. å¥ˆå¥æ–¯ç‰¹-é¦™è¾²å–æ¨£å®šç†</h3>
                        <p>ç½é›£çš„æ ¹æºå°±åœ¨ã€Œè¤‡è£½ã€ã€‚å¦‚æœåŸå§‹é »è­œ $X(\\omega)$ å¤ªå¯¬ï¼Œæˆ–è€…å–æ¨£é »ç‡ $\\omega_s$ å¤ªä½ï¼ˆæ¢³é½’é–“éš”å¤ªçª„ï¼‰ï¼Œé‚£éº¼è¤‡è£½å‡ºä¾†çš„é »è­œæ³¢å³°å°±æœƒäº’ç›¸é‡ç–Šï¼ˆOverlapï¼‰ã€‚</p>
                        <p>é€™å°±æ˜¯<strong>æ··ç–Š (Aliasing)</strong>ã€‚ä¸€æ—¦é‡ç–Šï¼Œé«˜é »è³‡è¨Šå°±æœƒæ±¡æŸ“ä½é »è³‡è¨Šï¼Œæˆ‘å€‘å°±å†ä¹Ÿç„¡æ³•æŠŠåŸå§‹è¨Šè™Ÿåˆ†é–‹äº†ã€‚</p>
                        <p>ç‚ºäº†é¿å…é‡ç–Šï¼Œè¤‡è£½ä¸­å¿ƒé»çš„è·é›¢ $\\omega_s$ å¿…é ˆå¤§æ–¼é »è­œå¯¬åº¦ $2\\omega_{max}$ã€‚</p>
                        <p>é€™å°±æ˜¯è‘—åçš„å¥ˆå¥æ–¯ç‰¹æ¢ä»¶ï¼š</p>
                        <div class="math-block">$$f_s > 2 f_{max}$$</div>
                        <p>(å–æ¨£é »ç‡å¿…é ˆå¤§æ–¼è¨Šè™Ÿæœ€é«˜é »ç‡çš„å…©å€)</p>

                        <h3>4. é‡å»ºï¼šç†æƒ³é‡å»ºå…¬å¼</h3>
                        <p>å¦‚æœæ»¿è¶³äº†å¥ˆå¥æ–¯ç‰¹æ¢ä»¶ï¼Œé »è­œæ²’æœ‰é‡ç–Šï¼Œæˆ‘å€‘å¦‚ä½•è®Šå›åŸæœ¬çš„é€£çºŒè¨Šè™Ÿï¼Ÿ</p>
                        <p>åªè¦åœ¨é »åŸŸä¹˜ä¸Šä¸€å€‹ç†æƒ³ä½é€šæ¿¾æ³¢å™¨ï¼ˆçŸ©å½¢çª—ï¼‰ï¼ŒæŠŠå¤šé¤˜çš„è¤‡è£½å“åˆ‡æ‰ï¼Œåªä¿ç•™ä¸­é–“åŸæœ¬çš„ $X(\\omega)$ã€‚</p>
                        <p>å›æƒ³ç¬¬ 3 èª²ï¼šé »åŸŸçš„çŸ©å½¢ä¹˜æ³• = æ™‚åŸŸçš„ Sinc å‡½æ•¸å·ç©ã€‚é€™å°å‡ºäº†å®Œç¾çš„é‡å»ºå…¬å¼ï¼š</p>
                        <div class="math-block">$$x(t) = \\sum_{n=-\\infty}^{\\infty} x[n] \\cdot \\text{sinc}\\left( \\frac{t - nT}{T} \\right)$$</div>
                        <p>é€™åœ¨å“²å­¸ä¸Šå¾ˆé©šäººï¼šåªè¦å–æ¨£å¤ å¿«ï¼Œé€é Sinc å‡½æ•¸æ’å€¼ï¼Œæˆ‘å€‘å¯ä»¥æ¯«ç„¡èª¤å·®åœ°çŒœå‡ºå–æ¨£é»ä¹‹é–“åŸæœ¬æ˜¯ä»€éº¼æ¨£å­ã€‚</p>

                        <h3>èª²å¾Œç·´ç¿’ (Signal Analysis)</h3>
                        <div class="bg-white/5 p-4 rounded-lg border border-white/10 my-4">
                            <h4 class="text-white font-bold mb-2">é¡Œç›®ï¼šæ­£å¼¦æ³¢çš„æ··ç–Šé »ç‡</h4>
                            <p class="text-gray-300">æ··ç–Šç¾è±¡æœ€ç›´è§€çš„ä¾‹å­å°±æ˜¯ã€Œè»Šè¼ªæ•ˆæ‡‰ã€ï¼ˆå½±ç‰‡ä¸­çš„è»Šè¼ªçœ‹èµ·ä¾†åœ¨å€’è½‰ï¼‰ã€‚æˆ‘å€‘ä¾†ç®—ä¸€ä¸‹é€™å€‹æ•¸å­¸ç¾è±¡ã€‚</p>
                            <p class="text-gray-300 mt-2">å‡è¨­æœ‰ä¸€å€‹é€£çºŒå¼¦æ³¢è¨Šè™Ÿï¼š</p>
                            <div class="math-block">$$x(t) = \\cos(2\\pi \\cdot 100 t)$$</div>
                            <p class="text-gray-300">é€™ä»£è¡¨å®ƒçš„çœŸå¯¦é »ç‡ç‚º $f = 100 \\text{ Hz}$ã€‚</p>
                            <p class="text-gray-300">ç¾åœ¨æˆ‘å€‘ä½¿ç”¨å–æ¨£é »ç‡ $f_s = 150 \\text{ Hz}$ å°å…¶é€²è¡Œå–æ¨£ã€‚</p>
                            <ol class="list-decimal pl-6 text-gray-300 mt-2">
                                <li>è«‹å•æ­¤å–æ¨£é »ç‡æ˜¯å¦æ»¿è¶³å¥ˆå¥æ–¯ç‰¹æ¢ä»¶ï¼Ÿ</li>
                                <li>å–æ¨£å¾Œçš„é›¢æ•£è¨Šè™Ÿï¼Œåœ¨äººè€³è½èµ·ä¾†ï¼ˆæˆ–é‡å»ºå¾Œï¼‰æœƒè®Šæˆå¤šå°‘ Hz çš„ä½é »è¨Šè™Ÿï¼ˆå³æ··ç–Šé »ç‡ $f_a$ï¼‰ï¼Ÿ</li>
                            </ol>
                        </div>

                        <h3>ç·´ç¿’é¡Œè§£ç­”</h3>
                        <p class="text-xs text-gray-500 mb-2">(é»æ“Šä¸‹æ–¹å€åŸŸæŸ¥çœ‹è©³ç´°è¨ˆç®—éç¨‹)</p>
                        <div class="spoiler-blur" onclick="this.classList.add('revealed')">
                            <h4 class="text-white font-bold mt-0">1. æª¢æŸ¥å¥ˆå¥æ–¯ç‰¹æ¢ä»¶</h4>
                            <p>å¥ˆå¥æ–¯ç‰¹é »ç‡ï¼ˆNyquist Frequencyï¼‰ç‚ºå–æ¨£ç‡çš„ä¸€åŠï¼š</p>
                            <div class="math-block">$$f_{Nyquist} = \\frac{f_s}{2} = \\frac{150}{2} = 75 \\text{ Hz}$$</div>
                            <p>åŸå§‹è¨Šè™Ÿé »ç‡ $f = 100 \\text{ Hz}$ã€‚</p>
                            <p>å› ç‚º $100 > 75$ï¼Œå³ $f > f_s/2$ï¼Œæ‰€ä»¥<strong>ä¸æ»¿è¶³</strong>å¥ˆå¥æ–¯ç‰¹æ¢ä»¶ã€‚</p>
                            <p>çµè«–ï¼šæœƒç™¼ç”Ÿæ··ç–Šï¼ˆAliasingï¼‰ã€‚</p>

                            <h4 class="text-white font-bold mt-4">2. è¨ˆç®—æ··ç–Šé »ç‡</h4>
                            <p>åœ¨é »åŸŸä¸­ï¼Œå–æ¨£é€ æˆé »è­œä»¥ $f_s$ ç‚ºé€±æœŸé€²è¡Œè¤‡è£½ã€‚</p>
                            <ul class="list-disc pl-6 text-gray-300 mb-2">
                                <li>åŸå§‹é »è­œä½æ–¼ $\\pm 100$ Hzã€‚</li>
                                <li>è¤‡è£½å¾Œçš„é »è­œä¸­å¿ƒä½æ–¼ $0, \\pm 150, \\pm 300, \\dots$ Hzã€‚</li>
                            </ul>
                            <p>è®“æˆ‘å€‘çœ‹åŸæœ¬ä½æ–¼ $-100$ Hz çš„é‚£å€‹åˆ†é‡ï¼ˆè² é »ç‡ï¼‰ã€‚å®ƒè¢«è¤‡è£½å¹³ç§»äº† $+f_s (+150)$ Hzï¼š</p>
                            <div class="math-block">$$-100 + 150 = 50 \\text{ Hz}$$</div>
                            <p>æˆ–è€…çœ‹åŸæœ¬ä½æ–¼ $+100$ Hz çš„åˆ†é‡ã€‚å®ƒè¢«è¤‡è£½å¹³ç§»äº† $-f_s (-150)$ Hzï¼š</p>
                            <div class="math-block">$$100 - 150 = -50 \\text{ Hz}$$</div>
                            <p>é‡å»ºæ¿¾æ³¢å™¨åªæœƒä¿ç•™å¥ˆå¥æ–¯ç‰¹å€é–“ $[-75, 75]$ å…§çš„é »ç‡ã€‚åœ¨é€™å€‹å€é–“å…§ï¼Œç¾åœ¨å‡ºç¾äº†æ–°çš„é »ç‡åˆ†é‡ $\\pm 50$ Hzã€‚</p>
                            
                            <div class="highlight">
                                <p><strong>ç­”æ¡ˆï¼š</strong></p>
                                <ul class="list-disc pl-6 mb-0">
                                    <li>ä¸æ»¿è¶³æ¢ä»¶ã€‚</li>
                                    <li>é‡å»ºå¾Œçš„è¨Šè™Ÿé »ç‡ç‚º <strong>50 Hz</strong>ã€‚</li>
                                </ul>
                            </div>
                            <p class="text-xs text-gray-400">(ç›´è§€ç†è§£ï¼šä½ ä»¥ç‚ºä½ åœ¨éŒ„ 100 Hz çš„è²éŸ³ï¼Œä½†å› ç‚ºå–æ¨£å¤ªæ…¢ï¼Œæ’­æ”¾å‡ºä¾†è®Šæˆäº†ä½æ²‰çš„ 50 Hzã€‚é€™å°±æ˜¯é«˜é »å½è£æˆäº†ä½é »ã€‚)</p>
                        </div>
                    </div>`
            },
7: {
                title: "é›¢æ•£å‚…ç«‹è‘‰è®Šæ› (DFT) èˆ‡ FFT æ¼”ç®—æ³•",
                content: `
                    <div class="lesson-body">
                        <p>é€™å ‚èª²æ˜¯å°‡ã€Œæ•¸å­¸ç†è«–ã€è½‰åŒ–ç‚ºã€Œæ”¹è®Šä¸–ç•Œçš„ç¨‹å¼ç¢¼ã€çš„é—œéµæ™‚åˆ»ã€‚</p>
                        <p>åœ¨å‰å…­èª²ï¼Œæˆ‘å€‘è¨è«–çš„å‚…ç«‹è‘‰è®Šæ›å¤§å¤šåœç•™åœ¨ç´™ç­†è¨ˆç®—çš„å±¤é¢ã€‚ä½†åœ¨ç¾å¯¦æ‡‰ç”¨ï¼ˆMP3 å£“ç¸®ã€JPEG åœ–ç‰‡ã€5G é€šè¨Šï¼‰ä¸­ï¼Œæˆ‘å€‘è™•ç†çš„æ˜¯æœ‰é™é•·åº¦çš„æ•¸æ“šé™£åˆ—ã€‚</p>
                        <p>é›»è…¦ä¸å¯èƒ½åšç©åˆ†ï¼Œä¹Ÿä¸å¯èƒ½è™•ç†ç„¡çª®ç´šæ•¸ã€‚å®ƒåªæ‡‚åŠ æ³•å’Œä¹˜æ³•ã€‚é€™å ‚èª²æˆ‘å€‘å°‡ä»‹ç´¹å·¥ç¨‹ç•Œæœ€é‡è¦çš„æ¼”ç®—æ³•ä¹‹ä¸€ï¼šå¿«é€Ÿå‚…ç«‹è‘‰è®Šæ› (FFT)ã€‚</p>

                        <h3>1. æœ€å¾Œä¸€å¡Šæ‹¼åœ–ï¼šå¾ DTFT åˆ° DFT</h3>
                        <p>åœ¨ç¬¬ 6 èª²ï¼Œæˆ‘å€‘å°æ™‚é–“é€²è¡Œäº†å–æ¨£ï¼Œå¾—åˆ°äº†é›¢æ•£æ™‚é–“å‚…ç«‹è‘‰è®Šæ› (DTFT)ã€‚é›–ç„¶æ™‚é–“é›¢æ•£äº†ï¼Œä½†é »è­œ $X(\\omega)$ ä»ç„¶æ˜¯é€£çºŒçš„ï¼ˆé€±æœŸæ€§å‡½æ•¸ï¼‰ã€‚</p>
                        <p>é›»è…¦ç„¡æ³•å„²å­˜é€£çºŒçš„æ›²ç·šã€‚æˆ‘å€‘å¿…é ˆå°é »ç‡ä¹Ÿé€²è¡Œå–æ¨£ã€‚å¦‚æœæˆ‘å€‘åœ¨æ™‚åŸŸå–äº† $N$ å€‹é»ï¼Œæœ€è‡ªç„¶çš„å°æ‡‰å°±æ˜¯åœ¨é »åŸŸä¹Ÿå– $N$ å€‹é»ã€‚</p>
                        <p>é€™å°±èª•ç”Ÿäº† <strong>é›¢æ•£å‚…ç«‹è‘‰è®Šæ› (Discrete Fourier Transform, DFT)</strong>ã€‚</p>
                        <p>å®ƒçš„å®šç¾©ä¸å†æœ‰ç©åˆ†ï¼Œåªæœ‰æ±‚å’Œï¼š</p>
                        <div class="math-block">$$X[k] = \\sum_{n=0}^{N-1} x[n] e^{-i \\frac{2\\pi}{N} k n}, \\quad k = 0, 1, \\dots, N-1$$</div>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li>$x[n]$ï¼šæ™‚åŸŸçš„ç¬¬ $n$ å€‹æ¡æ¨£é»ã€‚</li>
                            <li>$X[k]$ï¼šé »åŸŸçš„ç¬¬ $k$ å€‹é »ç‡åˆ†é‡ï¼ˆä»£è¡¨é »ç‡ $\\omega_k = \\frac{2\\pi k}{N}$ï¼‰ã€‚</li>
                        </ul>
                        <p><strong>ç›´è§€ç†è§£ï¼š</strong>é€™å…¶å¯¦å°±æ˜¯ä¸€å€‹çŸ©é™£ä¹˜æ³•ã€‚æˆ‘å€‘ç”¨ä¸€çµ„é›¢æ•£çš„è¤‡æ•¸æ³¢å»ã€Œæ¢æ¸¬ã€åŸå§‹è¨Šè™Ÿã€‚</p>

                        <h3>2. ç·šæ€§ä»£æ•¸è¦–è§’ï¼šå–®ä½æ ¹èˆ‡çŸ©é™£</h3>
                        <p>ç‚ºäº†ç°¡åŒ–æ›¸å¯«ï¼Œæˆ‘å€‘å®šç¾© <strong>æ—‹è½‰å› å­ (Twiddle Factor)</strong> $W_N$ï¼š</p>
                        <div class="math-block">$$W_N = e^{-i \\frac{2\\pi}{N}}$$</div>
                        <p>é€™æ˜¯ä¸€å€‹åœ¨è¤‡æ•¸å¹³é¢å–®ä½åœ“ä¸Šé †æ™‚é‡æ—‹è½‰ $\\frac{1}{N}$ åœˆçš„å‘é‡ã€‚</p>
                        <p>DFT å…¬å¼å¯ä»¥å¯«æˆæ¥µå…¶å„ªé›…çš„ç·šæ€§ä»£æ•¸å½¢å¼ï¼š</p>
                        <div class="math-block">$$\\mathbf{X} = \\mathbf{F} \\mathbf{x}$$</div>
                        <p>å…¶ä¸­ $\\mathbf{F}$ æ˜¯ä¸€å€‹ $N \\times N$ çš„çŸ©é™£ï¼Œç¨±ç‚º DFT çŸ©é™£ï¼ˆèŒƒå¾·è’™çŸ©é™£çš„ä¸€ç¨®ï¼‰ï¼š</p>
                        <div class="math-block">
                            $$\\mathbf{F} =
                            \\begin{bmatrix}
                            1 & 1 & 1 & \\dots & 1 \\\\
                            1 & W_N & W_N^2 & \\dots & W_N^{N-1} \\\\
                            1 & W_N^2 & W_N^4 & \\dots & W_N^{2(N-1)} \\\\
                            \\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\
                            1 & W_N^{N-1} & W_N^{2(N-1)} & \\dots & W_N^{(N-1)(N-1)}
                            \\end{bmatrix}$$
                        </div>
                        <p>é€™å€‹çŸ©é™£çš„æ¯ä¸€è¡Œï¼ˆRowï¼‰éƒ½æ˜¯ä¸€å€‹ç‰¹å®šé »ç‡çš„æ­£äº¤åŸºåº•ã€‚</p>

                        <h3>3. è¨ˆç®—å±æ©Ÿï¼š$O(N^2)$ çš„è©›å’’</h3>
                        <p>é›–ç„¶çŸ©é™£å½¢å¼å¾ˆç¾ï¼Œä½†ç›´æ¥è¨ˆç®—å®ƒæœ‰å€‹å¤§å•é¡Œã€‚è¦è¨ˆç®— $\\mathbf{X}$ ä¸­çš„æ¯ä¸€å€‹é»ï¼Œéƒ½éœ€è¦åš $N$ æ¬¡ä¹˜æ³•å’ŒåŠ æ³•ã€‚ç¸½å…±æœ‰ $N$ å€‹é»ï¼Œæ‰€ä»¥ç¸½é‹ç®—é‡æ˜¯ $N^2$ã€‚</p>
                        <p><strong>è¤‡é›œåº¦ï¼š</strong>$O(N^2)$</p>
                        <div class="highlight">
                            <p><strong>ä»£åƒ¹ï¼š</strong>å‡è¨­ä½ è¦è™•ç†ä¸€æ®µ 1 ç§’é˜çš„é«˜éŸ³è³ªéŸ³è¨Šï¼ˆæ¡æ¨£ç‡ 44100 Hzï¼‰ï¼Œ$N \\approx 40000$ã€‚$N^2 = 16,000,000,000$ï¼ˆ160 å„„æ¬¡é‹ç®—ï¼‰ã€‚å°æ–¼ä¸€å¼µ 100 è¬ç•«ç´ çš„åœ–ç‰‡ï¼Œ$N^2 = 10^{12}$ã€‚é€™åœ¨ 1960 å¹´ä»£ä»¥å‰æ˜¯è¨ˆç®—æ©Ÿçš„æƒ¡å¤¢ã€‚</p>
                        </div>

                        <h3>4. æ¼”ç®—æ³•é©å‘½ï¼šCooley-Tukey FFT</h3>
                        <p>1965 å¹´ï¼ŒCooley å’Œ Tukey é‡æ–°ç™¼ç¾äº†ä¸€ç¨®åˆ†æ²»æ³• (Divide and Conquer)ï¼Œå°‡è¤‡é›œåº¦å¾ $O(N^2)$ é©šäººåœ°é™ä½åˆ° $O(N \\log N)$ã€‚é€™å°±æ˜¯ <strong>å¿«é€Ÿå‚…ç«‹è‘‰è®Šæ› (Fast Fourier Transform, FFT)</strong>ã€‚</p>
                        <p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong>åˆ©ç”¨ $W_N$ çš„é€±æœŸæ€§å’Œå°ç¨±æ€§ï¼š</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li><strong>é€±æœŸæ€§ï¼š</strong>$W_N^{k+N} = W_N^k$</li>
                            <li><strong>å°ç¨±æ€§ï¼š</strong>$W_N^{k+N/2} = -W_N^k$ï¼ˆè½‰åŠåœˆç­‰æ–¼åŠ è² è™Ÿï¼‰</li>
                        </ul>
                        <p><strong>æ­¥é©Ÿ (Radix-2 DIT)ï¼š</strong>æˆ‘å€‘å¯ä»¥å°‡ä¸€å€‹ $N$ é»çš„ DFT æ‹†è§£æˆå…©å€‹ $N/2$ é»çš„ DFTï¼š</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li>ä¸€å€‹åŒ…å«æ‰€æœ‰å¶æ•¸ç´¢å¼•é» ($x[0], x[2], \\dots$)</li>
                            <li>ä¸€å€‹åŒ…å«æ‰€æœ‰å¥‡æ•¸ç´¢å¼•é» ($x[1], x[3], \\dots$)</li>
                        </ul>
                        <div class="math-block">
                            $$X[k] = E[k] + W_N^k O[k]$$
                            $$X[k + \\frac{N}{2}] = E[k] - W_N^k O[k]$$
                        </div>
                        <p><strong>å¥‡è¹Ÿç™¼ç”Ÿäº†ï¼š</strong>æˆ‘å€‘åªéœ€è¦è¨ˆç®—ä¸€åŠçš„ç¯„åœï¼Œå¾ŒåŠæ®µçš„çµæœå¯ä»¥é€éå‰åŠæ®µçš„çµæœã€Œå…è²»ã€ç®—å‡ºä¾†ï¼ˆåªéœ€è®Šå€‹ç¬¦è™Ÿï¼‰ã€‚é€™æ¨£ä¸€ç›´éè¿´æ‹†è§£ä¸‹å»ï¼Œç›´åˆ°å‰©ä¸‹ 2 é» DFTã€‚</p>
                        <p><strong>æ•ˆç‡æå‡ï¼š</strong>è‹¥ $N = 1024$ï¼š</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li>DFT: $1024^2 \\approx 1,000,000$ æ¬¡é‹ç®—ã€‚</li>
                            <li>FFT: $1024 \\times \\log_2(1024) = 1024 \\times 10 \\approx 10,000$ æ¬¡é‹ç®—ã€‚</li>
                        </ul>
                        <p>é€Ÿåº¦æå‡äº† 100 å€ï¼ æ•¸æ“šè¶Šå¤§ï¼Œå·®ç•°è¶Šææ€–ã€‚é€™å°±æ˜¯ç‚ºä»€éº¼æˆ‘å€‘ä»Šå¤©èƒ½å³æ™‚çœ‹ä¸²æµå½±ç‰‡çš„åŸå› ã€‚</p>

                        <h3>èª²å¾Œç·´ç¿’ (Linear Algebra & Arithmetic)</h3>
                        <div class="bg-white/5 p-4 rounded-lg border border-white/10 my-4">
                            <h4 class="text-white font-bold mb-2">é¡Œç›®ï¼šè¨ˆç®— 4 é» DFT</h4>
                            <p class="text-gray-300">é›–é›–ç„¶æ‰‹ç®— FFT å¾ˆç—›è‹¦ï¼Œä½†æ‰‹ç®—ä¸€å€‹å°å‹çš„ DFT å¯ä»¥è®“ä½ å°ã€Œæ—‹è½‰å› å­ã€éå¸¸æœ‰æ„Ÿã€‚</p>
                            <p class="text-gray-300 mt-2">è¨­æœ‰ä¸€å€‹é•·åº¦ç‚º 4 çš„é›¢æ•£è¨Šè™Ÿï¼š</p>
                            <div class="math-block">$$x[n] = [1, 0, -1, 0]$$</div>
                            <p class="text-gray-300">(é€™å°æ‡‰æ–¼ $n=0, 1, 2, 3$ çš„å€¼)</p>
                            <p class="text-gray-300 mt-2">è«‹åˆ©ç”¨ DFT å®šç¾©æˆ–çŸ©é™£ä¹˜æ³•ï¼Œè¨ˆç®—å…¶é »è­œ $X[k]$ (å…¶ä¸­ $k=0, 1, 2, 3$)ã€‚</p>
                            <p class="text-xs text-gray-500 mt-2">(æç¤ºï¼š4 é»çš„æ—‹è½‰å› å­ $W_4 = e^{-i \\frac{2\\pi}{4}} = e^{-i \\frac{\\pi}{2}} = -i$ã€‚çŸ©é™£ä¸­çš„å…ƒç´ å°‡æœƒæ˜¯ $1, -i, (-i)^2, (-i)^3$ ç­‰çš„çµ„åˆã€‚)</p>
                        </div>

                        <h3>ç·´ç¿’é¡Œè§£ç­”</h3>
                        <p class="text-xs text-gray-500 mb-2">(é»æ“Šä¸‹æ–¹å€åŸŸæŸ¥çœ‹è©³ç´°è¨ˆç®—éç¨‹)</p>
                        <div class="spoiler-blur" onclick="this.classList.add('revealed')">
                            <h4 class="text-white font-bold mt-0">1. æº–å‚™æ—‹è½‰å› å­ $W_4$</h4>
                            <div class="math-block">$$W_4 = e^{-i \\frac{2\\pi}{4}} = -i$$</div>
                            <p>ç›¸é—œå†ªæ¬¡ï¼š</p>
                            <ul class="list-disc pl-6 text-gray-300 mb-4">
                                <li>$W_4^0 = 1$</li>
                                <li>$W_4^1 = -i$</li>
                                <li>$W_4^2 = (-i)^2 = -1$</li>
                                <li>$W_4^3 = (-i)^3 = i$</li>
                            </ul>

                            <h4 class="text-white font-bold mt-4">2. ä½¿ç”¨å®šç¾©å…¬å¼å±•é–‹</h4>
                            <div class="math-block">$$X[k] = \\sum_{n=0}^{3} x[n] W_4^{kn}$$</div>
                            <p>ä»£å…¥ $x[n]$ çš„å€¼ï¼Œåªæœ‰ $n=0$ å’Œ $n=2$ æœ‰å€¼ï¼ˆ$1$ å’Œ $-1$ï¼‰ï¼Œå…¶ä»–ç‚º 0ã€‚</p>
                            <div class="math-block">$$X[k] = 1 \\cdot W_4^{k \\cdot 0} + (-1) \\cdot W_4^{k \\cdot 2} = 1 - W_4^{2k}$$</div>

                            <h4 class="text-white font-bold mt-4">3. é€ä¸€è¨ˆç®— $k$</h4>
                            <ul class="list-disc pl-6 text-gray-300 mb-4">
                                <li><strong>ç•¶ $k=0$ (ç›´æµåˆ†é‡):</strong><br>$X[0] = 1 - W_4^0 = 1 - 1 = 0$</li>
                                <li><strong>ç•¶ $k=1$ (åŸºé »):</strong><br>$X[1] = 1 - W_4^2 = 1 - (-1) = 2$</li>
                                <li><strong>ç•¶ $k=2$ (ä¸­é »/å¥ˆå¥æ–¯ç‰¹é »ç‡):</strong><br>$X[2] = 1 - W_4^4$<br>å› ç‚º $W_4^4 = (W_4^0) = 1$ (è½‰ä¸€åœˆå›åˆ°åŸé»)<br>$X[2] = 1 - 1 = 0$</li>
                                <li><strong>ç•¶ $k=3$ (è² åŸºé »):</strong><br>$X[3] = 1 - W_4^6$<br>$W_4^6 = W_4^4 \\cdot W_4^2 = 1 \\cdot (-1) = -1$<br>$X[3] = 1 - (-1) = 2$</li>
                            </ul>
                            
                            <div class="highlight">
                                <p><strong>ç­”æ¡ˆï¼š</strong></p>
                                <div class="math-block">$$X[k] = [0, 2, 0, 2]$$</div>
                            </div>
                            <p class="text-xs text-gray-400"><strong>ç‰©ç†æ„ç¾©è§£è®€ï¼š</strong><br>åŸå§‹è¨Šè™Ÿ $1, 0, -1, 0$ å…¶å¯¦å°±æ˜¯ $\\cos(\\frac{\\pi}{2} n)$ çš„æ¡æ¨£ã€‚<br>æˆ‘å€‘ç®—å‡ºçš„é »è­œåœ¨ $k=1$ å’Œ $k=3$ æœ‰å€¼ã€‚<br>åœ¨ 4 é» DFT ä¸­ï¼Œ$k=1$ ä»£è¡¨æ­£é »ç‡ï¼Œ$k=3$ ä»£è¡¨è² é »ç‡ï¼ˆ$3 \\equiv -1 \\pmod 4$ï¼‰ã€‚<br>æ‰€ä»¥é »è­œé¡¯ç¤ºé€™æ˜¯ä¸€å€‹ç´”ç²¹çš„é¤˜å¼¦æ³¢ï¼Œæ²’æœ‰ç›´æµåˆ†é‡ ($k=0$ ç‚º 0)ï¼Œä¹Ÿæ²’æœ‰æœ€é«˜é »åˆ†é‡ ($k=2$ ç‚º 0)ã€‚</p>
                        </div>
                    </div>`
            },
8: {
                title: "è¶…è¶Šå‚…ç«‹è‘‰â€”â€”ä¸ç¢ºå®šæ€§èˆ‡ç¾ä»£æ“´å±•",
                content: `
                    <div class="lesson-body">
                        <h3>1. å‚…ç«‹è‘‰çš„é˜¿åŸºé‡Œæ–¯ä¹‹è¸µï¼šæ™‚é–“çš„æ¶ˆå¤±</h3>
                        <p>å‚…ç«‹è‘‰è®Šæ›æœ‰ä¸€å€‹å“²å­¸ä¸Šçš„ç¡¬å‚·ï¼šå®ƒä¸Ÿå¤±äº†æ™‚é–“è³‡è¨Šã€‚</p>
                        <div class="math-block">$$F(\\omega) = \\int_{-\\infty}^{\\infty} f(t) e^{-i\\omega t} \\, dt$$</div>
                        <p>ç©åˆ†æ˜¯å¾ $-\\infty$ åˆ° $\\infty$ã€‚é€™æ„å‘³è‘— $F(\\omega)$ æ˜¯ä¸€å€‹<strong>å…¨åŸŸï¼ˆGlobalï¼‰</strong>çš„çµ±è¨ˆç‰¹å¾µã€‚</p>
                        <p>å¦‚æœä½ æŠŠè²å¤šèŠ¬çš„å‘½é‹äº¤éŸ¿æ›²å¾é ­æ’­æ”¾ï¼Œåšä¸€æ¬¡ FFTã€‚å†æŠŠå®ƒå€’è‘—æ’­æ”¾ï¼Œåšä¸€æ¬¡ FFTã€‚çµæœçš„æŒ¯å¹…è­œæ˜¯å®Œå…¨ä¸€æ¨¡ä¸€æ¨£çš„ã€‚</p>
                        <p>å‚…ç«‹è‘‰è®Šæ›èƒ½å‘Šè¨´ä½ é€™æ®µéŸ³æ¨‚è£¡æœ‰ã€ŒDoã€Miã€Solã€é€™äº›é »ç‡ï¼Œä½†å®ƒç„¡æ³•å‘Šè¨´ä½ é€™äº›éŸ³ç¬¦æ˜¯ä»€éº¼æ™‚å€™å‡ºç¾çš„ã€‚å°æ–¼éš¨æ™‚é–“è®ŠåŒ–çš„è¨Šè™Ÿï¼ˆéå¹³ç©©è¨Šè™Ÿï¼‰ï¼Œæ¨™æº–å‚…ç«‹è‘‰è®Šæ›æ˜¯ç„¡åŠ›çš„ã€‚</p>

                        <h3>2. æµ·æ£®å ¡ä¸ç¢ºå®šæ€§åŸç† (Heisenberg Uncertainty Principle)</h3>
                        <p>ä½ å¯èƒ½åœ¨é‡å­åŠ›å­¸è½éé€™å€‹åå­—ï¼Œä½†åœ¨è¨Šè™Ÿè™•ç†ä¸­ï¼Œå®ƒæ˜¯ç´”ç²¹çš„æ•¸å­¸äº‹å¯¦ã€‚</p>
                        <p>æˆ‘å€‘å®šç¾©è¨Šè™Ÿåœ¨æ™‚åŸŸçš„å¯¬åº¦ç‚º $\\sigma_t$ï¼Œåœ¨é »åŸŸçš„å¯¬åº¦ç‚º $\\sigma_\\omega$ã€‚</p>
                        <p>æ•¸å­¸ä¸Šå¯ä»¥è­‰æ˜ï¼š</p>
                        <div class="math-block">$$\\sigma_t \\cdot \\sigma_\\omega \\ge \\frac{1}{2}$$</div>
                        <p><strong>æ„ç¾©ï¼š</strong></p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li>ä½ æƒ³è¦åœ¨æ™‚é–“ä¸Šå®šä½å¾—è¶Šç²¾æº–ï¼ˆ$\\sigma_t$ æ¥µå°ï¼Œä¾‹å¦‚çŸ­è„ˆè¡ï¼‰ï¼Œé »è­œå°±æœƒæ•£å¾—è¶Šé–‹ï¼ˆ$\\sigma_\\omega$ æ¥µå¤§ï¼Œå¯¬é »å¸¶ï¼‰ã€‚</li>
                            <li>ä½ æƒ³è¦åœ¨é »ç‡ä¸Šå®šä½å¾—è¶Šç²¾æº–ï¼ˆ$\\sigma_\\omega$ æ¥µå°ï¼Œä¾‹å¦‚ç´”å¼¦æ³¢ï¼‰ï¼Œå®ƒåœ¨æ™‚é–“ä¸Šå°±å¿…é ˆå»¶çºŒç„¡çª®ä¹…ï¼ˆ$\\sigma_t \\to \\infty$ï¼‰ã€‚</li>
                        </ul>
                        <p>é€™å°±æ˜¯ä»£åƒ¹ã€‚ä½ ç„¡æ³•åŒæ™‚æ“æœ‰å®Œç¾çš„æ™‚é–“è§£æåº¦èˆ‡é »ç‡è§£æåº¦ã€‚</p>

                        <h3>3. è£œæ•‘æ–¹æ¡ˆ Aï¼šçŸ­æ™‚è·å‚…ç«‹è‘‰è®Šæ› (STFT)</h3>
                        <p>ç‚ºäº†è§£æ±ºã€Œä¸çŸ¥é“ä»€éº¼æ™‚å€™ç™¼ç”Ÿã€çš„å•é¡Œï¼Œå·¥ç¨‹å¸«æƒ³å‡ºäº†ä¸€å€‹ç°¡å–®æš´åŠ›çš„è§£æ³•ï¼šåŠ çª—ï¼ˆWindowingï¼‰ã€‚</p>
                        <p>æˆ‘å€‘ä¸å°æ•´é¦–æ­Œåšè®Šæ›ï¼Œè€Œæ˜¯åˆ‡æˆä¸€å°æ®µä¸€å°æ®µï¼ˆä¾‹å¦‚æ¯ 20ms ä¸€æ®µï¼‰ï¼Œç„¶å¾Œå°æ¯ä¸€å°æ®µåš FFTã€‚</p>
                        <div class="math-block">$$STFT(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} f(t) \\cdot w(t - \\tau) e^{-i\\omega t} \\, dt$$</div>
                        <p>$w(t-\\tau)$ æ˜¯ä¸€å€‹æ»‘å‹•çš„çª—å£å‡½æ•¸ï¼ˆä¾‹å¦‚é«˜æ–¯çª—ï¼‰ã€‚çµæœæ˜¯ä¸€å€‹äºŒç¶­åœ–è­œï¼Œç¨±ç‚ºé »è­œåœ– (Spectrogram)ï¼ˆæ©«è»¸æ˜¯æ™‚é–“ï¼Œç¸±è»¸æ˜¯é »ç‡ï¼Œé¡è‰²æ˜¯å¼·åº¦ï¼‰ã€‚</p>
                        <p><strong>ç¼ºé»ï¼š</strong>çª—å£å¤§å°æ˜¯å›ºå®šçš„ã€‚</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li>çª—å¤ªå¯¬ $\\to$ æ™‚é–“æ¨¡ç³Šã€‚</li>
                            <li>çª—å¤ªçª„ $\\to$ é »ç‡æ¨¡ç³Šã€‚</li>
                        </ul>
                        <p>ä½ è¢«å›°åœ¨æµ·æ£®å ¡çš„ç‰¢ç± è£¡ã€‚</p>

                        <h3>4. è£œæ•‘æ–¹æ¡ˆ Bï¼šå°æ³¢è®Šæ› (Wavelet Transform)</h3>
                        <p>é€™æ˜¯ 1980 å¹´ä»£æ•¸å­¸ç•Œçš„æ–æ»¾å·¨æ˜Ÿã€‚å°æ³¢è®Šæ›ä¸å†ä½¿ç”¨å–®ä¸€é•·åº¦çš„çª—å£ï¼Œè€Œæ˜¯ä½¿ç”¨å¯ä¼¸ç¸®çš„æ³¢å½¢ã€‚</p>
                        <ul class="list-disc pl-6 text-gray-300 mb-4">
                            <li><strong>é«˜é »è¨Šè™Ÿï¼š</strong>è®ŠåŒ–å¿«ï¼ŒæŒçºŒæ™‚é–“çŸ­ã€‚$\\to$ ä½¿ç”¨æ¥µçª„çš„çª—å£ï¼ˆé«˜æ™‚é–“è§£æåº¦ï¼‰ã€‚</li>
                            <li><strong>ä½é »è¨Šè™Ÿï¼š</strong>è®ŠåŒ–æ…¢ï¼ŒæŒçºŒæ™‚é–“é•·ã€‚$\\to$ ä½¿ç”¨æ¥µå¯¬çš„çª—å£ï¼ˆé«˜é »ç‡è§£æåº¦ï¼‰ã€‚</li>
                        </ul>
                        <p>é€™è¢«ç¨±ç‚ºå¤šè§£æåº¦åˆ†æ (Multi-Resolution Analysis)ã€‚å®ƒå°±åƒæ˜¯çµ¦äº†ä½ ä¸€å°é¡¯å¾®é¡ï¼ˆçœ‹é«˜é »ç´°ç¯€ï¼‰å’Œä¸€å°æœ›é é¡ï¼ˆçœ‹ä½é »è¼ªå»“ï¼‰ï¼Œè®“ä½ æ—¢è¦‹æ¨¹æœ¨ï¼Œåˆè¦‹æ£®æ—ã€‚</p>

                        <h3>ç¸½çµï¼šå…«å ‚èª²çš„å›é¡§</h3>
                        <div class="bg-white/5 p-4 rounded border border-white/10 text-sm text-gray-300">
                            <ul class="list-none space-y-2">
                                <li>ğŸ“ <strong>å¹¾ä½•</strong>ï¼šå‡½æ•¸æ˜¯å‘é‡ï¼Œæ­£äº¤æ˜¯éˆé­‚ã€‚</li>
                                <li>ğŸ”„ <strong>ç´šæ•¸</strong>ï¼šé€±æœŸæ³¢å½¢å¯ä»¥æ‹†è§£ç‚ºæ—‹è½‰çš„å‘é‡å’Œã€‚</li>
                                <li>ğŸŒŠ <strong>è®Šæ›</strong>ï¼šé€±æœŸè¶¨å‘ç„¡çª®ï¼Œé›¢æ•£è­œè®Šæˆé€£çºŒè­œã€‚</li>
                                <li>âš™ï¸ <strong>å·ç©</strong>ï¼šç³»çµ±çš„é‹ç®—ï¼Œåœ¨é »åŸŸåªæ˜¯ç°¡å–®çš„ä¹˜æ³•ã€‚</li>
                                <li>ğŸ”‹ <strong>èƒ½é‡</strong>ï¼šå¸•å¡ç“¦çˆ¾å®šç†ä¿è­‰äº†è®Šæ›çš„ç‰©ç†å®ˆæ†ã€‚</li>
                                <li>ğŸ“¸ <strong>å–æ¨£</strong>ï¼šæ•¸ä½åŒ–çš„ä»£åƒ¹æ˜¯é »è­œçš„è¤‡è£½èˆ‡æ½›åœ¨çš„æ··ç–Šã€‚</li>
                                <li>âš¡ <strong>FFT</strong>ï¼šåˆ†æ²»æ³•æ¼”ç®—æ³•è®“å³æ™‚é‹ç®—æˆç‚ºå¯èƒ½ã€‚</li>
                                <li>ğŸš« <strong>æ¥µé™</strong>ï¼šä¸ç¢ºå®šæ€§åŸç†é™åˆ¶äº†æˆ‘å€‘å°æ™‚ç©ºçš„èªçŸ¥ï¼Œå‚¬ç”Ÿäº†å°æ³¢åˆ†æã€‚</li>
                            </ul>
                        </div>
                        <p class="mt-4">é€™å°±æ˜¯å‚…ç«‹è‘‰è®Šæ›çš„å®Œæ•´æ—…ç¨‹ã€‚å¾ 19 ä¸–ç´€çš„ç†±å‚³å°æ–¹ç¨‹å¼ï¼Œåˆ° 21 ä¸–ç´€çš„é‡å­è¨ˆç®—èˆ‡ AIï¼Œé€™å€‹æ•¸å­¸å·¥å…·å§‹çµ‚æ˜¯äººé¡ç†è§£æ³¢å‹•ä¸–ç•Œçš„åŸºçŸ³ã€‚</p>

                        <h3>æœ€çµ‚è€ƒé©— (The Final Problem)</h3>
                        <div class="bg-white/5 p-4 rounded-lg border border-white/10 my-4">
                            <h4 class="text-white font-bold mb-2">é¡Œç›®ï¼šé«˜æ–¯å‡½æ•¸çš„å‚…ç«‹è‘‰è®Šæ›</h4>
                            <p class="text-gray-300">ç‚ºäº†è­‰æ˜ä¸ç¢ºå®šæ€§åŸç†ï¼Œæˆ‘å€‘é¸ç”¨æ•¸å­¸ä¸Šæœ€ç‰¹æ®Šçš„å‡½æ•¸â€”â€”é«˜æ–¯å‡½æ•¸ (Gaussian Function)ã€‚å®ƒæ˜¯å”¯ä¸€èƒ½è®“ä¸ç¢ºå®šæ€§ä¸ç­‰å¼å–ã€Œç­‰è™Ÿã€ï¼ˆé”åˆ°æ¥µé™ï¼‰çš„å‡½æ•¸ã€‚</p>
                            <p class="text-gray-300 mt-4">è¨­å‡½æ•¸ $f(t)$ ç‚ºä¸€å€‹ä¸­å¿ƒåœ¨åŸé»çš„é«˜æ–¯é˜å½¢æ›²ç·šï¼š</p>
                            <div class="math-block">$$f(t) = e^{-at^2}, \\quad a > 0$$</div>
                            <p class="text-gray-300">è«‹è¨ˆç®—å…¶å‚…ç«‹è‘‰è®Šæ› $F(\\omega)$ã€‚</p>
                            <p class="text-xs text-gray-500 mt-2">(æç¤ºï¼šä½ éœ€è¦ç”¨åˆ°é«˜æ–¯ç©åˆ†å…¬å¼ $\\int_{-\\infty}^{\\infty} e^{-x^2} dx = \\sqrt{\\pi}$ï¼Œä¸¦é€éé…æ–¹æ–¹å®Œæˆç©åˆ†ã€‚)</p>
                            <p class="text-gray-300 mt-2">è§€å¯Ÿçµæœï¼šç•¶åƒæ•¸ $a$ è®Šå¤§ï¼ˆæ™‚åŸŸè®Šçª„ï¼‰æ™‚ï¼Œ$F(\\omega)$ çš„å¯¬åº¦æœƒç™¼ç”Ÿä»€éº¼è®ŠåŒ–ï¼Ÿ</p>
                        </div>

                        <h3>ç·´ç¿’é¡Œè§£ç­”</h3>
                        <p class="text-xs text-gray-500 mb-2">(é»æ“Šä¸‹æ–¹å€åŸŸæŸ¥çœ‹è©³ç´°è¨ˆç®—éç¨‹)</p>
                        <div class="spoiler-blur" onclick="this.classList.add('revealed')">
                            <h4 class="text-white font-bold mt-0">1. è¨­å®šç©åˆ†</h4>
                            <div class="math-block">$$F(\\omega) = \\int_{-\\infty}^{\\infty} e^{-at^2} e^{-i\\omega t} \\, dt$$</div>
                            <p>åˆä½µæŒ‡æ•¸é …ï¼š</p>
                            <div class="math-block">$$F(\\omega) = \\int_{-\\infty}^{\\infty} e^{-(at^2 + i\\omega t)} \\, dt$$</div>

                            <h4 class="text-white font-bold mt-4">2. é…æ–¹æ³• (Completing the Square)</h4>
                            <p>æˆ‘å€‘å¸Œæœ›å°‡æŒ‡æ•¸éƒ¨åˆ†æ¹Šæˆå®Œå…¨å¹³æ–¹å½¢å¼ $-a(t + k)^2 + C$ã€‚</p>
                            <p>ç›®æ¨™ï¼š$at^2 + i\\omega t = a(t^2 + \\frac{i\\omega}{a}t)$</p>
                            <p>é…æ–¹ï¼š</p>
                            <div class="math-block">
                                $$a \\left( t^2 + \\frac{i\\omega}{a}t + \\left(\\frac{i\\omega}{2a}\\right)^2 - \\left(\\frac{i\\omega}{2a}\\right)^2 \\right)$$
                                $$= a \\left( t + \\frac{i\\omega}{2a} \\right)^2 - a \\left( \\frac{i^2 \\omega^2}{4a^2} \\right)$$
                                $$= a \\left( t + \\frac{i\\omega}{2a} \\right)^2 + \\frac{\\omega^2}{4a}$$
                            </div>
                            <p>ä»£å›ç©åˆ†å¼ï¼š</p>
                            <div class="math-block">$$F(\\omega) = \\int_{-\\infty}^{\\infty} e^{-\\left[ a(t + \\frac{i\\omega}{2a})^2 + \\frac{\\omega^2}{4a} \\right]} \\, dt$$</div>
                            <p>å°‡èˆ‡ $t$ ç„¡é—œçš„é …ç§»å‡ºç©åˆ†å¤–ï¼š</p>
                            <div class="math-block">$$F(\\omega) = e^{-\\frac{\\omega^2}{4a}} \\int_{-\\infty}^{\\infty} e^{-a(t + \\frac{i\\omega}{2a})^2} \\, dt$$</div>

                            <h4 class="text-white font-bold mt-4">3. åˆ©ç”¨é«˜æ–¯ç©åˆ†å…¬å¼</h4>
                            <p>å·²çŸ¥ $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\frac{\\pi}{a}}$ã€‚</p>
                            <p>é›–ç„¶é€™è£¡çš„è®Šæ•¸å¹³ç§»äº†ä¸€å€‹è¤‡æ•¸å¸¸æ•¸ $\\frac{i\\omega}{2a}$ï¼Œä½†åœ¨è¤‡è®Šå‡½æ•¸è«–ä¸­ï¼Œç©åˆ†è·¯å¾‘å¹³ç§»ä¸æ”¹è®Šå…¨åŸŸç©åˆ†å€¼ï¼ˆæŸ¯è¥¿ç©åˆ†å®šç†ï¼‰ã€‚</p>
                            <p>æ‰€ä»¥ç©åˆ†éƒ¨åˆ†çš„å€¼ä»ç‚º $\\sqrt{\\frac{\\pi}{a}}$ã€‚</p>
                            
                            <div class="highlight">
                                <p><strong>ç­”æ¡ˆï¼š</strong></p>
                                <div class="math-block">$$F(\\omega) = \\sqrt{\\frac{\\pi}{a}} e^{-\\frac{\\omega^2}{4a}}$$</div>
                            </div>

                            <h4 class="text-white font-bold mt-4">4. ç‰©ç†æ„ç¾©åˆ†æ (ä¸ç¢ºå®šæ€§)</h4>
                            <p>è¼¸å…¥ $f(t)$ æ˜¯é«˜æ–¯å‡½æ•¸ $e^{-at^2}$ã€‚</p>
                            <p>è¼¸å‡º $F(\\omega)$ ä¹Ÿæ˜¯é«˜æ–¯å‡½æ•¸ $e^{-\\frac{\\omega^2}{4a}}$ã€‚</p>
                            <p><strong>(é«˜æ–¯å‡½æ•¸çš„å‚…ç«‹è‘‰è®Šæ›ä»ç„¶æ˜¯é«˜æ–¯å‡½æ•¸ï¼é€™æ˜¯å®ƒç¨æœ‰çš„ç‰¹å¾µã€‚)</strong></p>
                            <p>è§€å¯Ÿåƒæ•¸ $a$ï¼š</p>
                            <ul class="list-disc pl-6 text-gray-300">
                                <li>å¦‚æœ $a$ å¾ˆå¤§ï¼ˆæ™‚åŸŸ $e^{-at^2}$ è¡°æ¸›å¿«ï¼Œåœ–å½¢å¾ˆçª„ï¼‰ã€‚</li>
                                <li>é‚£éº¼ $\\frac{1}{4a}$ å°±æœƒå¾ˆå°ï¼ˆé »åŸŸ $e^{-\\frac{\\omega^2}{4a}}$ è¡°æ¸›æ…¢ï¼Œåœ–å½¢å¾ˆå¯¬ï¼‰ã€‚</li>
                            </ul>
                            <p class="mt-2 text-blue-300 font-bold">é€™å®Œç¾é©—è­‰äº†ä¸ç¢ºå®šæ€§åŸç†ï¼šæ™‚åŸŸè¶Šçª„ï¼Œé »åŸŸè¶Šå¯¬ã€‚</p>
                            
                            <div class="mt-8 p-4 border-t border-white/20 text-center">
                                <p class="text-white font-bold text-lg">ğŸ‰ æ­å–œä½ å®Œæˆäº†é€™ 8 å ‚å‚…ç«‹è‘‰è®Šæ›çš„ç³»çµ±æ€§èª²ç¨‹ï¼</p>
                                <p class="text-sm text-gray-400 mt-2">å¸Œæœ›é€™å¥—ã€Œå¾å¹¾ä½•ç›´è§€åˆ°æ¼”ç®—æ³•å¯¦è¸ã€çš„æ¡†æ¶ï¼Œèƒ½æˆç‚ºä½ æœªä¾†æ·±å…¥ç ”ç©¶æ•¸å­¸èˆ‡ç‰©ç†çš„å …å¯¦åŸºçŸ³ã€‚</p>
                            </div>
                        </div>
                    </div>`
            }
        };

        // --- Navigation & UI ---
        function showPage(pageId) {
            state.page = pageId;
            document.querySelectorAll('.page').forEach(p => {
                p.classList.remove('active');
                if(p.id === 'page-knowledge' && pageId !== 'knowledge') p.scrollTop = 0;
            });
            document.getElementById('page-' + pageId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('nav-' + pageId).classList.add('active');
            if(pageId === 'studio') resize();
            
            // Typeset MathJax when showing knowledge page
            if(pageId === 'knowledge' && window.MathJax) {
                setTimeout(() => MathJax.typesetPromise(), 50);
            }
        }

        function flipCard(card) {
            if(window.MathJax && !card.classList.contains('flipped')) {
                MathJax.typesetPromise([card.querySelector('.flip-card-back')]);
            }
            card.classList.toggle('flipped');
        }

        function openLesson(id, event) {
            event.stopPropagation();
            const modal = document.getElementById('lesson-modal');
            const content = document.getElementById('lesson-body');
            const data = lessons[id];
            content.innerHTML = `
                <h2 class="text-3xl font-bold text-white mb-2">${data.title}</h2>
                <div class="h-1 w-20 bg-blue-500 mb-8"></div>
                ${data.content}
            `;
            modal.classList.add('open');
            if(window.MathJax) MathJax.typesetPromise([content]);
        }

        function closeLesson() {
            document.getElementById('lesson-modal').classList.remove('open');
        }
        document.getElementById('lesson-modal').addEventListener('click', (e) => {
            if(e.target.id === 'lesson-modal') closeLesson();
        });

        // --- Same logic as V7.0 below ---
// --- DFT Algorithm ---
        function dft(x) {
            const X = [];
            const N = x.length;
            for (let k = 0; k < N; k++) {
                let re = 0;
                let im = 0;
                for (let n = 0; n < N; n++) {
                    const phi = (2 * Math.PI * k * n) / N;
                    re += x[n].x * Math.cos(phi) + x[n].y * Math.sin(phi);
                    im += x[n].y * Math.cos(phi) - x[n].x * Math.sin(phi);
                }
                re = re / N;
                im = im / N;
                
                let freq = k;
                let amp = Math.sqrt(re * re + im * im);
                let phase = Math.atan2(im, re);
                
                // Handle negative frequencies
                if (k > N / 2) {
                    freq = k - N;
                }

                X[k] = { re, im, freq, amp, phase };
            }
            return X;
        }

        // --- Setup Canvases ---
        const canvasWave = document.getElementById('canvas-wave');
        const ctxWave = canvasWave.getContext('2d');
        
        const canvasDraw = document.getElementById('canvas-draw');
        const ctxDraw = canvasDraw.getContext('2d');
        
        const canvasTrail = document.getElementById('canvas-trail');
        const ctxTrail = canvasTrail.getContext('2d');

        function resize() {
            const w = window.innerWidth;
            const h = window.innerHeight;
            
            canvasWave.width = w; canvasWave.height = h;
            canvasDraw.width = w; canvasDraw.height = h;
            canvasTrail.width = w; canvasTrail.height = h;

            state.origin = { x: w/2, y: h/2 };
        }
        window.addEventListener('resize', resize);
        resize();

        // --- Studio Logic ---
        const statusMsg = document.getElementById('status-msg');

        // Interaction
        canvasDraw.addEventListener('mousedown', startDrawing);
        canvasDraw.addEventListener('mousemove', makeDrawing);
        canvasDraw.addEventListener('mouseup', endDrawing);
        canvasDraw.addEventListener('touchstart', e => { e.preventDefault(); startDrawing(e.touches[0]); });
        canvasDraw.addEventListener('touchmove', e => { e.preventDefault(); makeDrawing(e.touches[0]); });
        canvasDraw.addEventListener('touchend', endDrawing);

        function startDrawing(e) {
            state.drawing = true;
            state.isImageMode = false;
            state.path = [];
            state.fourierX = [];
            
            ctxTrail.clearRect(0, 0, canvasTrail.width, canvasTrail.height);
            state.lastPoint = null;
            
            state.origin = {x: 0, y: 0};
            statusMsg.innerText = "Recording...";
        }

        function makeDrawing(e) {
            if (!state.drawing) return;
            state.path.push({ x: e.clientX, y: e.clientY });
            if (state.path.length > 1) {
                const last = state.path[state.path.length-2];
                const curr = state.path[state.path.length-1];
                ctxTrail.beginPath();
                ctxTrail.strokeStyle = "#555";
                ctxTrail.lineWidth = 2;
                ctxTrail.moveTo(last.x, last.y);
                ctxTrail.lineTo(curr.x, curr.y);
                ctxTrail.stroke();
            }
        }

        function endDrawing() {
            if (!state.drawing) return;
            state.drawing = false;
            ctxTrail.clearRect(0, 0, canvasTrail.width, canvasTrail.height);
            calculateFourier(1);
        }

        // --- V7.0 Image Processing: Segment Stitching ---
 window.processImage = function(input) {
            if (!input.files || !input.files[0]) return;
            statusMsg.innerText = "Scanning (Canny Edge Mode)...";
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    const tempC = document.createElement('canvas');
                    // 1. é©åº¦é™å™ªï¼šå°‡åœ–ç‰‡ç¸®å°åˆ° 800px å¯¬ï¼Œé€™æœ¬èº«å°±æ˜¯ä¸€ç¨®å¾ˆå¥½çš„å¹³æ»‘åŒ–
                    const scale = 800 / Math.max(img.width, img.height); 
                    const w = Math.floor(img.width * scale);
                    const h = Math.floor(img.height * scale);
                    tempC.width = w;
                    tempC.height = h;
                    const tCtx = tempC.getContext('2d');
                    tCtx.drawImage(img, 0, 0, w, h);

                    const imgData = tCtx.getImageData(0, 0, w, h);
                    const data = imgData.data;

                    // 2. è½‰ç°éš (Grayscale)
                    const gray = new Float32Array(w * h);
                    for (let i = 0; i < w * h; i++) {
                        gray[i] = 0.299 * data[4*i] + 0.587 * data[4*i+1] + 0.114 * data[4*i+2];
                    }

                    // 3. è¨ˆç®—æ¢¯åº¦èˆ‡æ–¹å‘ (Sobel Gradients)
                    const mag = new Float32Array(w * h);
                    const angles = new Float32Array(w * h);
                    
                    for (let y = 1; y < h - 1; y++) {
                        for (let x = 1; x < w - 1; x++) {
                            const i = y * w + x;
                            
                            // X æ–¹å‘æ¢¯åº¦
                            const gx = 
                                -gray[i - w - 1] + gray[i - w + 1] +
                                -2 * gray[i - 1] + 2 * gray[i + 1] +
                                -gray[i + w - 1] + gray[i + w + 1];
                                
                            // Y æ–¹å‘æ¢¯åº¦
                            const gy = 
                                -gray[i - w - 1] - 2 * gray[i - w] - gray[i - w + 1] +
                                 gray[i + w - 1] + 2 * gray[i + w] + gray[i + w + 1];
                            
                            mag[i] = Math.sqrt(gx * gx + gy * gy);
                            angles[i] = Math.atan2(gy, gx);
                        }
                    }

                    // 4. éæ¥µå¤§å€¼æŠ‘åˆ¶ (NMS) - é€™æ˜¯è§£æ±ºã€Œæ¨¡ç³Šä¸€å¨ã€çš„é—œéµï¼
                    // å®ƒæœƒæŠŠç²—é‚Šç·£ã€Œå‰Šã€æˆ 1 åƒç´ å¯¬çš„ç´°ç·š
                    statusMsg.innerText = "Thinning Edges...";
                    const nms = new Float32Array(w * h);
                    
                    for (let y = 1; y < h - 1; y++) {
                        for (let x = 1; x < w - 1; x++) {
                            const i = y * w + x;
                            const m = mag[i];
                            if (m < 15) continue; // å…ˆéæ¿¾æ‰å¤ªå¼±çš„é›œè¨Š

                            let angle = angles[i] * (180 / Math.PI);
                            if (angle < 0) angle += 180;

                            // æ ¹æ“šæ¢¯åº¦æ–¹å‘ï¼Œæª¢æŸ¥ç›¸é„°åƒç´ æ˜¯å¦æ›´å¼·
                            let q = 255, r = 255;
                            
                            if ((angle >= 0 && angle < 22.5) || (angle >= 157.5 && angle <= 180)) {
                                q = mag[i + 1]; r = mag[i - 1]; // æ°´å¹³æ–¹å‘
                            } else if (angle >= 22.5 && angle < 67.5) {
                                q = mag[i + w + 1]; r = mag[i - w - 1]; // å°è§’ç·š 1
                            } else if (angle >= 67.5 && angle < 112.5) {
                                q = mag[i + w]; r = mag[i - w]; // å‚ç›´æ–¹å‘
                            } else if (angle >= 112.5 && angle < 157.5) {
                                q = mag[i + w - 1]; r = mag[i - w + 1]; // å°è§’ç·š 2
                            }

                            // åªæœ‰ç•¶è‡ªå·±æ˜¯å±€éƒ¨æœ€å¼·æ™‚æ‰ä¿ç•™ (Peak detection)
                            if (m >= q && m >= r) {
                                nms[i] = m;
                            } else {
                                nms[i] = 0;
                            }
                        }
                    }

                    // 5. é›™é‡é–€æª»èˆ‡æ»¯å¾Œé€£æ¥ (Hysteresis Thresholding)
                    // å¼·é‚Šç·£ç›´æ¥ä¿ç•™ï¼Œå¼±é‚Šç·£åªæœ‰åœ¨é€£æ¥åˆ°å¼·é‚Šç·£æ™‚æ‰ä¿ç•™
                    const highThreshold = 35; // å¼·é–€æª»
                    const lowThreshold = 10;  // å¼±é–€æª»
                    
                    const edges = [];
                    const visited = new Uint8Array(w * h);
                    const stack = [];

                    for (let i = 0; i < w * h; i++) {
                        if (nms[i] >= highThreshold && !visited[i]) {
                            // ç™¼ç¾ä¸€å€‹å¼·èµ·é»ï¼Œé–‹å§‹è¿½è¹¤æ•´æ¢ç·š
                            let segment = [];
                            stack.push(i);
                            visited[i] = 1;
                            
                            while (stack.length > 0) {
                                const currIdx = stack.pop();
                                const cx = currIdx % w;
                                const cy = Math.floor(currIdx / w);
                                segment.push({x: cx, y: cy});

                                // æª¢æŸ¥ 8 é„°åŸŸ
                                for (let dy = -1; dy <= 1; dy++) {
                                    for (let dx = -1; dx <= 1; dx++) {
                                        if (dx === 0 && dy === 0) continue;
                                        const nx = cx + dx;
                                        const ny = cy + dy;
                                        if (nx >= 0 && nx < w && ny >= 0 && ny < h) {
                                            const ni = ny * w + nx;
                                            // åªè¦å¤§æ–¼å¼±é–€æª»ä¸”æœªè¨ªå•éï¼Œå°±åŠ å…¥ç·šæ¢
                                            if (!visited[ni] && nms[ni] >= lowThreshold) {
                                                visited[ni] = 1;
                                                stack.push(ni);
                                            }
                                        }
                                    }
                                }
                            }
                            // éæ¿¾æ‰å¤ªçŸ­çš„å™ªé»ç·šæ®µ
                            if (segment.length > 5) edges.push(segment);
                        }
                    }

                    statusMsg.innerText = `Vectorizing (${edges.length} paths)...`;

                    // 6. è·¯å¾‘æ‹¼æ¥ (Greedy Stitching)
                    setTimeout(() => {
                        edges.sort((a, b) => b.length - a.length); // å…ˆç•«é•·ç·š
                        
                        let finalPath = [];
                        let unvisited = edges.map(e => ({path: e, used: false}));
                        
                        if (unvisited.length === 0) {
                             statusMsg.innerText = "No edges found."; return;
                        }

                        // å¾æœ€é•·çš„ä¸€æ¢ç·šé–‹å§‹
                        let currSeg = unvisited[0];
                        currSeg.used = true;
                        finalPath = finalPath.concat(currSeg.path);
                        
                        const maxTotalPoints = 20000; // å®‰å…¨ä¸Šé™

                        while(true) {
                            const tail = finalPath[finalPath.length-1];
                            let bestIdx = -1;
                            let minDst = Infinity;
                            let reverse = false;

                            // æœå°‹æœ€è¿‘çš„ä¸‹ä¸€æ¢ç·š
                            const scanLimit = Math.min(unvisited.length, 500); 
                            let scanned = 0;

                            for(let i=0; i<unvisited.length; i++) {
                                if(unvisited[i].used) continue;
                                scanned++;
                                if(scanned > scanLimit) break;

                                const seg = unvisited[i].path;
                                const head = seg[0];
                                const feet = seg[seg.length-1];

                                const d1 = Math.pow(tail.x - head.x, 2) + Math.pow(tail.y - head.y, 2);
                                const d2 = Math.pow(tail.x - feet.x, 2) + Math.pow(tail.y - feet.y, 2);

                                if (d1 < minDst) { minDst = d1; bestIdx = i; reverse = false; }
                                if (d2 < minDst) { minDst = d2; bestIdx = i; reverse = true; }
                            }

                            if (bestIdx !== -1) {
                                unvisited[bestIdx].used = true;
                                let seg = unvisited[bestIdx].path;
                                if(reverse) seg = seg.slice().reverse();
                                finalPath = finalPath.concat(seg);
                            } else {
                                // æ–·æ‰äº†ï¼Œéš¨ä¾¿æ‰¾ä¸€æ¢æ²’ç•«éçš„ç¹¼çºŒ
                                const next = unvisited.find(u => !u.used);
                                if(next) {
                                    next.used = true;
                                    finalPath = finalPath.concat(next.path);
                                } else {
                                    break; // å…¨éƒ¨ç•«å®Œäº†
                                }
                            }
                            
                            if (finalPath.length > maxTotalPoints) break;
                        }

                        // 7. ç¸®æ”¾èˆ‡ç½®ä¸­
                        let minX = Infinity, maxX = -Infinity, minY = Infinity, maxY = -Infinity;
                        for(let p of finalPath) {
                            minX = Math.min(minX, p.x); maxX = Math.max(maxX, p.x);
                            minY = Math.min(minY, p.y); maxY = Math.max(maxY, p.y);
                        }
                        const contentW = maxX - minX;
                        const contentH = maxY - minY;
                        const screenScale = Math.min(canvasDraw.width * 0.8, canvasDraw.height * 0.8) / Math.max(contentW, contentH);
                        const centerX = (minX + maxX) / 2;
                        const centerY = (minY + maxY) / 2;

                        state.path = finalPath.map(p => ({
                            x: (p.x - centerX) * screenScale,
                            y: (p.y - centerY) * screenScale
                        }));
                        
                        // æœ€å¾Œçš„é»æ•¸æ§åˆ¶
                        const targetPoints = 10000; 
                        if (state.path.length > targetPoints) {
                            const step = Math.ceil(state.path.length / targetPoints);
                            state.path = state.path.filter((_, i) => i % step === 0);
                        }

                        state.isImageMode = true;
                        state.origin = { x: canvasDraw.width/2, y: canvasDraw.height/2 };
                        statusMsg.innerText = `DFT Ready (${state.path.length} pts)`;
                        
                        setTimeout(() => calculateFourier(1), 50);

                    }, 50);
                }
                img.src = e.target.result;
            }
            reader.readAsDataURL(input.files[0]);
        }

        function calculateFourier(skip) {
            statusMsg.innerText = "Computing DFT...";
            const sampled = [];
            for(let i=0; i<state.path.length; i+=skip) sampled.push(state.path[i]);
            
            state.fourierX = dft(sampled);
            
            if (state.isImageMode) {
                state.fourierX[0].re = 0;
                state.fourierX[0].im = 0;
            }

            state.fourierX.sort((a, b) => b.amp - a.amp);
            state.drawTime = 0;
            state.lastPoint = null;
            statusMsg.innerText = `Drawing (${state.fourierX.length} cycles)`;
        }
        

        // --- Rendering Loops ---

        function drawWaveLoop() {
            if(state.page !== 'home') return;
            
            ctxWave.fillStyle = "#050505";
            ctxWave.fillRect(0, 0, canvasWave.width, canvasWave.height);

            let cx = canvasWave.width < 768 ? canvasWave.width / 2 : canvasWave.width * 0.3;
            let cy = canvasWave.height / 2;
            let x = cx, y = cy;

            for (let i = 0; i < state.waveN; i++) {
                let prevX = x, prevY = y;
                let n, radius;

                if (state.waveType === 'square') {
                    n = i * 2 + 1;
                    radius = 100 * (4 / (n * Math.PI));
                } else if (state.waveType === 'sawtooth') {
                    n = i + 1;
                    radius = 100 * (2 / (n * Math.PI)) * (i % 2 === 0 ? 1 : -1);
                } else {
                    n = i * 2 + 1;
                    radius = 100 * (8 / (Math.PI * Math.PI * n * n)) * (i % 2 === 0 ? 1 : -1);
                }

                x += radius * Math.cos(n * state.time);
                y += radius * Math.sin(n * state.time);

                ctxWave.beginPath();
                ctxWave.strokeStyle = "rgba(255,255,255,0.15)";
                ctxWave.arc(prevX, prevY, Math.abs(radius), 0, Math.PI * 2);
                ctxWave.stroke();

                if (i < 20) { 
                    ctxWave.beginPath();
                    ctxWave.strokeStyle = "rgba(255,255,255,0.3)";
                    ctxWave.moveTo(prevX, prevY);
                    ctxWave.lineTo(x, y);
                    ctxWave.stroke();
                }
            }

            let offset = 200;
            state.wavePath.unshift(y);
            if(state.wavePath.length > 1000) state.wavePath.pop();

            ctxWave.beginPath();
            ctxWave.strokeStyle = "rgba(255,255,255,0.1)";
            ctxWave.moveTo(x, y);
            ctxWave.lineTo(cx + offset, y);
            ctxWave.stroke();

            ctxWave.beginPath();
            ctxWave.strokeStyle = "#fff";
            ctxWave.lineWidth = 2;
            ctxWave.moveTo(cx + offset, state.wavePath[0]);
            for(let i=1; i<state.wavePath.length; i++) {
                ctxWave.lineTo(cx + offset + i, state.wavePath[i]);
            }
            ctxWave.stroke();
            state.time -= 0.02;
        }

// --- VIBE SYSTEM REPAIR PATCH (å®Œæ•´ä¿®å¾©åŒ…) ---
        
        // 1. å…¨åŸŸè®Šæ•¸å®£å‘Š (ç¢ºä¿ä¸æœƒå ±éŒ¯ is not defined)
        let audioCtx, analyser, dataArray;
        let isVibeActive = false;
        let is3DMode = false;      // è£œå›é€™å€‹è®Šæ•¸
        let vibeStreamSource = null; // é˜²æ­¢é‡è¤‡é€£æ¥

        // 2. ç²å–ä½é »èƒ½é‡ (Bass) çš„è¼”åŠ©å‡½æ•¸
        function getBassFactor() {
            if (!isVibeActive || !analyser) return 0;
            analyser.getByteFrequencyData(dataArray);
            // å–å‰ 10 å€‹é »æ®µ (ä½é »å€) çš„å¹³å‡
            let sum = 0;
            for(let i=0; i<10; i++) sum += dataArray[i];
            return (sum / 10) / 255; // å›å‚³ 0.0 ~ 1.0
        }

        // 3. Vibe Mode åˆ‡æ›é–‹é—œ (æ•´åˆ 3D + Mic)
        window.toggleVibeMode = async () => {
            isVibeActive = !isVibeActive;
            is3DMode = isVibeActive; // åŒæ­¥ç‹€æ…‹

            const btn = document.getElementById('btn-vibe');
            const wrapper = document.getElementById('studio-canvas-wrapper');
            const status = document.getElementById('status-msg');

            if (isVibeActive) {
                // é–‹å•Ÿè¦–è¦º
                wrapper.classList.add('mode-3d');
                
                // é–‹å•Ÿè½è¦º
                try {
                    if (!audioCtx) {
                        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                        analyser = audioCtx.createAnalyser();
                        analyser.fftSize = 256;
                        dataArray = new Uint8Array(analyser.frequencyBinCount);
                    }
                    if (audioCtx.state === 'suspended') {
                        await audioCtx.resume();
                    }
                    // åªæœ‰ç•¶å°šæœªé€£æ¥æ™‚æ‰è«‹æ±‚éº¥å…‹é¢¨
                    if (!vibeStreamSource) {
                        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                        vibeStreamSource = audioCtx.createMediaStreamSource(stream);
                        vibeStreamSource.connect(analyser);
                    }
                } catch (err) {
                    console.error("Mic Error:", err);
                    alert("ç„¡æ³•å•Ÿç”¨éº¥å…‹é¢¨ï¼Œå°‡åƒ…é¡¯ç¤º 3D æ•ˆæœã€‚");
                }

                // UI è®Šèº«
                btn.innerHTML = "<span>ğŸ”¥ VIBE ON</span>";
                btn.style.background = "rgba(168, 85, 247, 0.2)";
                btn.style.borderColor = "#a855f7";
                btn.style.boxShadow = "0 0 20px rgba(168, 85, 247, 0.4)";
                status.innerText = "Listening...";
            } else {
                // é—œé–‰è¦–è¦º
                wrapper.classList.remove('mode-3d');
                wrapper.style.transform = ''; // å¼·åˆ¶æ­¸ä½
                
                // UI é‚„åŸ
                btn.innerHTML = "<span>âš¡ ENTER VIBE</span>";
                btn.style.background = "rgba(168, 85, 247, 0.1)";
                btn.style.borderColor = "rgba(168, 85, 247, 0.5)";
                btn.style.boxShadow = "none";
                status.innerText = "Standard Mode";
            }
        };

        // 4. æ¸…é™¤è»Œè·¡ (ä¸æ¸…é™¤åœ“åœˆ)
        window.clearTrail = () => {
            ctxTrail.clearRect(0, 0, canvasTrail.width, canvasTrail.height);
            state.lastPoint = null;
            document.getElementById('status-msg').innerText = "Trail Cleared";
        };

        // 5. æ¸²æŸ“è¿´åœˆ (åŒ…å« 3D å½ˆè·³èˆ‡æ‡¸æµ®é‚è¼¯)
        function drawStudioLoop() {
            if(state.page !== 'studio') return;

            // å–å¾—éŸ³æ¨‚èƒ½é‡
            const bass = getBassFactor(); 
            
            // 3D èˆå°éœ‡å‹•æ•ˆæœ
            if (is3DMode) {
                const wrapper = document.getElementById('studio-canvas-wrapper');
                const bounceZ = bass * 150;     
                const tiltX = bass * 8;        
                wrapper.style.transform = `perspective(1000px) rotateX(${60 - tiltX}deg) rotateZ(20deg) scale(0.65) translateZ(${bounceZ}px)`;
            }

            // æ¸…ç©ºåœ“åœˆå±¤ (ctxDraw)ï¼Œä½†ä¿ç•™è»Œè·¡å±¤ (ctxTrail)
            ctxDraw.clearRect(0, 0, canvasDraw.width, canvasDraw.height);

            // ç¹ªè£½ç°è‰²åº•åœ– (Ghost Path)
            if (state.path.length > 0) {
                ctxDraw.beginPath();
                ctxDraw.strokeStyle = `rgba(255, 255, 255, ${0.05 + bass * 0.2})`;
                ctxDraw.lineWidth = 2;
                const startX = state.isImageMode ? state.origin.x : 0;
                const startY = state.isImageMode ? state.origin.y : 0;
                ctxDraw.moveTo(startX + state.path[0].x, startY + state.path[0].y);
                for(let p of state.path) ctxDraw.lineTo(startX + p.x, startY + p.y);
                ctxDraw.stroke();
            }

            // å‚…ç«‹è‘‰å‹•ç•«
            if (state.fourierX.length > 0) {
                let x = state.origin.x;
                let y = state.origin.y;

                for (let i = 0; i < state.fourierX.length; i++) {
                    let prevX = x, prevY = y;
                    let freq = state.fourierX[i].freq;
                    let radius = state.fourierX[i].amp;
                    let phase = state.fourierX[i].phase;

                    x += radius * Math.cos(freq * state.drawTime + phase);
                    y += radius * Math.sin(freq * state.drawTime + phase);

                    if (radius > 0.5) { 
                        // 3D æ‡¸æµ®é™°å½±èˆ‡æ”¯æŸ±
                        if (is3DMode && radius > 2) {
                            const levitation = 10 + bass * 80; 
                            // é™°å½±
                            ctxDraw.beginPath();
                            ctxDraw.strokeStyle = "rgba(0, 0, 0, 0.5)";
                            ctxDraw.lineWidth = 2;
                            ctxDraw.arc(prevX, prevY + levitation, radius, 0, Math.PI * 2);
                            ctxDraw.stroke();
                            // æ”¯æŸ±
                            ctxDraw.beginPath();
                            ctxDraw.strokeStyle = `rgba(255, 255, 255, ${0.05 + bass * 0.1})`;
                            ctxDraw.moveTo(prevX, prevY + radius);
                            ctxDraw.lineTo(prevX, prevY + levitation + radius);
                            ctxDraw.stroke();
                        }

                        // åœ“åœˆæœ¬é«”
                        ctxDraw.beginPath();
                        ctxDraw.strokeStyle = `rgba(${150 - bass*150}, ${255 - bass*50}, 255, 0.4)`; 
                        ctxDraw.lineWidth = 1;
                        ctxDraw.arc(prevX, prevY, radius, 0, Math.PI * 2);
                        ctxDraw.stroke();

                        // åŠå¾‘é€£ç·š
                        ctxDraw.beginPath();
                        ctxDraw.strokeStyle = "rgba(255, 255, 255, 0.6)"; 
                        ctxDraw.lineWidth = 1.5;
                        ctxDraw.moveTo(prevX, prevY);
                        ctxDraw.lineTo(x, y);
                        ctxDraw.stroke();
                    }
                }

                // ç¹ªè£½è»Œè·¡ (Trail)
                if (state.lastPoint) {
                    const dist = Math.hypot(x - state.lastPoint.x, y - state.lastPoint.y);                    
                    const jumpThreshold = 2 + state.drawSpeed * 3; 
                    let opacity = 1;
                    if (dist > jumpThreshold) opacity = Math.max(0.02, jumpThreshold / (dist * 1.5));

                    ctxTrail.beginPath();
                    ctxTrail.lineWidth = 2.5 + bass * 8; // éŸ³æ¨‚è¶Šå¼·ç·šè¶Šç²—
                    ctxTrail.strokeStyle = `rgba(255, 255, 255, ${opacity})`;
                    ctxTrail.lineCap = "round";
                    ctxTrail.moveTo(state.lastPoint.x, state.lastPoint.y);
                    ctxTrail.lineTo(x, y);
                    ctxTrail.stroke();
                }

                state.lastPoint = {x, y};
                const dt = (2 * Math.PI / state.fourierX.length);
                state.drawTime += dt * state.drawSpeed;

                // å¾ªç’°é‡ç½® (ä¸æ¸…é™¤è»Œè·¡)
                if (state.drawTime > 2 * Math.PI) {
                    state.drawTime = 0;
                    state.lastPoint = null;
                }
            }
        }

       function drawStudioLoop() {
            if(state.page !== 'studio') return;

            // 1. éŸ³è¨Šé©…å‹•åƒæ•¸
            const bass = getBassFactor(); 
            
            // 2. 3D èˆå°å‹•æ…‹ç‰¹æ•ˆ (The Vibe)
            if (is3DMode) {
                const wrapper = document.getElementById('studio-canvas-wrapper');
                // è®“èˆå°éš¨è‘—é‡ä½éŸ³åœ¨ Z è»¸å½ˆè·³ (0px ~ 200px)
                const bounceZ = bass * 200;     
                // è®“èˆå°è§’åº¦éš¨è‘—ç¯€å¥å¾®å¾®æŠ¬èµ· (Headbanging effect)
                const tiltX = bass * 10;        
                
                // å‹•æ…‹å¯«å…¥ CSS (åŸºåº•æ•¸å€¼èˆ‡ style.css ä¿æŒä¸€è‡´ï¼Œä¸¦ç–ŠåŠ å‹•ç•«)
                wrapper.style.transform = `perspective(1000px) rotateX(${60 - tiltX}deg) rotateZ(20deg) scale(0.65) translateZ(${bounceZ}px)`;
            }

            // æ¸…ç©ºç¹ªåœ–å±¤
            ctxDraw.clearRect(0, 0, canvasDraw.width, canvasDraw.height);

            // 3. ç•«å‡ºç°è‰²åº•åœ– (Ghost Path)
            if (state.path.length > 0) {
                ctxDraw.beginPath();
                // ç·šæ¢äº®åº¦éš¨éŸ³æ¨‚é–ƒçˆ
                ctxDraw.strokeStyle = `rgba(255, 255, 255, ${0.05 + bass * 0.2})`; 
                ctxDraw.lineWidth = 2;
                
                const startX = state.isImageMode ? state.origin.x : 0;
                const startY = state.isImageMode ? state.origin.y : 0;

                ctxDraw.moveTo(startX + state.path[0].x, startY + state.path[0].y);
                for(let p of state.path) ctxDraw.lineTo(startX + p.x, startY + p.y);
                ctxDraw.stroke();
            }

            // 4. å‚…ç«‹è‘‰å‹•ç•«æ ¸å¿ƒ
            if (state.fourierX.length > 0) {
                let x = state.origin.x;
                let y = state.origin.y;

                for (let i = 0; i < state.fourierX.length; i++) {
                    let prevX = x, prevY = y;
                    let freq = state.fourierX[i].freq;
                    let radius = state.fourierX[i].amp;
                    let phase = state.fourierX[i].phase;

                    x += radius * Math.cos(freq * state.drawTime + phase);
                    y += radius * Math.sin(freq * state.drawTime + phase);

                    if (radius > 0.5) { 
                        // --- 3D é«˜åº¦æ¨¡æ“¬ (Levitation Effect) ---
                        if (is3DMode && radius > 2) {
                            // è¨ˆç®—æ‡¸æµ®é«˜åº¦ (éš¨éŸ³é‡è®Šé«˜)
                            const levitation = 10 + bass * 80; 
                            
                            // A. ç¹ªè£½ã€Œåœ°æ¿é™°å½±ã€ (Shadow) - ä½æ–¼åœ“åœˆä¸‹æ–¹
                            ctxDraw.beginPath();
                            ctxDraw.strokeStyle = "rgba(0, 0, 0, 0.5)"; // æ·±è‰²é™°å½±
                            ctxDraw.lineWidth = 2;
                            // é™°å½±ç•«åœ¨ Y è»¸åç§»è™• (è¦–è¦ºä¸Šçš„ä¸‹æ–¹/é æ–¹)
                            ctxDraw.arc(prevX, prevY + levitation, radius, 0, Math.PI * 2);
                            ctxDraw.stroke();

                            // B. ç¹ªè£½ã€Œèƒ½é‡æ”¯æŸ±ã€ (Pillar) - é€£æ¥åœ“åœˆèˆ‡é™°å½±
                            ctxDraw.beginPath();
                            ctxDraw.strokeStyle = `rgba(255, 255, 255, ${0.05 + bass * 0.1})`; // æ·¡è‰²æ”¯æŸ±
                            ctxDraw.moveTo(prevX, prevY + radius); // åœ“åœˆåº•éƒ¨
                            ctxDraw.lineTo(prevX, prevY + levitation + radius); // é™°å½±åº•éƒ¨
                            ctxDraw.stroke();
                        }
                        // -------------------------------------

                        ctxDraw.beginPath();
                        // åœ“åœˆé¡è‰²éš¨éŸ³æ¨‚è®Šæ› (é’è‰²/ç™½è‰²é–ƒçˆ)
                        ctxDraw.strokeStyle = `rgba(${150 - bass*150}, ${255 - bass*50}, 255, 0.4)`; 
                        ctxDraw.lineWidth = 1;
                        ctxDraw.arc(prevX, prevY, radius, 0, Math.PI * 2);
                        ctxDraw.stroke();

                        ctxDraw.beginPath();
                        ctxDraw.strokeStyle = "rgba(255, 255, 255, 0.6)"; 
                        ctxDraw.lineWidth = 1.5;
                        ctxDraw.moveTo(prevX, prevY);
                        ctxDraw.lineTo(x, y);
                        ctxDraw.stroke();
                    }
                }

                // 5. ç•«å‡ºç™½è‰²è»Œè·¡ (Trail)
                if (state.lastPoint) {
                    const dist = Math.hypot(x - state.lastPoint.x, y - state.lastPoint.y);                    
                    const jumpThreshold = 2 + state.drawSpeed * 3; 
                    
                    let opacity = 1;
                    if (dist > jumpThreshold) {
                        opacity = Math.max(0.02, jumpThreshold / (dist * 1.5));
                    }

                    ctxTrail.beginPath();
                    // è»Œè·¡å¯¬åº¦éš¨é‡ä½éŸ³è®Šç²—
                    ctxTrail.lineWidth = 2.5 + bass * 10; 
                    ctxTrail.strokeStyle = `rgba(255, 255, 255, ${opacity})`;
                    ctxTrail.lineCap = "round";
                    ctxTrail.moveTo(state.lastPoint.x, state.lastPoint.y);
                    ctxTrail.lineTo(x, y);
                    ctxTrail.stroke();
                }

                state.lastPoint = {x, y};

                const dt = (2 * Math.PI / state.fourierX.length);
                state.drawTime += dt * state.drawSpeed;

                // 6. å¾ªç’°é‡ç½®
                if (state.drawTime > 2 * Math.PI) {
                    state.drawTime = 0;
                    state.lastPoint = null;
                }
            }
        }

        // --- Controls ---
        document.getElementById('wave-slider').addEventListener('input', e => {
            state.waveN = parseInt(e.target.value);
            document.getElementById('wave-n-display').innerText = state.waveN;
            state.wavePath = [];
        });

        const speedInput = document.getElementById('speed-input');
        speedInput.addEventListener('input', e => {
            let val = parseFloat(e.target.value);
            if(isNaN(val)) val = 1;
            if(val < 0.001) val = 0.001;
            if(val > 1000) val = 1000;
            state.drawSpeed = val;
        });

        window.setWaveType = type => { state.waveType = type; state.wavePath = []; };
        
        window.resetCanvas = () => { 
            state.path = []; state.fourierX = []; 
            state.lastPoint = null;
            state.drawTime = 0;
            statusMsg.innerText = "Ready";
            ctxDraw.clearRect(0,0,canvasDraw.width, canvasDraw.height);
            ctxTrail.clearRect(0,0,canvasTrail.width, canvasTrail.height);
        };

        function animate() {
            if (state.page === 'home') drawWaveLoop();
            else drawStudioLoop();
            requestAnimationFrame(animate);
        }
        animate();

        window.saveImage = () => {
            // 1. å‰µå»ºä¸€å€‹è‡¨æ™‚ç•«å¸ƒä¾†åˆæˆèƒŒæ™¯
            const tempCanvas = document.createElement('canvas');
            tempCanvas.width = canvasTrail.width;
            tempCanvas.height = canvasTrail.height;
            const tCtx = tempCanvas.getContext('2d');

            // 2. å¡«å…¥é»‘è‰²èƒŒæ™¯ (å› ç‚º canvasTrail æœ¬èº«æ˜¯é€æ˜çš„)
            tCtx.fillStyle = "#050505";
            tCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);

            // 3. æŠŠç›®å‰çš„è»Œè·¡å±¤ (canvas-trail) ç•«ä¸Šå»
            tCtx.drawImage(canvasTrail, 0, 0);

            // 4. è§¸ç™¼ä¸‹è¼‰
            const link = document.createElement('a');
            const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
            link.download = `fourier-art-${timestamp}.png`;
            link.href = tempCanvas.toDataURL('image/png');
            link.click();
        };
    </script>
</body>
</html>
